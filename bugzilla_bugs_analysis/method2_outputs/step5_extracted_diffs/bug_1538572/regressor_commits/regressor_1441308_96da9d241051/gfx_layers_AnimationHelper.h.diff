# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/layers/AnimationHelper.h
# Commit: 96da9d241051
# Full Hash: 96da9d241051d222bdd693bdb519d058a013b59c
# Author: Doug Thayer <dothayer@mozilla.com>
# Date: 2019-03-23 09:46:24
# Regressor Bug: 1441308
# File Overlap Count: 2
# Description:
#   Bug 1441308 - Core renderroot splitting changes r=kats,sotaro
#   
#   This is a large patch that contains all of the core changes for
#   renderroot splitting.
#   
# ==============================================================================

diff -r 8cefa694f811 -r 96da9d241051 gfx/layers/AnimationHelper.h
--- a/gfx/layers/AnimationHelper.h	Fri Mar 22 18:28:31 2019 +0000
+++ b/gfx/layers/AnimationHelper.h	Fri Mar 22 18:28:42 2019 +0000
@@ -8,9 +8,10 @@
 #define mozilla_layers_AnimationHelper_h
 
 #include "mozilla/dom/Nullable.h"
-#include "mozilla/ComputedTimingFunction.h"  // for ComputedTimingFunction
-#include "mozilla/layers/LayersMessages.h"   // for TransformData, etc
-#include "mozilla/TimeStamp.h"               // for TimeStamp
+#include "mozilla/ComputedTimingFunction.h"    // for ComputedTimingFunction
+#include "mozilla/layers/LayersMessages.h"     // for TransformData, etc
+#include "mozilla/webrender/WebRenderTypes.h"  // for RenderRoot
+#include "mozilla/TimeStamp.h"                 // for TimeStamp
 #include "mozilla/TimingParams.h"
 #include "X11UndefineNone.h"
 
@@ -133,6 +134,8 @@
   typedef nsClassHashtable<nsUint64HashKey, AnimatedValue> AnimatedValueTable;
   typedef nsClassHashtable<nsUint64HashKey, nsTArray<PropertyAnimationGroup>>
       AnimationsTable;
+  typedef nsDataHashtable<nsUint64HashKey, wr::RenderRoot>
+      AnimationsRenderRootsTable;
 
   NS_INLINE_DECL_THREADSAFE_REFCOUNTING(CompositorAnimationStorage)
  public:
@@ -178,7 +181,8 @@
   /**
    * Set the animations based on the unique id
    */
-  void SetAnimations(uint64_t aId, const AnimationArray& aAnimations);
+  void SetAnimations(uint64_t aId, const AnimationArray& aAnimations,
+                     wr::RenderRoot aRenderRoot);
 
   /**
    * Return the animations if a given id can map to its animations
@@ -194,6 +198,10 @@
 
   uint32_t AnimationsCount() const { return mAnimations.Count(); }
 
+  wr::RenderRoot AnimationRenderRoot(const uint64_t& aId) const {
+    return mAnimationRenderRoots.Get(aId);
+  }
+
   /**
    * Clear AnimatedValues and Animations data
    */
@@ -206,6 +214,7 @@
  private:
   AnimatedValueTable mAnimatedValues;
   AnimationsTable mAnimations;
+  AnimationsRenderRootsTable mAnimationRenderRoots;
 };
 
 /**