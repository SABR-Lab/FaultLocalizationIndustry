# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: media/webrtc/signaling/gtest/mediaconduit_unittests.cpp
# Commit: 25bf8e097e60
# Full Hash: 25bf8e097e604cca2842af6754c2c1698db5618a
# Author: Dan Minor <dminor@mozilla.com>
# Date: 2019-10-29 21:27:48
# Description:
#   Bug 1543622 - Make number of channels out param of GetAudioFrame; r=pehrsons
#   
#   The number of channels is available in mAudioFrame in GetAudioFrame so
#   there is no reason to calculate it after the fact in MediaPipeline.
#   
# ==============================================================================

diff -r 4139bfe5e7f9 -r 25bf8e097e60 media/webrtc/signaling/gtest/mediaconduit_unittests.cpp
--- a/media/webrtc/signaling/gtest/mediaconduit_unittests.cpp	Tue Oct 29 16:04:29 2019 +0000
+++ b/media/webrtc/signaling/gtest/mediaconduit_unittests.cpp	Tue Oct 29 17:30:03 2019 +0000
@@ -197,7 +197,8 @@
   auto audioInput = mozilla::MakeUnique<int16_t[]>(PLAYOUT_SAMPLE_LENGTH);
   auto audioOutput = mozilla::MakeUnique<int16_t[]>(PLAYOUT_SAMPLE_LENGTH);
   short* inbuf;
-  int sampleLengthDecoded = 0;
+  size_t numChannels = 0;
+  size_t sampleLengthDecoded = 0;
   unsigned int SAMPLES = (PLAYOUT_SAMPLE_FREQUENCY / 100);  // 10 milliseconds
   int CHANNELS = 1;                                         // mono audio
   int sampleLengthInBytes = sizeof(int16_t) * PLAYOUT_SAMPLE_LENGTH;
@@ -246,7 +247,7 @@
 
     PR_Sleep(PR_MillisecondsToInterval(10));
     mOtherSession->GetAudioFrame(audioOutput.get(), PLAYOUT_SAMPLE_FREQUENCY,
-                                 10, sampleLengthDecoded);
+                                 10, numChannels, sampleLengthDecoded);
     if (sampleLengthDecoded == 0) {
       cerr << " Zero length Sample " << endl;
     }