# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/smil/SMILCSSValueType.cpp
# Commit: ddf4012a7652
# Full Hash: ddf4012a7652e36d144fc43bc99335276deeafbe
# Author: Christoph Kerschbaumer <ckerschb@christophkerschbaumer.com>
# Date: 2019-05-22 03:40:58
# Regressor Bug: 965637
# File Overlap Count: 1
# Description:
#   Bug 965637: Move CSP from Principal into Client, part 1: backend changes. r=mccr8
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D27654
# ==============================================================================

diff -r 6c2047bc2f3e -r ddf4012a7652 dom/smil/SMILCSSValueType.cpp
--- a/dom/smil/SMILCSSValueType.cpp	Tue May 21 22:51:54 2019 +0000
+++ b/dom/smil/SMILCSSValueType.cpp	Tue May 21 23:14:27 2019 +0000
@@ -453,9 +453,8 @@
   }
 
   Document* doc = aTargetElement->GetComposedDoc();
-  if (doc && !nsStyleUtil::CSPAllowsInlineStyle(nullptr, doc->NodePrincipal(),
-                                                nullptr, doc->GetDocumentURI(),
-                                                0, 0, aString, nullptr)) {
+  if (doc && !nsStyleUtil::CSPAllowsInlineStyle(nullptr, doc, nullptr, 0, 0,
+                                                aString, nullptr)) {
     return;
   }
 
@@ -492,9 +491,8 @@
   // in that case, we just use a generic placeholder string instead.
   static const nsLiteralString kPlaceholderText =
       NS_LITERAL_STRING("[SVG animation of CSS]");
-  if (doc && !nsStyleUtil::CSPAllowsInlineStyle(
-                 nullptr, doc->NodePrincipal(), nullptr, doc->GetDocumentURI(),
-                 0, 0, kPlaceholderText, nullptr)) {
+  if (doc && !nsStyleUtil::CSPAllowsInlineStyle(nullptr, doc, nullptr, 0, 0,
+                                                kPlaceholderText, nullptr)) {
     return result;
   }
 