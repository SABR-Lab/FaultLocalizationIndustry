# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: servo/components/style/values/computed/image.rs
# Commit: 25354cfea038
# Full Hash: 25354cfea03822ff64efeeb420e2fa4a5732eca9
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2019-06-06 09:29:49
# Regressor Bug: 1557110
# File Overlap Count: 2
# Description:
#   Bug 1557110 - Cleanup gradient parsing by removing the simple-moz-gradient parsing pref. r=dholbert
#   
#   It looks like bug 1547939 will stick, given how fast the other regressions came
#   in for bug 1337655.
#   
# ==============================================================================

diff -r c02fd9857532 -r 25354cfea038 servo/components/style/values/computed/image.rs
--- a/servo/components/style/values/computed/image.rs	Thu Jun 06 02:56:52 2019 +0000
+++ b/servo/components/style/values/computed/image.rs	Thu Jun 06 04:08:52 2019 +0000
@@ -29,11 +29,11 @@
 /// Computed values for a CSS gradient.
 /// <https://drafts.csswg.org/css-images/#gradients>
 pub type Gradient =
-    generic::Gradient<LineDirection, Length, LengthPercentage, Position, Color, Angle>;
+    generic::Gradient<LineDirection, Length, LengthPercentage, Position, Color>;
 
 /// A computed gradient kind.
 pub type GradientKind =
-    generic::GradientKind<LineDirection, Length, LengthPercentage, Position, Angle>;
+    generic::GradientKind<LineDirection, Length, LengthPercentage, Position>;
 
 /// A computed gradient line direction.
 #[derive(Clone, Copy, Debug, MallocSizeOf, PartialEq, ToResolvedValue)]
@@ -46,9 +46,6 @@
     Vertical(Y),
     /// A corner.
     Corner(X, Y),
-    /// A Position and an Angle for legacy `-moz-` prefixed gradient.
-    #[cfg(feature = "gecko")]
-    MozPosition(Option<Position>, Option<Angle>),
 }
 
 /// A computed radial gradient ending shape.
@@ -69,19 +66,6 @@
             LineDirection::Angle(angle) => angle.radians() == PI,
             LineDirection::Vertical(Y::Bottom) if compat_mode == CompatMode::Modern => true,
             LineDirection::Vertical(Y::Top) if compat_mode != CompatMode::Modern => true,
-            LineDirection::Corner(..) => false,
-            #[cfg(feature = "gecko")]
-            LineDirection::MozPosition(
-                Some(Position {
-                    ref vertical,
-                    ref horizontal,
-                }),
-                None,
-            ) => {
-                // `50% 0%` is the default value for line direction.
-                horizontal.as_percentage().map_or(false, |p| p.0 == 0.5) &&
-                    vertical.as_percentage().map_or(false, |p| p.0 == 0.0)
-            },
             _ => false,
         }
     }
@@ -112,21 +96,6 @@
                 dest.write_str(" ")?;
                 y.to_css(dest)
             },
-            #[cfg(feature = "gecko")]
-            LineDirection::MozPosition(position, angle) => {
-                let mut need_space = false;
-                if let Some(position) = position {
-                    position.to_css(dest)?;
-                    need_space = true;
-                }
-                if let Some(angle) = angle {
-                    if need_space {
-                        dest.write_str(" ")?;
-                    }
-                    angle.to_css(dest)?;
-                }
-                Ok(())
-            },
         }
     }
 }
@@ -142,13 +111,6 @@
             SpecifiedLineDirection::Horizontal(x) => LineDirection::Horizontal(x),
             SpecifiedLineDirection::Vertical(y) => LineDirection::Vertical(y),
             SpecifiedLineDirection::Corner(x, y) => LineDirection::Corner(x, y),
-            #[cfg(feature = "gecko")]
-            SpecifiedLineDirection::MozPosition(ref position, ref angle) => {
-                LineDirection::MozPosition(
-                    position.to_computed_value(context),
-                    angle.to_computed_value(context),
-                )
-            },
         }
     }
 
@@ -160,13 +122,6 @@
             LineDirection::Horizontal(x) => SpecifiedLineDirection::Horizontal(x),
             LineDirection::Vertical(y) => SpecifiedLineDirection::Vertical(y),
             LineDirection::Corner(x, y) => SpecifiedLineDirection::Corner(x, y),
-            #[cfg(feature = "gecko")]
-            LineDirection::MozPosition(ref position, ref angle) => {
-                SpecifiedLineDirection::MozPosition(
-                    ToComputedValue::from_computed_value(position),
-                    ToComputedValue::from_computed_value(angle),
-                )
-            },
         }
     }
 }