# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/webrender_bindings/RenderEGLImageTextureHost.cpp
# Commit: edfb73b96d5a
# Full Hash: edfb73b96d5ad946bbdd9da2e98d07b1f4565e1f
# Author: Jeff Gilbert <jgilbert@mozilla.com>
# Date: 2019-06-15 21:44:24
# Regressor Bug: 1559524
# File Overlap Count: 2
# Description:
#   Bug 1559524 - Reduce calls to GLLibraryEGL::Get(). r=lsalzman
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D35103
# ==============================================================================

diff -r 0378898329b2 -r edfb73b96d5a gfx/webrender_bindings/RenderEGLImageTextureHost.cpp
--- a/gfx/webrender_bindings/RenderEGLImageTextureHost.cpp	Sat Jun 15 05:14:53 2019 +0000
+++ b/gfx/webrender_bindings/RenderEGLImageTextureHost.cpp	Sat Jun 15 05:21:12 2019 +0000
@@ -7,7 +7,7 @@
 #include "RenderEGLImageTextureHost.h"
 
 #include "mozilla/gfx/Logging.h"
-#include "GLContext.h"
+#include "GLContextEGL.h"
 #include "GLLibraryEGL.h"
 
 namespace mozilla {
@@ -57,7 +57,8 @@
 
   EGLint status = LOCAL_EGL_CONDITION_SATISFIED;
   if (mSync) {
-    auto* egl = gl::GLLibraryEGL::Get();
+    const auto& gle = gl::GLContextEGL::Cast(mGL);
+    const auto& egl = gle->mEgl;
     MOZ_ASSERT(egl->IsExtensionSupported(gl::GLLibraryEGL::KHR_fence_sync));
     status = egl->fClientWaitSync(egl->Display(), mSync, 0, LOCAL_EGL_FOREVER);
     // We do not need to delete sync here. It is deleted by
