# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: security/sandbox/chromium-shim/patches/with_update/mingw_operator_new.patch
# Commit: 370c40e49230
# Full Hash: 370c40e4923073a87845b57c1f4851bacd9663da
# Author: Bob Owen <bobowencode@gmail.com>
# Date: 2019-06-12 21:42:35
# Regressor Bug: 1552160
# File Overlap Count: 2
# Description:
#   Bug 1552160 Part 1: Roll-up of chromium sandbox update and mozilla patches to get a running browser. r=jld,aklotz,tjr,bobowen
#   
#   This updates security/sandbox/chromium/ files to chromium commit 84108231f6e6e0772fb9a4643679ce76aa771e67.
#   
#   Existing and new patches applied from security/sandbox/chromium-shim/patches/with_update/ to give a compiling and mostly working browser.
# ==============================================================================

diff -r bd5ecd72f76c -r 370c40e49230 security/sandbox/chromium-shim/patches/with_update/mingw_operator_new.patch
--- a/security/sandbox/chromium-shim/patches/with_update/mingw_operator_new.patch	Wed Jun 12 21:55:59 2019 +1200
+++ b/security/sandbox/chromium-shim/patches/with_update/mingw_operator_new.patch	Wed Jun 12 11:10:48 2019 +0100
@@ -11,11 +11,11 @@
 diff --git a/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.cc b/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.cc
 --- a/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.cc
 +++ b/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.cc
-@@ -649,16 +649,21 @@ void* operator new(size_t size, sandbox:
+@@ -663,16 +663,21 @@ void* operator new(size_t size, sandbox:
  
-   // TODO: Returning NULL from operator new has undefined behavior, but
-   // the Allocate() functions called above can return NULL. Consider checking
-   // for NULL here and crashing or throwing.
+   // TODO: Returning nullptr from operator new has undefined behavior, but
+   // the Allocate() functions called above can return nullptr. Consider checking
+   // for nullptr here and crashing or throwing.
  
    return result;
  }
@@ -36,22 +36,23 @@
 diff --git a/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.h b/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.h
 --- a/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.h
 +++ b/security/sandbox/chromium/sandbox/win/src/sandbox_nt_util.h
-@@ -11,16 +11,18 @@
- 
+@@ -13,16 +13,19 @@
  #include "base/macros.h"
  #include "sandbox/win/src/nt_internals.h"
  #include "sandbox/win/src/sandbox_nt_types.h"
  
  // Placement new and delete to be used from ntdll interception code.
- void* __cdecl operator new(size_t size, sandbox::AllocationType type,
-                            void* near_to = NULL);
-+void* __cdecl operator new[](size_t size, sandbox::AllocationType type,
-+			     void* near_to = NULL);
+ void* __cdecl operator new(size_t size,
+                            sandbox::AllocationType type,
+                            void* near_to = nullptr);
++void* __cdecl operator new[](size_t size,
++                             sandbox::AllocationType type,
++                             void* near_to = nullptr);
  void __cdecl operator delete(void* memory, sandbox::AllocationType type);
  // Add operator delete that matches the placement form of the operator new
  // above. This is required by compiler to generate code to call operator delete
  // in case the object's constructor throws an exception.
  // See http://msdn.microsoft.com/en-us/library/cxdxz3x6.aspx
- void __cdecl operator delete(void* memory, sandbox::AllocationType type,
+ void __cdecl operator delete(void* memory,
+                              sandbox::AllocationType type,
                               void* near_to);
- 