# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/MediaTrackConstraints.h
# Commit: dc3e09fb750b
# Full Hash: dc3e09fb750bd5eea290e6acb81f31c4e20d74fd
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2019-07-10 15:45:05
# Regressor Bug: 1560907
# File Overlap Count: 1
# Description:
#   Bug 1560907 - Remove default value for mediaSource constraint. r=jib,smaug
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D36087
# ==============================================================================

diff -r be4f68034abd -r dc3e09fb750b dom/media/webrtc/MediaTrackConstraints.h
--- a/dom/media/webrtc/MediaTrackConstraints.h	Wed Jul 10 09:43:53 2019 +0000
+++ b/dom/media/webrtc/MediaTrackConstraints.h	Wed Jul 10 09:45:26 2019 +0000
@@ -201,9 +201,12 @@
         bool advanced, nsTArray<MemberPtrType>* aList);
 
     StringRange(StringPtrType aMemberPtr, const char* aName,
-                const nsString& aOther, nsTArray<MemberPtrType>* aList)
+                const dom::Optional<nsString>& aOther,
+                nsTArray<MemberPtrType>* aList)
         : BaseRange((MemberPtrType)aMemberPtr, aName, aList) {
-      mIdeal.insert(aOther);
+      if (aOther.WasPassed()) {
+        mIdeal.insert(aOther.Value());
+      }
     }
 
     ~StringRange() = default;