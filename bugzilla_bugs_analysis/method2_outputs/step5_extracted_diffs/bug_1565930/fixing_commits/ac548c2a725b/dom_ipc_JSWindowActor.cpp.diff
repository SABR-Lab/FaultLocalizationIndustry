# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/ipc/JSWindowActor.cpp
# Commit: ac548c2a725b
# Full Hash: ac548c2a725b66db57c81bb24accca2bbe075931
# Author: Olli Pettay <Olli.Pettay@helsinki.fi>
# Date: 2019-07-29 21:38:39
# Description:
#   Bug 1565930, try to make Promise less error prone to compartment mismatches, r=bzbarsky
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D38762
# ==============================================================================

diff -r c4980c083852 -r ac548c2a725b dom/ipc/JSWindowActor.cpp
--- a/dom/ipc/JSWindowActor.cpp	Mon Jul 29 08:00:35 2019 +0000
+++ b/dom/ipc/JSWindowActor.cpp	Mon Jul 29 14:43:54 2019 +0000
@@ -215,7 +215,7 @@
     if (aRv.Failed()) {
       promise->MaybeReject(aRv);
     } else {
-      promise->MaybeResolve(aCx, retval);
+      promise->MaybeResolve(retval);
     }
   }
 }
@@ -244,7 +244,7 @@
   }
 
   if (aMetadata.kind() == JSWindowActorMessageKind::QueryResolve) {
-    promise->MaybeResolve(aCx, data);
+    promise->MaybeResolve(data);
   } else {
     promise->MaybeReject(NS_ERROR_DOM_OPERATION_ERR);
   }