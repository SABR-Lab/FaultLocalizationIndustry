# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: layout/generic/nsContainerFrame.cpp
# Commit: 8647528a4e9d
# Full Hash: 8647528a4e9d6350ba9b1ce6245d51476081c5e4
# Author: Mats Palmgren <mats@mozilla.com>
# Date: 2019-08-14 21:57:52
# Regressor Bug: 1105868
# File Overlap Count: 2
# Description:
#   Bug 1105868 part 4 - Accessibility support for inline list-items.  r=emilio
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D39833
# ==============================================================================

diff -r b517c3b51b9a -r 8647528a4e9d layout/generic/nsContainerFrame.cpp
--- a/layout/generic/nsContainerFrame.cpp	Wed Aug 14 14:37:03 2019 +0000
+++ b/layout/generic/nsContainerFrame.cpp	Wed Aug 14 14:37:16 2019 +0000
@@ -1730,6 +1730,32 @@
   return NS_STYLE_ALIGN_START;
 }
 
+#ifdef ACCESSIBILITY
+void nsContainerFrame::GetSpokenMarkerText(nsAString& aText) const {
+  const nsStyleList* myList = StyleList();
+  if (myList->GetListStyleImage()) {
+    char16_t kDiscCharacter = 0x2022;
+    aText.Assign(kDiscCharacter);
+    aText.Append(' ');
+  } else {
+    nsIContent* markerPseudo = nsLayoutUtils::GetMarkerPseudo(GetContent());
+    if (nsIFrame* marker = markerPseudo->GetPrimaryFrame()) {
+      if (nsBulletFrame* bullet = do_QueryFrame(marker)) {
+        bullet->GetSpokenText(aText);
+      } else {
+        ErrorResult err;
+        markerPseudo->GetTextContent(aText, err);
+        if (err.Failed()) {
+          aText.Truncate();
+        }
+      }
+    } else {
+      aText.Truncate();
+    }
+  }
+}
+#endif
+
 nsOverflowContinuationTracker::nsOverflowContinuationTracker(
     nsContainerFrame* aFrame, bool aWalkOOFFrames,
     bool aSkipOverflowContainerChildren)