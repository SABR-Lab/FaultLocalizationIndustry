# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/components/url-classifier/nsUrlClassifierDBService.cpp
# Commit: d49cd2aa4568
# Full Hash: d49cd2aa45686212954493e2465fc3258c1796a2
# Author: dlee <dlee@mozilla.com>
# Date: 2019-08-21 16:47:43
# Regressor Bug: 1562822
# File Overlap Count: 1
# Description:
#   Bug 1562822 - P2. Reset corrupted Safe Browsing database before triggering an update. r=gcp
#   
#   Patch P2 & P3 refine how Safe Browsing handles Safe Browsing database
#   loading failure.
#   
# ==============================================================================

diff -r 7a0ab3a7558b -r d49cd2aa4568 toolkit/components/url-classifier/nsUrlClassifierDBService.cpp
--- a/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp	Wed Aug 21 12:07:44 2019 +0000
+++ b/toolkit/components/url-classifier/nsUrlClassifierDBService.cpp	Wed Aug 21 12:08:03 2019 +0000
@@ -865,12 +865,8 @@
 
 NS_IMETHODIMP
 nsUrlClassifierDBServiceWorker::ReloadDatabase() {
-  nsTArray<nsCString> tables;
-  nsresult rv = mClassifier->ActiveTables(tables);
-  NS_ENSURE_SUCCESS(rv, rv);
-
   // This will null out mClassifier
-  rv = CloseDb();
+  nsresult rv = CloseDb();
   NS_ENSURE_SUCCESS(rv, rv);
 
   // Create new mClassifier and load prefixset and completions from disk.
