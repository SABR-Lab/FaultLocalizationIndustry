# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/wr/webrender/src/clip.rs
# Commit: 548e4395ee1a
# Full Hash: 548e4395ee1a10700a729f93c0340d44ebe91ac7
# Author: Nicolas Silva <nsilva@mozilla.com>
# Date: 2019-09-13 15:46:31
# Regressor Bug: 1570081
# File Overlap Count: 1
# Description:
#   Bug 1570081 - Support changing the blob image visible rect in WebRender. r=jrmuizel
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D39911
# ==============================================================================

diff -r 8eeddedeedb8 -r 548e4395ee1a gfx/wr/webrender/src/clip.rs
--- a/gfx/wr/webrender/src/clip.rs	Thu Sep 12 21:27:06 2019 +0000
+++ b/gfx/wr/webrender/src/clip.rs	Thu Sep 12 15:54:50 2019 +0000
@@ -380,10 +380,6 @@
                         rect.size,
                     );
 
-                    // TODO: As a followup, if the image is a tiled blob, the device_image_rect below
-                    // will be set to the blob's visible area.
-                    let device_image_rect = DeviceIntRect::from_size(props.descriptor.size);
-
                     for Repetition { origin, .. } in repetitions {
                         let layout_image_rect = LayoutRect {
                             origin,
@@ -392,7 +388,7 @@
                         let tiles = image::tiles(
                             &layout_image_rect,
                             &visible_rect,
-                            &device_image_rect,
+                            &props.visible_rect,
                             tile_size as i32,
                         );
                         for tile in tiles {