# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/components/url-classifier/tests/mochitest/features.js
# Commit: f2df73fda468
# Full Hash: f2df73fda46859150605f33bcdaeb49ab7037720
# Author: Jean-Yves Avenard <jyavenard@mozilla.com>
# Date: 2019-10-19 21:40:34
# Regressor Bug: 1588899
# File Overlap Count: 1
# Description:
#   Bug 1588899 - P1. Move classification flags related method to nsIClassifiedChannel. r=Ehsan,baku
#   
#   This is where it should have been in the first place. Those attributes belong there.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D49577
# ==============================================================================

diff -r b98968eb71d3 -r f2df73fda468 toolkit/components/url-classifier/tests/mochitest/features.js
--- a/toolkit/components/url-classifier/tests/mochitest/features.js	Thu Oct 17 15:24:31 2019 +0000
+++ b/toolkit/components/url-classifier/tests/mochitest/features.js	Sat Oct 19 04:30:24 2019 +0000
@@ -248,8 +248,10 @@
 
     function onExamResp(subject, topic, data) {
       let channel = subject.QueryInterface(Ci.nsIHttpChannel);
+      let classifiedChannel = subject.QueryInterface(Ci.nsIClassifiedChannel);
       if (
         !channel ||
+        !classifiedChannel ||
         !channel.URI.spec.startsWith(
           "http://example.com/tests/toolkit/components/url-classifier/tests/mochitest/raptor.jpg"
         )
@@ -259,8 +261,8 @@
 
       // eslint-disable-next-line no-undef
       sendAsyncMessage("last-channel-flags", {
-        classificationFlags: channel.classificationFlags,
-        isTrackingResource: channel.isTrackingResource(),
+        classificationFlags: classifiedChannel.classificationFlags,
+        isTrackingResource: classifiedChannel.isTrackingResource(),
       });
     }
 