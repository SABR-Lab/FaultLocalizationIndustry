# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/MediaEngineTabVideoSource.cpp
# Commit: 097558e2d628
# Full Hash: 097558e2d628bdb9e23e54224131dbed7b4378ae
# Author: Jan-Ivar Bruaroey <jib@mozilla.com>
# Date: 2020-01-07 05:13:50
# Description:
#   Bug 1606507 - Null-check on mTrackMain to avoid race. r=dminor
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D58838
# ==============================================================================

diff -r bd68783bf033 -r 097558e2d628 dom/media/webrtc/MediaEngineTabVideoSource.cpp
--- a/dom/media/webrtc/MediaEngineTabVideoSource.cpp	Mon Jan 06 22:20:42 2020 +0200
+++ b/dom/media/webrtc/MediaEngineTabVideoSource.cpp	Mon Jan 06 20:03:26 2020 +0000
@@ -253,9 +253,9 @@
     return;
   }
 
-  if (mTrackMain->IsDestroyed()) {
-    // The track was already destroyed by MediaManager. This can happen because
-    // stopping the draw timer is async.
+  if (!mTrackMain || mTrackMain->IsDestroyed()) {
+    // The track is already gone or destroyed by MediaManager. This can happen
+    // because stopping the draw timer is async.
     return;
   }
 
