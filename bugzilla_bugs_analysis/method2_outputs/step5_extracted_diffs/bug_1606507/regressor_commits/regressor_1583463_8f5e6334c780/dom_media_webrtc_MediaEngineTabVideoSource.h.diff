# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/MediaEngineTabVideoSource.h
# Commit: 8f5e6334c780
# Full Hash: 8f5e6334c780b6fd8820f387c3892b10a636a25a
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2019-10-07 16:27:18
# Regressor Bug: 1583463
# File Overlap Count: 1
# Description:
#   Bug 1583463 - Merge the tab source's InitRunnable and StartRunnable to avoid checking mWindow on the media thread. r=jib
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D47682
# ==============================================================================

diff -r 2e24c5cac308 -r 8f5e6334c780 dom/media/webrtc/MediaEngineTabVideoSource.h
--- a/dom/media/webrtc/MediaEngineTabVideoSource.h	Thu Oct 03 19:49:47 2019 +0000
+++ b/dom/media/webrtc/MediaEngineTabVideoSource.h	Thu Oct 03 19:50:09 2019 +0000
@@ -70,20 +70,6 @@
     const RefPtr<MediaEngineTabVideoSource> mVideoSource;
   };
 
-  class InitRunnable : public Runnable {
-   public:
-    InitRunnable(MediaEngineTabVideoSource* videoSource,
-                 SourceMediaTrack* aTrack, const PrincipalHandle& aPrincipal)
-        : Runnable("MediaEngineTabVideoSource::InitRunnable"),
-          mVideoSource(videoSource),
-          mTrack(aTrack),
-          mPrincipal(aPrincipal) {}
-    NS_IMETHOD Run() override;
-    const RefPtr<MediaEngineTabVideoSource> mVideoSource;
-    const RefPtr<SourceMediaTrack> mTrack;
-    const PrincipalHandle mPrincipal;
-  };
-
   class DestroyRunnable : public Runnable {
    public:
     explicit DestroyRunnable(MediaEngineTabVideoSource* videoSource)
@@ -112,6 +98,7 @@
   // Members are main thread only.
   const RefPtr<media::Refcountable<dom::MediaTrackSettings>> mSettings;
 
+  // Main thread only.
   nsCOMPtr<nsPIDOMWindowOuter> mWindow;
   nsCOMPtr<nsITimer> mTimer;
   nsCOMPtr<nsITabSource> mTabSource;
