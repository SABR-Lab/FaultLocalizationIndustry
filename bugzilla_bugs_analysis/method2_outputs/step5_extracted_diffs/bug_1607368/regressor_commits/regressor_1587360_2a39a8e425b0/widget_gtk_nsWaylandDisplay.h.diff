# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/gtk/nsWaylandDisplay.h
# Commit: 2a39a8e425b0
# Full Hash: 2a39a8e425b0824c670ba03452c437c3748c990b
# Author: Greg V <greg@unrelenting.technology>
# Date: 2020-01-06 21:54:03
# Regressor Bug: 1587360
# File Overlap Count: 1
# Description:
#   Bug 1587360 - Add support for idle-inhibit Wayland protocol r=stransky
#   
#   The idle-inhibit protocol allows idle wake locks on Wayland
#   without any of the supported D-Bus interfaces running.
#   
# ==============================================================================

diff -r 47592189b305 -r 2a39a8e425b0 widget/gtk/nsWaylandDisplay.h
--- a/widget/gtk/nsWaylandDisplay.h	Mon Jan 06 17:02:14 2020 +0000
+++ b/widget/gtk/nsWaylandDisplay.h	Mon Jan 06 16:11:19 2020 +0000
@@ -10,6 +10,7 @@
 
 #include "mozilla/widget/mozwayland.h"
 #include "mozilla/widget/gtk-primary-selection-client-protocol.h"
+#include "mozilla/widget/idle-inhibit-unstable-v1-client-protocol.h"
 
 #include "base/message_loop.h"  // for MessageLoop
 #include "base/task.h"          // for NewRunnableMethod, etc
@@ -59,6 +60,9 @@
   gtk_primary_selection_device_manager* GetPrimarySelectionDeviceManager(void) {
     return mPrimarySelectionDeviceManager;
   };
+  zwp_idle_inhibit_manager_v1* GetIdleInhibitManager(void) {
+    return mIdleInhibitManager;
+  }
 
   void SetShm(wl_shm* aShm);
   void SetCompositor(wl_compositor* aCompositor);
@@ -67,6 +71,7 @@
   void SetSeat(wl_seat* aSeat);
   void SetPrimarySelectionDeviceManager(
       gtk_primary_selection_device_manager* aPrimarySelectionDeviceManager);
+  void SetIdleInhibitManager(zwp_idle_inhibit_manager_v1* aIdleInhibitManager);
 
   void Shutdown();
 
@@ -101,6 +106,7 @@
   wl_shm* mShm;
   wl_callback* mSyncCallback;
   gtk_primary_selection_device_manager* mPrimarySelectionDeviceManager;
+  zwp_idle_inhibit_manager_v1* mIdleInhibitManager;
   wl_registry* mRegistry;
   zwp_linux_dmabuf_v1* mDmabuf;
   gbm_device* mGbmDevice;