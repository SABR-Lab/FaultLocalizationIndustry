# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: gfx/vr/ipc/VRManagerChild.h
# Commit: 51b0f3fef43a
# Full Hash: 51b0f3fef43ade362807e69e91d6786390e67015
# Author: sotaro <sotaro.ikeda.g@gmail.com>
# Date: 2020-02-15 09:56:17
# Description:
#   Bug 1614570 - Make VRManagerChild life time handling more like CompositorManagerChild r=aosmond
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D62710
# ==============================================================================

diff -r 10d15000963d -r 51b0f3fef43a gfx/vr/ipc/VRManagerChild.h
--- a/gfx/vr/ipc/VRManagerChild.h	Fri Feb 14 23:15:28 2020 +0000
+++ b/gfx/vr/ipc/VRManagerChild.h	Fri Feb 14 15:10:40 2020 +0000
@@ -73,7 +73,6 @@
   static void InitSameProcess();
   static void InitWithGPUProcess(Endpoint<PVRManagerChild>&& aEndpoint);
   static bool InitForContent(Endpoint<PVRManagerChild>&& aEndpoint);
-  static bool ReinitForContent(Endpoint<PVRManagerChild>&& aEndpoint);
   static void ShutDown();
 
   static bool IsCreated();
@@ -103,7 +102,8 @@
   void FireDOMVRDisplayPresentChangeEvent(uint32_t aDisplayID);
   void FireDOMVRDisplayConnectEventsForLoad(VRManagerEventObserver* aObserver);
 
-  virtual void HandleFatalError(const char* aMsg) const override;
+  void HandleFatalError(const char* aMsg) const override;
+  void ActorDestroy(ActorDestroyReason aReason) override;
 
   void RunPuppet(const nsTArray<uint64_t>& aBuffer, dom::Promise* aPromise,
                  ErrorResult& aRv);
@@ -112,13 +112,13 @@
  protected:
   explicit VRManagerChild();
   ~VRManagerChild();
-  void Destroy();
-  void AfterDestroy();
 
   PVRLayerChild* AllocPVRLayerChild(const uint32_t& aDisplayID,
                                     const uint32_t& aGroup);
   bool DeallocPVRLayerChild(PVRLayerChild* actor);
 
+  void ActorDealloc() override;
+
   // MOZ_CAN_RUN_SCRIPT_BOUNDARY until we can mark ipdl-generated things as
   // MOZ_CAN_RUN_SCRIPT.
   MOZ_CAN_RUN_SCRIPT_BOUNDARY
