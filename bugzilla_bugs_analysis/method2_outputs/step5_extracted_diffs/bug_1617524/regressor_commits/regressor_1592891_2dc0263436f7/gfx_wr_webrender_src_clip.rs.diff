# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/wr/webrender/src/clip.rs
# Commit: 2dc0263436f7
# Full Hash: 2dc0263436f78b1689d5e23a2b24720181e91ea4
# Author: Glenn Watson <git@intuitionlibrary.com>
# Date: 2019-11-01 09:36:21
# Regressor Bug: 1592891
# File Overlap Count: 4
# Description:
#   Bug 1592891 - Disable picture caching when picture caches have complex transforms. r=kvark,nical
#   
#   With the recent changes to compositing in WR, the scene must either
#   only produce produce cache tiles, or disable picture caching and
#   rasterize directly.
# ==============================================================================

diff -r b96cb18aa920 -r 2dc0263436f7 gfx/wr/webrender/src/clip.rs
--- a/gfx/wr/webrender/src/clip.rs	Thu Oct 31 13:49:53 2019 +0000
+++ b/gfx/wr/webrender/src/clip.rs	Thu Oct 31 19:53:44 2019 +0000
@@ -1061,12 +1061,23 @@
     pub spatial_node_index: SpatialNodeIndex,
 }
 
+/// The data available about an interned clip node during scene building
+#[derive(Debug, MallocSizeOf)]
+#[cfg_attr(feature = "capture", derive(Serialize))]
+#[cfg_attr(feature = "replay", derive(Deserialize))]
+pub struct ClipInternData {
+    /// Whether this is a simple rectangle clip
+    pub clip_node_kind: ClipNodeKind,
+    /// The positioning node for this clip item
+    pub spatial_node_index: SpatialNodeIndex,
+}
+
 impl intern::InternDebug for ClipItemKey {}
 
 impl intern::Internable for ClipIntern {
     type Key = ClipItemKey;
     type StoreData = ClipNode;
-    type InternData = ClipNodeKind;
+    type InternData = ClipInternData;
 }
 
 #[derive(Debug, MallocSizeOf)]