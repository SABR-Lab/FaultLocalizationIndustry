# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/xpconnect/src/Sandbox.cpp
# Commit: 942a92874526
# Full Hash: 942a92874526e7a18167af89e358d69cbaeab268
# Author: Boris Zbarsky <bzbarsky@mit.edu>
# Date: 2020-02-22 09:52:08
# Regressor Bug: 267645
# File Overlap Count: 1
# Description:
#   Bug 267645 part 1.  Add a way to ask for DOMException to be exposed in sandboxes. r=bholley
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D63278
# ==============================================================================

diff -r d21671811dff -r 942a92874526 js/xpconnect/src/Sandbox.cpp
--- a/js/xpconnect/src/Sandbox.cpp	Tue Feb 18 11:14:49 2020 +0000
+++ b/js/xpconnect/src/Sandbox.cpp	Sat Feb 22 04:56:52 2020 +0000
@@ -38,6 +38,7 @@
 #include "mozilla/dom/CSSRuleBinding.h"
 #include "mozilla/dom/DirectoryBinding.h"
 #include "mozilla/dom/DocumentBinding.h"
+#include "mozilla/dom/DOMExceptionBinding.h"
 #include "mozilla/dom/DOMParserBinding.h"
 #include "mozilla/dom/DOMTokenListBinding.h"
 #include "mozilla/dom/ElementBinding.h"
@@ -843,6 +844,8 @@
       Document = true;
     } else if (JS_LinearStringEqualsLiteral(nameStr, "Directory")) {
       Directory = true;
+    } else if (JS_LinearStringEqualsLiteral(nameStr, "DOMException")) {
+      DOMException = true;
     } else if (JS_LinearStringEqualsLiteral(nameStr, "DOMParser")) {
       DOMParser = true;
     } else if (JS_LinearStringEqualsLiteral(nameStr, "DOMTokenList")) {
@@ -947,8 +950,13 @@
     return false;
   }
 
-  if (DOMParser && !dom::DOMParser_Binding::GetConstructorObject(cx))
+  if (DOMException && !dom::DOMException_Binding::GetConstructorObject(cx)) {
     return false;
+  }
+
+  if (DOMParser && !dom::DOMParser_Binding::GetConstructorObject(cx)) {
+    return false;
+  }
 
   if (DOMTokenList && !dom::DOMTokenList_Binding::GetConstructorObject(cx)) {
     return false;