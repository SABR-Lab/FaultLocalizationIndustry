# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: security/manager/ssl/TransportSecurityInfo.cpp
# Commit: e5332d369097
# Full Hash: e5332d369097293752c3e730201ea42903b47dc2
# Author: Dana Keeler <dkeeler@mozilla.com>
# Date: 2020-04-28 21:47:47
# Description:
#   Bug 1620972 - avoid unnecessary do_QueryInterface calls in TransportSecurityInfo r=kjacobs
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D72084
# ==============================================================================

diff -r 56f2759745c5 -r e5332d369097 security/manager/ssl/TransportSecurityInfo.cpp
--- a/security/manager/ssl/TransportSecurityInfo.cpp	Tue Apr 28 17:08:36 2020 +0000
+++ b/security/manager/ssl/TransportSecurityInfo.cpp	Thu Apr 23 19:14:08 2020 +0000
@@ -239,18 +239,14 @@
   NS_ENSURE_SUCCESS(rv, rv);
 
   for (const auto& cert : mSucceededCertChain) {
-    nsCOMPtr<nsISerializable> serializableCert = do_QueryInterface(cert);
-    rv = aStream->WriteCompoundObject(serializableCert, NS_GET_IID(nsIX509Cert),
-                                      true);
+    rv = aStream->WriteCompoundObject(cert, NS_GET_IID(nsIX509Cert), true);
     NS_ENSURE_SUCCESS(rv, rv);
   }
   // END moved from nsISSLStatus
   rv = aStream->Write16(mFailedCertChain.Length());
   NS_ENSURE_SUCCESS(rv, rv);
   for (const auto& cert : mFailedCertChain) {
-    nsCOMPtr<nsISerializable> serializableCert = do_QueryInterface(cert);
-    rv = aStream->WriteCompoundObject(serializableCert, NS_GET_IID(nsIX509Cert),
-                                      true);
+    rv = aStream->WriteCompoundObject(cert, NS_GET_IID(nsIX509Cert), true);
     NS_ENSURE_SUCCESS(rv, rv);
   }
 
