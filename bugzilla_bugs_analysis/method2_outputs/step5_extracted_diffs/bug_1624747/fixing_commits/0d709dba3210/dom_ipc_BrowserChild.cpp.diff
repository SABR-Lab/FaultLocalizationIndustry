# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/ipc/BrowserChild.cpp
# Commit: 0d709dba3210
# Full Hash: 0d709dba321059a974f44c497bf0a5e148e9ec8b
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2020-04-03 01:02:14
# Description:
#   Bug 1624747 - Null-check docshell from BrowserChild::RecvScrollbarPreferencesChanged / RecvShow. r=nika
#   
#   Apparently we can have collected the nsWebBrowser already, or its docshell.
#   
#   mWebNav is a nsWebBrowser instance, which is destroyed early during shutdown, in
# ==============================================================================

diff -r 5af65c82aebf -r 0d709dba3210 dom/ipc/BrowserChild.cpp
--- a/dom/ipc/BrowserChild.cpp	Thu Apr 02 13:52:24 2020 +0000
+++ b/dom/ipc/BrowserChild.cpp	Thu Apr 02 15:00:44 2020 +0000
@@ -1193,8 +1193,9 @@
   MOZ_ASSERT(!mIsTopLevel,
              "Scrollbar visibility should be derived from chrome flags for "
              "top-level windows");
-  nsCOMPtr<nsIDocShell> docShell = do_GetInterface(WebNavigation());
-  nsDocShell::Cast(docShell)->SetScrollbarPreference(aPreference);
+  if (nsCOMPtr<nsIDocShell> docShell = do_GetInterface(WebNavigation())) {
+    nsDocShell::Cast(docShell)->SetScrollbarPreference(aPreference);
+  }
   return IPC_OK();
 }
 
