# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/ipc/BrowserChild.cpp
# Commit: 52e661ff161d
# Full Hash: 52e661ff161d361d8c59c38b7426330ade4531ee
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2020-01-13 09:38:23
# Regressor Bug: 1588791
# File Overlap Count: 1
# Description:
#   Bug 1588791 - Make fission iframes honor and deal with the scrolling attribute. r=mattwoodrow
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D59630
# ==============================================================================

diff -r d59e691bda9e -r 52e661ff161d dom/ipc/BrowserChild.cpp
--- a/dom/ipc/BrowserChild.cpp	Sun Jan 12 22:22:20 2020 +0000
+++ b/dom/ipc/BrowserChild.cpp	Sun Jan 12 22:22:29 2020 +0000
@@ -1111,7 +1111,8 @@
 }
 
 void BrowserChild::DoFakeShow(const ParentShowInfo& aParentShowInfo) {
-  OwnerShowInfo ownerInfo{ScreenIntSize(), mParentIsActive, nsSizeMode_Normal};
+  OwnerShowInfo ownerInfo{ScreenIntSize(), ScrollbarPreference::Auto,
+                          mParentIsActive, nsSizeMode_Normal};
   RecvShow(aParentShowInfo, ownerInfo);
   mDidFakeShow = true;
 }
@@ -1187,6 +1188,7 @@
 
   ApplyParentShowInfo(aParentInfo);
   RecvParentActivated(aOwnerInfo.parentWindowIsActive());
+  RecvScrollbarPreferenceChanged(aOwnerInfo.scrollbarPreference());
 
   if (!res) {
     return IPC_FAIL_NO_REASON(this);
@@ -1213,6 +1215,13 @@
   return IPC_OK();
 }
 
+mozilla::ipc::IPCResult BrowserChild::RecvScrollbarPreferenceChanged(
+    ScrollbarPreference aPreference) {
+  nsCOMPtr<nsIDocShell> docShell = do_GetInterface(WebNavigation());
+  nsDocShell::Cast(docShell)->SetScrollbarPreference(aPreference);
+  return IPC_OK();
+}
+
 mozilla::ipc::IPCResult BrowserChild::RecvCompositorOptionsChanged(
     const CompositorOptions& aNewOptions) {
   MOZ_ASSERT(mCompositorOptions);