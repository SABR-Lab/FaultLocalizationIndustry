# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: layout/generic/nsFrame.cpp
# Commit: acb3f6f0a64e
# Full Hash: acb3f6f0a64e5e31daee85c5e991b4ed2a69d721
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2020-03-30 15:54:08
# Regressor Bug: 1625571
# File Overlap Count: 1
# Description:
#   Bug 1625571 - Invalidate canvas background in ImageLoader rather than nsDisplayBackgroundImage. r=tnikkel
#   
#   This is less error prone and also less code.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D68732
# ==============================================================================

diff -r 059be1f4b4ed -r acb3f6f0a64e layout/generic/nsFrame.cpp
--- a/layout/generic/nsFrame.cpp	Mon Mar 30 11:35:20 2020 +0300
+++ b/layout/generic/nsFrame.cpp	Mon Mar 30 08:35:34 2020 +0000
@@ -114,6 +114,7 @@
 #include "mozilla/ServoStyleSet.h"
 #include "mozilla/ServoStyleSetInlines.h"
 #include "mozilla/css/ImageLoader.h"
+#include "mozilla/dom/HTMLBodyElement.h"
 #include "mozilla/dom/SVGPathData.h"
 #include "mozilla/dom/TouchEvent.h"
 #include "mozilla/gfx/Tools.h"
@@ -614,6 +615,16 @@
   svgTextFrame->ScheduleReflowSVGNonDisplayText(IntrinsicDirty::StyleChange);
 }
 
+bool nsIFrame::IsPrimaryFrameOfRootOrBodyElement() const {
+  if (!IsPrimaryFrame()) {
+    return false;
+  }
+  nsIContent* content = GetContent();
+  Document* document = content->OwnerDoc();
+  return content == document->GetRootElement() ||
+         content == document->GetBodyElement();
+}
+
 void nsFrame::Init(nsIContent* aContent, nsContainerFrame* aParent,
                    nsIFrame* aPrevInFlow) {
   MOZ_ASSERT(nsQueryFrame::FrameIID(mClass) == GetFrameId());