# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: xpfe/appshell/AppWindow.h
# Commit: fde2d124a1b1
# Full Hash: fde2d124a1b15877570390c7c69f5fcf6770640d
# Author: Nika Layzell <nika@thelayzells.com>
# Date: 2020-04-08 03:36:50
# Regressor Bug: 1616353
# File Overlap Count: 1
# Description:
#   Bug 1616353 - Part 7.2: Create and use nsOpenWindowInfo types in nsWindowWatcher logic, r=kmag
#   
#   This patch builds on top of part 7.1 by creating this object within
#   nsWindowWatcher and ContentParent to carry the relevant information through
#   provider interfaces when creating new content windows. The nsOpenWindowInfo
# ==============================================================================

diff -r 7ccbbb127b7f -r fde2d124a1b1 xpfe/appshell/AppWindow.h
--- a/xpfe/appshell/AppWindow.h	Tue Apr 07 21:39:24 2020 +0000
+++ b/xpfe/appshell/AppWindow.h	Tue Apr 07 21:39:32 2020 +0000
@@ -139,9 +139,7 @@
   // AppWindow methods...
   nsresult Initialize(nsIAppWindow* aParent, nsIAppWindow* aOpener,
                       int32_t aInitialWidth, int32_t aInitialHeight,
-                      bool aIsHiddenWindow, nsIRemoteTab* aOpeningTab,
-                      mozIDOMWindowProxy* aOpenerWindow,
-                      nsWidgetInitData& widgetInitData);
+                      bool aIsHiddenWindow, nsWidgetInitData& widgetInitData);
 
   nsIDocShell* GetDocShell() { return mDocShell; }
 
@@ -228,13 +226,9 @@
                          int32_t aCY);
   NS_IMETHOD ExitModalLoop(nsresult aStatus);
   NS_IMETHOD CreateNewChromeWindow(int32_t aChromeFlags,
-                                   nsIRemoteTab* aOpeningTab,
-                                   mozIDOMWindowProxy* aOpenerWindow,
                                    nsIAppWindow** _retval);
   NS_IMETHOD CreateNewContentWindow(int32_t aChromeFlags,
-                                    nsIRemoteTab* aOpeningTab,
-                                    mozIDOMWindowProxy* aOpenerWindow,
-                                    uint64_t aNextRemoteTabId,
+                                    nsIOpenWindowInfo* aOpenWindowInfo,
                                     nsIAppWindow** _retval);
   NS_IMETHOD GetHasPrimaryContent(bool* aResult);
 
@@ -283,7 +277,7 @@
   uint32_t mPersistentAttributesDirty;  // persistentAttributes
   uint32_t mPersistentAttributesMask;
   uint32_t mChromeFlags;
-  uint64_t mNextRemoteTabId;
+  nsCOMPtr<nsIOpenWindowInfo> mInitialOpenWindowInfo;
   nsString mTitle;
   nsIntRect mOpenerScreenRect;  // the screen rect of the opener
 