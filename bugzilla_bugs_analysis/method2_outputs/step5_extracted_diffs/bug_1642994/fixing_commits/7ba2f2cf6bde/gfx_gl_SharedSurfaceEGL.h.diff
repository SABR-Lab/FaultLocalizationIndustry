# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: gfx/gl/SharedSurfaceEGL.h
# Commit: 7ba2f2cf6bde
# Full Hash: 7ba2f2cf6bdedd2cafd4e8717fa548e5b54dd184
# Author: Imanol Fernandez <mortimergoro@gmail.com>
# Date: 2020-07-10 09:48:19
# Description:
#   Bug 1642994 - Fix SurfaceTexture assertion failure in WebGLContext::GetFrontBuffer r=jgilbert
#   
#   - WaitForBufferOwnership() must be called before locking the front buffer
#   - Use mDefaultFB->mFB instead of 0 to fix a freeze in the readPixels call
#   - SurfaceTexture.releaseTexImage must be called after each use
# ==============================================================================

diff -r 4879dea5cdd6 -r 7ba2f2cf6bde gfx/gl/SharedSurfaceEGL.h
--- a/gfx/gl/SharedSurfaceEGL.h	Thu Jul 09 14:09:49 2020 +0000
+++ b/gfx/gl/SharedSurfaceEGL.h	Thu Jul 09 18:31:12 2020 +0000
@@ -99,6 +99,7 @@
 
   virtual void ProducerAcquireImpl() override {}
   virtual void ProducerReleaseImpl() override {}
+  virtual void ProducerReadReleaseImpl() override;
 
   Maybe<layers::SurfaceDescriptor> ToSurfaceDescriptor() override;
 
