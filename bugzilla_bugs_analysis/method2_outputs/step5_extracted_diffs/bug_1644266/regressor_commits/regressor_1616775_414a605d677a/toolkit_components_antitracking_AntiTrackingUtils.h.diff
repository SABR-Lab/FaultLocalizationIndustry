# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/components/antitracking/AntiTrackingUtils.h
# Commit: 414a605d677a
# Full Hash: 414a605d677a35d49a6c581bfe18921c694bd823
# Author: Dimi Lee <dlee@mozilla.com>
# Date: 2020-04-23 21:43:09
# Regressor Bug: 1616775
# File Overlap Count: 1
# Description:
#   Bug 1616775 - P2. Support getting principal and tracking origin by BrowsingContext. r=timhuang,baku
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D71011
# ==============================================================================

diff -r ae01b3db6250 -r 414a605d677a toolkit/components/antitracking/AntiTrackingUtils.h
--- a/toolkit/components/antitracking/AntiTrackingUtils.h	Thu Apr 23 14:24:56 2020 +0000
+++ b/toolkit/components/antitracking/AntiTrackingUtils.h	Thu Apr 23 14:25:06 2020 +0000
@@ -56,16 +56,29 @@
   // And this is meant to be called in the parent process.
   static bool HasStoragePermissionInParent(nsIChannel* aChannel);
 
-  // Return the toplevel inner window id, returns 0 if this is a toplevel
+  // Returns the toplevel inner window id, returns 0 if this is a toplevel
   // window.
   static uint64_t GetTopLevelAntiTrackingWindowId(
       dom::BrowsingContext* aBrowsingContext);
 
-  // Return the parent inner window id, returns 0 if this or the parent are not
+  // Returns the parent inner window id, returns 0 if this or the parent are not
   // a toplevel window. This is mainly used to determine the anti-tracking
   // storage area.
   static uint64_t GetTopLevelStorageAreaWindowId(
       dom::BrowsingContext* aBrowsingContext);
+
+  // Returns the principal of the given browsing context.
+  // This API should only be used either in child processes with an in-process
+  // browsing context or in the parent process.
+  static already_AddRefed<nsIPrincipal> GetPrincipal(
+      dom::BrowsingContext* aBrowsingContext);
+
+  // Returns the principal of the given browsing context and tracking origin.
+  // This API should only be used either in child processes with an in-process
+  // browsing context or in the parent process.
+  static bool GetPrincipalAndTrackingOrigin(
+      dom::BrowsingContext* aBrowsingContext, nsIPrincipal** aPrincipal,
+      nsACString& aTrackingOrigin);
 };
 
 }  // namespace mozilla