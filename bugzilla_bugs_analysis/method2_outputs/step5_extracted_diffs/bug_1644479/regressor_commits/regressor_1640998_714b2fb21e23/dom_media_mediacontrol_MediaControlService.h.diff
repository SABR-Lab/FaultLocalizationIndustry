# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/mediacontrol/MediaControlService.h
# Commit: 714b2fb21e23
# Full Hash: 714b2fb21e2341e8e2bf1be1271ca0ed5e526443
# Author: alwu <alwu@mozilla.com>
# Date: 2020-06-09 09:21:34
# Regressor Bug: 1640998
# File Overlap Count: 1
# Description:
#   Bug 1640998 - part5 : set supported keys to the event source r=chunmin
#   
#   This patch will
#   - add a method `SetSupportedMediaKeys()` on `MediaControlKeysEventSource`
#   - set main controller's supported key to the event source
# ==============================================================================

diff -r a48b6554ba9c -r 714b2fb21e23 dom/media/mediacontrol/MediaControlService.h
--- a/dom/media/mediacontrol/MediaControlService.h	Mon Jun 08 22:16:46 2020 +0000
+++ b/dom/media/mediacontrol/MediaControlService.h	Tue Jun 09 02:23:35 2020 +0000
@@ -100,6 +100,8 @@
     explicit ControllerManager(MediaControlService* aService);
     ~ControllerManager() = default;
 
+    using MediaKeysArray = nsTArray<MediaControlKeysEvent>;
+
     bool AddController(MediaController* aController);
     bool RemoveController(MediaController* aController);
     void UpdateMainControllerIfNeeded(MediaController* aController);
@@ -129,7 +131,7 @@
                                 InsertOptions aOption);
 
     void UpdateMainControllerInternal(MediaController* aController);
-    void ConnectToMainControllerEvents();
+    void ConnectMainControllerEvents();
     void DisconnectMainControllerEvents();
 
     LinkedList<RefPtr<MediaController>> mControllers;
@@ -138,8 +140,8 @@
     // These member are use to listen main controller's play state changes and
     // update the playback state to the event source.
     RefPtr<MediaControlKeysEventSource> mSource;
-    MediaEventListener mPlayStateChangedListener;
     MediaEventListener mMetadataChangedListener;
+    MediaEventListener mSupportedKeysChangedListener;
   };
 
   void Init();