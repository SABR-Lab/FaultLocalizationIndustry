# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/mediacontrol/MediaControlUtils.h
# Commit: 714b2fb21e23
# Full Hash: 714b2fb21e2341e8e2bf1be1271ca0ed5e526443
# Author: alwu <alwu@mozilla.com>
# Date: 2020-06-09 09:21:34
# Regressor Bug: 1640998
# File Overlap Count: 1
# Description:
#   Bug 1640998 - part5 : set supported keys to the event source r=chunmin
#   
#   This patch will
#   - add a method `SetSupportedMediaKeys()` on `MediaControlKeysEventSource`
#   - set main controller's supported key to the event source
# ==============================================================================

diff -r a48b6554ba9c -r 714b2fb21e23 dom/media/mediacontrol/MediaControlUtils.h
--- a/dom/media/mediacontrol/MediaControlUtils.h	Mon Jun 08 22:16:46 2020 +0000
+++ b/dom/media/mediacontrol/MediaControlUtils.h	Tue Jun 09 02:23:35 2020 +0000
@@ -89,6 +89,27 @@
   }
 }
 
+inline MediaControlKeysEvent ConvertMediaSessionActionToControlKey(
+    MediaSessionAction aAction) {
+  switch (aAction) {
+    case MediaSessionAction::Play:
+      return MediaControlKeysEvent::ePlay;
+    case MediaSessionAction::Pause:
+      return MediaControlKeysEvent::ePause;
+    case MediaSessionAction::Seekbackward:
+      return MediaControlKeysEvent::eSeekBackward;
+    case MediaSessionAction::Seekforward:
+      return MediaControlKeysEvent::eSeekForward;
+    case MediaSessionAction::Previoustrack:
+      return MediaControlKeysEvent::ePrevTrack;
+    case MediaSessionAction::Nexttrack:
+      return MediaControlKeysEvent::eNextTrack;
+    default:
+      MOZ_ASSERT(aAction == MediaSessionAction::Stop);
+      return MediaControlKeysEvent::eStop;
+  }
+}
+
 inline MediaSessionPlaybackTestState ConvertToMediaSessionPlaybackTestState(
     MediaSessionPlaybackState aState) {
   switch (aState) {
@@ -102,6 +123,11 @@
   }
 }
 
+inline MediaSessionAction ConvertToMediaSessionAction(uint8_t aActionValue) {
+  MOZ_DIAGNOSTIC_ASSERT(aActionValue < uint8_t(MediaSessionAction::EndGuard_));
+  return static_cast<MediaSessionAction>(aActionValue);
+}
+
 inline const char* ToMediaPlaybackStateStr(MediaPlaybackState aState) {
   switch (aState) {
     case MediaPlaybackState::eStarted: