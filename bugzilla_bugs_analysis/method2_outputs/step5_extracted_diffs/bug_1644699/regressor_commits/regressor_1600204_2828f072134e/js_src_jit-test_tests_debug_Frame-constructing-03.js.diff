# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/src/jit-test/tests/debug/Frame-constructing-03.js
# Commit: 2828f072134e
# Full Hash: 2828f072134e0425521de5ad9d60ae880c57e944
# Author: Logan Smyth <loganfsmyth@gmail.com>
# Date: 2019-12-09 09:50:39
# Regressor Bug: 1600204
# File Overlap Count: 1
# Description:
#   Bug 1600204 - Part 3: Support .constructing on suspended generator frames. r=jimb
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D55233
# ==============================================================================

diff -r 73c33bf110d6 -r 2828f072134e js/src/jit-test/tests/debug/Frame-constructing-03.js
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/js/src/jit-test/tests/debug/Frame-constructing-03.js	Sun Dec 08 23:53:57 2019 +0000
@@ -0,0 +1,35 @@
+// Debugger.Frame.prototype.constructing on an async generator.
+
+load(libdir + "asserts.js");
+
+const g = newGlobal({ newCompartment: true });
+const dbg = Debugger(g);
+
+g.eval(`
+async function* f() {
+  await Promise.resolve();
+}
+`);
+
+let frame;
+dbg.onEnterFrame = function(f) {
+  frame = f;
+  assertEq(frame.constructing, false);
+};
+
+(async () => {
+  const it = g.f();
+
+  assertEq(frame.constructing, false);
+  frame = null;
+
+  const promise = it.next();
+
+  assertEq(!!frame, true);
+  assertEq(frame.constructing, false);
+
+  await promise;
+
+  // Throws because the frame has terminated.
+  assertThrowsInstanceOf(() => frame.constructing, Error);
+})();
