# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: accessible/ipc/win/DocAccessibleChild.cpp
# Commit: d08313ba26df
# Full Hash: d08313ba26df045303607621d55812b37ae19cf3
# Author: James Teh <jteh@mozilla.com>
# Date: 2020-06-12 14:56:55
# Description:
#   Bug 1645067: Set the top level DocAccessibleChild as early as possible. r=MarcoZ
#   
#   Otherwise, if we're replacing a previous top level doc, we might refer to the old top level doc during initialization.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D79398
# ==============================================================================

diff -r 7c5fe3b1bec5 -r d08313ba26df accessible/ipc/win/DocAccessibleChild.cpp
--- a/accessible/ipc/win/DocAccessibleChild.cpp	Fri Jun 12 02:38:35 2020 +0000
+++ b/accessible/ipc/win/DocAccessibleChild.cpp	Fri Jun 12 07:11:02 2020 +0000
@@ -89,9 +89,8 @@
   // Iframe documents use the same window handle as their top level document.
   auto topDoc = static_cast<DocAccessibleChild*>(
       browser->GetTopLevelDocAccessibleChild());
-  // Note that topDoc can be null if we're still initializing the top level
-  // document.
-  if (topDoc && topDoc != this && topDoc->mEmulatedWindowHandle) {
+  MOZ_ASSERT(topDoc);
+  if (topDoc != this && topDoc->mEmulatedWindowHandle) {
     return topDoc->mEmulatedWindowHandle;
   }
 
