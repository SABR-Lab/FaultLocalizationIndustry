# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: netwerk/protocol/http/HttpChannelChild.h
# Commit: ac9c5c1e5162
# Full Hash: ac9c5c1e51626997c1d28923e07d220780ed02a5
# Author: Junior Hsu <juhsu@mozilla.com>
# Date: 2020-06-24 09:31:07
# Regressor Bug: 1633935
# File Overlap Count: 1
# Description:
#   Bug 1633935 - P8 suspend event queue in HttpChannelChild which needs listener for redirection, r=mayhemer,necko-reviewers
#   
#   Now OnStartRequest is passed to child process via pBg. Every IPC which is passed thru main thread could become a race.
#   For the redirection flow in child process is:
#   
# ==============================================================================

diff -r 292a5b34e9f7 -r ac9c5c1e5162 netwerk/protocol/http/HttpChannelChild.h
--- a/netwerk/protocol/http/HttpChannelChild.h	Tue Jun 23 16:57:25 2020 +0000
+++ b/netwerk/protocol/http/HttpChannelChild.h	Tue Jun 23 16:58:29 2020 +0000
@@ -459,6 +459,10 @@
   // is currently being processed.
   uint8_t mIsLastPartOfMultiPart : 1;
 
+  // True if this channel is suspended by ConnectParent and not resumed by
+  // CompleteRedirectSetup/RecvDeleteSelf.
+  uint8_t mSuspendForWaitCompleteRedirectSetup : 1;
+
   void FinishInterceptedRedirect();
   void CleanupRedirectingChannel(nsresult rv);
 
