# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/base/nsContentUtils.cpp
# Commit: b24625796fef
# Full Hash: b24625796fefc0ae7b97aa17ef34e072f0b07021
# Author: Kris Maglione <maglione.k@gmail.com>
# Date: 2020-07-14 03:18:58
# Description:
#   Bug 1650562: Add missing null check for document BrowsingContext. r=nika
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D82988
# ==============================================================================

diff -r 432e0c9d2958 -r b24625796fef dom/base/nsContentUtils.cpp
--- a/dom/base/nsContentUtils.cpp	Mon Jul 13 23:11:40 2020 +0300
+++ b/dom/base/nsContentUtils.cpp	Mon Jul 13 18:39:52 2020 +0000
@@ -5562,9 +5562,8 @@
 
   // If there is no source node, then this is a drag from another
   // application, which should be allowed.
-  RefPtr<Document> doc;
-  aDragSession->GetSourceDocument(getter_AddRefs(doc));
-  if (doc) {
+  RefPtr<Document> doc(aDragSession->GetSourceDocument());
+  if (doc && doc->GetBrowsingContext()) {
     // Get each successive parent of the source document and compare it to
     // the drop document. If they match, then this is a drag from a child frame.
     for (BrowsingContext* bc = doc->GetBrowsingContext()->GetParent(); bc;