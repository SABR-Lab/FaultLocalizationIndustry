# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/src/gc/GCRuntime.h
# Commit: c3399c3f3831
# Full Hash: c3399c3f38314b970cea6a14da8a23714a4fcc69
# Author: Jon Coppeard <jcoppeard@mozilla.com>
# Date: 2020-07-10 21:52:04
# Regressor Bug: 1652019
# File Overlap Count: 1
# Description:
#   Bug 1652019 - Factor out the logic to poll/wait on a background task r=sfink
#   
#   This happens in two places in the incrementalSlice() and we can factor it out.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D83107
# ==============================================================================

diff -r af1868142296 -r c3399c3f3831 js/src/gc/GCRuntime.h
--- a/js/src/gc/GCRuntime.h	Thu Jul 09 15:16:48 2020 +0000
+++ b/js/src/gc/GCRuntime.h	Fri Jul 10 16:59:39 2020 +0000
@@ -795,6 +795,8 @@
   void releaseRelocatedArenas(Arena* arenaList);
   void releaseRelocatedArenasWithoutUnlocking(Arena* arenaList,
                                               const AutoLockGC& lock);
+  IncrementalProgress waitForBackgroundTask(GCParallelTask& task,
+                                            SliceBudget& budget);
   void maybeRequestGCAfterBackgroundTask(const AutoLockHelperThreadState& lock);
   void cancelRequestedGCAfterBackgroundTask();
   void finishCollection();
