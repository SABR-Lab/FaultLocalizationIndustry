# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/base/Document.cpp
# Commit: 4ec12eb9788c
# Full Hash: 4ec12eb9788caed38ad9d5e8dd6490102defd767
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2020-07-22 21:55:45
# Regressor Bug: 1648064
# File Overlap Count: 1
# Description:
#   Bug 1648064 - Make print preview documents wait properly for the document to be loaded. r=smaug
#   
#   Otherwise my test fails intermittently on CI. We need to block on all
#   the load blockers because stuff like responsive images doesn't fire the
#   load directly but they do that as a micro task (blocking the load
# ==============================================================================

diff -r f735d4f6b21f -r 4ec12eb9788c dom/base/Document.cpp
--- a/dom/base/Document.cpp	Wed Jul 22 14:39:45 2020 +0000
+++ b/dom/base/Document.cpp	Wed Jul 22 14:39:47 2020 +0000
@@ -10765,6 +10765,8 @@
 
   if (mAsyncOnloadBlockCount != 0) {
     // We need to wait until the async onload block has been handled.
+    //
+    // FIXME(emilio): Shouldn't we return here??
     PostUnblockOnloadEvent();
   }
 