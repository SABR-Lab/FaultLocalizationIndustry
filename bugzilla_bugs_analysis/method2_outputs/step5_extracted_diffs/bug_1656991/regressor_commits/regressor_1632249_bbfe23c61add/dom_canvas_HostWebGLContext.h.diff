# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/canvas/HostWebGLContext.h
# Commit: bbfe23c61add
# Full Hash: bbfe23c61add07377daf80696fd6996c0463f5b6
# Author: Jeff Gilbert <jgilbert@mozilla.com>
# Date: 2020-06-09 09:21:34
# Regressor Bug: 1632249
# File Overlap Count: 1
# Description:
#   Bug 1632249 - Support compositing out-of-process WebGL. r=handyman,lsalzman,nical,geckoview-reviewers,agi,imanol
#   
#   * Majorly simplity CanvasRenderer
#   * Replace GLScreenBuffer with trivial GLSwapChain
#   * Use descriptor structs so that future SharedSurface changes aren't so painful
# ==============================================================================

diff -r 8fcfac450ecc -r bbfe23c61add dom/canvas/HostWebGLContext.h
--- a/dom/canvas/HostWebGLContext.h	Mon Jun 08 20:13:01 2020 +0000
+++ b/dom/canvas/HostWebGLContext.h	Mon Jun 08 20:34:15 2020 +0000
@@ -184,11 +184,12 @@
     mContext->SetCompositableHost(compositableHost);
   }
 
-  void Present() { mContext->Present(); }
-  void ClearVRFrame() const { mContext->ClearVRFrame(); }
+  void Present() { return (void)mContext->Present(); }
+  Maybe<layers::SurfaceDescriptor> GetFrontBuffer(
+      const layers::TextureType t) const;
 
-  Maybe<ICRData> InitializeCanvasRenderer(layers::LayersBackend backend) {
-    return mContext->InitializeCanvasRenderer(backend);
+  RefPtr<gfx::DataSourceSurface> GetFrontBufferSnapshot() const {
+    return mContext->GetFrontBufferSnapshot();
   }
 
   void Resize(const uvec2& size) { return mContext->Resize(size); }
@@ -785,10 +786,6 @@
   void OnLostContext();
   void OnRestoredContext();
 
-  // Etc
- public:
-  RefPtr<layers::SharedSurfaceTextureClient> GetVRFrame(ObjectId id) const;
-
  protected:
   WebGL2Context* GetWebGL2Context() const {
     MOZ_RELEASE_ASSERT(mContext->IsWebGL2(), "Requires WebGL2 context");