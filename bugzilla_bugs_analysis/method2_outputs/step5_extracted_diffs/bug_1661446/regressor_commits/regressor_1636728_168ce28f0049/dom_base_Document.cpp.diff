# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/base/Document.cpp
# Commit: 168ce28f0049
# Full Hash: 168ce28f004948c7b2646d5f613c1bda7af62de6
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2020-09-17 10:09:40
# Regressor Bug: 1636728
# File Overlap Count: 1
# Description:
#   Bug 1663826 - Keep freezing navigation during window.print() for compat. r=smaug
#   
#   This broke in bug 1636728 because we started setting the bit in the
#   cloned docshell rather than the original one.
#   
# ==============================================================================

diff -r 092dc1009fdf -r 168ce28f0049 dom/base/Document.cpp
--- a/dom/base/Document.cpp	Wed Sep 16 22:49:44 2020 +0000
+++ b/dom/base/Document.cpp	Wed Sep 16 22:55:19 2020 +0000
@@ -6117,11 +6117,10 @@
     SetPreferredStyleSheetSet(aData);
   }
 
-  if (aHeaderField == nsGkAtoms::refresh) {
-    // We get into this code before we have a script global yet, so get to
-    // our container via mDocumentContainer.
-    nsCOMPtr<nsIRefreshURI> refresher(mDocumentContainer);
-    if (refresher) {
+  if (aHeaderField == nsGkAtoms::refresh && !IsStaticDocument()) {
+    // We get into this code before we have a script global yet, so get to our
+    // container via mDocumentContainer.
+    if (nsCOMPtr<nsIRefreshURI> refresher = mDocumentContainer.get()) {
       // Note: using mDocumentURI instead of mBaseURI here, for consistency
       // (used to just use the current URI of our webnavigation, but that
       // should really be the same thing).  Note that this code can run