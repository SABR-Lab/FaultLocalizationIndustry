# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/components/downloads/DownloadLegacy.jsm
# Commit: a8b3c33aee21
# Full Hash: a8b3c33aee2195643896a00a9ae69cfa1a849dc7
# Author: Gijs Kruitbosch <gijskruitbosch@gmail.com>
# Date: 2020-09-03 09:45:53
# Regressor Bug: 1658202
# File Overlap Count: 2
# Description:
#   Bug 1658202 - move flushes caused by closing the stream away from the main thread, r=valentin
#   
#   Depends on D88730
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D88731
# ==============================================================================

diff -r 1b44712c42dc -r a8b3c33aee21 toolkit/components/downloads/DownloadLegacy.jsm
--- a/toolkit/components/downloads/DownloadLegacy.jsm	Wed Sep 02 23:15:06 2020 +0000
+++ b/toolkit/components/downloads/DownloadLegacy.jsm	Wed Sep 02 23:15:21 2020 +0000
@@ -122,11 +122,6 @@
             // Only cancel if the object executing the download is still running.
             if (this._cancelable && !this._componentFailed) {
               this._cancelable.cancel(Cr.NS_ERROR_ABORT);
-              if (this._cancelable instanceof Ci.nsIWebBrowserPersist) {
-                // This component will not send the STATE_STOP notification.
-                download.saver.onTransferFinished(Cr.NS_ERROR_ABORT);
-                this._cancelable = null;
-              }
             }
           });
         })
