# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/src/wasm/WasmJS.cpp
# Commit: a850ff24c2ae
# Full Hash: a850ff24c2aeaefac447d9e501f6e443f395f844
# Author: Ryan Hunt <rhunt@eqrion.net>
# Date: 2020-08-18 09:24:52
# Regressor Bug: 1561521
# File Overlap Count: 1
# Description:
#   Bug 1561521 - Clean up wasm::ToString and drop wasm::ToCString. r=lth
#   
#   wasm::ToCString is losing relevance as we have more constructed types. This
#   commit removes ToCString and replaces all uses with wasm::ToString.
#   
# ==============================================================================

diff -r 3d1a8283d2f8 -r a850ff24c2ae js/src/wasm/WasmJS.cpp
--- a/js/src/wasm/WasmJS.cpp	Tue Aug 18 00:07:29 2020 +0000
+++ b/js/src/wasm/WasmJS.cpp	Tue Aug 18 00:45:24 2020 +0000
@@ -1161,8 +1161,8 @@
       return nullptr;
     }
 
-    const char* argStr = ToCString(arg);
-    if (!buf.append(argStr, strlen(argStr))) {
+    UniqueChars argStr = ToString(arg);
+    if (!buf.append(argStr.get(), strlen(argStr.get()))) {
       return nullptr;
     }
 
@@ -1179,8 +1179,8 @@
       return nullptr;
     }
 
-    const char* resultStr = ToCString(result);
-    if (!buf.append(resultStr, strlen(resultStr))) {
+    UniqueChars resultStr = ToString(result);
+    if (!buf.append(resultStr.get(), strlen(resultStr.get()))) {
       return nullptr;
     }
 