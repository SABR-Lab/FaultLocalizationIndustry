# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: security/sandbox/mac/SandboxPolicyContent.h
# Commit: f4a5301f80a1
# Full Hash: f4a5301f80a1c5111a543081d289022e0d3cfe7f
# Author: Bert Peers <bpeers@mozilla.com>
# Date: 2020-10-03 10:23:35
# Regressor Bug: 1649490
# File Overlap Count: 2
# Description:
#   Bug 1668145 - Detect all Mac GPUs. r=jrmuizel,haik
#   
#   This also adds a diagonstic assert to make sure the code works in all process types.
#   And it adds another item to the sandbox IOKit property name allowlist, so that
#   the detection works in content processes.
# ==============================================================================

diff -r 22be77d681b6 -r f4a5301f80a1 security/sandbox/mac/SandboxPolicyContent.h
--- a/security/sandbox/mac/SandboxPolicyContent.h	Fri Oct 02 15:00:28 2020 +0000
+++ b/security/sandbox/mac/SandboxPolicyContent.h	Fri Oct 02 01:10:20 2020 +0000
@@ -195,6 +195,7 @@
   (if (defined? 'iokit-get-properties)
     (allow iokit-get-properties
       (iokit-property "board-id")
+      (iokit-property "class-code")
       (iokit-property "vendor-id")
       (iokit-property "device-id")
       (iokit-property "IODVDBundleName")