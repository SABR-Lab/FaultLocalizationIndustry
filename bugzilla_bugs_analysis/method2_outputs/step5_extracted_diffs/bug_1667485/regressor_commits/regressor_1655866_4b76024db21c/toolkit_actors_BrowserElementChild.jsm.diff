# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/actors/BrowserElementChild.jsm
# Commit: 4b76024db21c
# Full Hash: 4b76024db21cff006a7424a35c412c6e0a153eb0
# Author: Kris Maglione <maglione.k@gmail.com>
# Date: 2020-09-22 03:47:42
# Regressor Bug: 1655866
# File Overlap Count: 1
# Description:
#   Bug 1655866: Part 5 - Use native PermitUnload implementation from front-end code. r=nika,mconley
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D88318
# ==============================================================================

diff -r 55fb069319f1 -r 4b76024db21c toolkit/actors/BrowserElementChild.jsm
--- a/toolkit/actors/BrowserElementChild.jsm	Mon Sep 21 22:41:01 2020 +0000
+++ b/toolkit/actors/BrowserElementChild.jsm	Mon Sep 21 22:41:04 2020 +0000
@@ -17,24 +17,7 @@
   }
 
   receiveMessage(message) {
-    let context = this.manager.browsingContext;
-    let docShell = context.docShell;
-
     switch (message.name) {
-      case "PermitUnload": {
-        this.sendAsyncMessage("Running", {});
-
-        let permitUnload = true;
-        if (docShell && docShell.contentViewer) {
-          permitUnload = docShell.contentViewer.permitUnload(
-            message.data.flags
-          );
-        }
-
-        this.sendAsyncMessage("Done", { permitUnload });
-        break;
-      }
-
       case "EnterModalState": {
         this.contentWindow.windowUtils.enterModalState();
         break;