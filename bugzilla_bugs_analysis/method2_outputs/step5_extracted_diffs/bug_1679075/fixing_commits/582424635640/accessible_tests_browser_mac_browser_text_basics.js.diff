# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: accessible/tests/browser/mac/browser_text_basics.js
# Commit: 582424635640
# Full Hash: 5824246356401f8bc1f978dc1bc1bfa4b11586ae
# Author: Eitan Isaacson <eitan@monotonous.org>
# Date: 2020-12-01 04:19:24
# Description:
#   Bug 1679075 - Don't go past empty input field in HyperTextIterator::Next. r=morgan
#   
#   The normalize function was putting the current container/offset past the end boundary. This caused overruns with getting the text for the range of the input object, and some unexpected invalid ranges.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D98236
# ==============================================================================

diff -r b12f5962b9d2 -r 582424635640 accessible/tests/browser/mac/browser_text_basics.js
--- a/accessible/tests/browser/mac/browser_text_basics.js	Mon Nov 30 19:47:32 2020 +0000
+++ b/accessible/tests/browser/mac/browser_text_basics.js	Mon Nov 30 20:46:15 2020 +0000
@@ -245,3 +245,21 @@
     is(stringForRange(macDoc, range), "ello good");
   }
 );
+
+addAccessibleTask(
+  `<input id="input" value=""><a href="#">goodbye</a>`,
+  async (browser, accDoc) => {
+    let macDoc = accDoc.nativeInterface.QueryInterface(
+      Ci.nsIAccessibleMacInterface
+    );
+
+    let input = getNativeInterface(accDoc, "input");
+
+    let range = macDoc.getParameterizedAttributeValue(
+      "AXTextMarkerRangeForUIElement",
+      input
+    );
+
+    is(stringForRange(macDoc, range), "", "string value is correct");
+  }
+);
