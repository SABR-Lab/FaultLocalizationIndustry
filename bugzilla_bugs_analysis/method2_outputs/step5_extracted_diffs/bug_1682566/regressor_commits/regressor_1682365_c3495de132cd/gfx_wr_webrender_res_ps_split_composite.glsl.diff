# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/wr/webrender/res/ps_split_composite.glsl
# Commit: c3495de132cd
# Full Hash: c3495de132cd01ce51341fb38b4e2f001dea14f5
# Author: Glenn Watson <git@intuitionlibrary.com>
# Date: 2020-12-18 04:07:40
# Regressor Bug: 1682365
# File Overlap Count: 1
# Description:
#   Bug 1682365 - Pt 1 - Remove PrevPassAlpha and PrevPassColor r=nical
#   
#   Remove usage of the implicit prev pass alpha and color texture
#   samplers from batching / renderer / shader code. They are replaced
#   by explicit references to the texture ID for the source task.
# ==============================================================================

diff -r 897f30ea5f53 -r c3495de132cd gfx/wr/webrender/res/ps_split_composite.glsl
--- a/gfx/wr/webrender/res/ps_split_composite.glsl	Thu Dec 17 20:54:57 2020 +0000
+++ b/gfx/wr/webrender/res/ps_split_composite.glsl	Thu Dec 17 19:53:54 2020 +0000
@@ -86,7 +86,7 @@
 
     gl_Position = uTransform * final_pos;
 
-    vec2 texture_size = vec2(textureSize(sPrevPassColor, 0));
+    vec2 texture_size = vec2(textureSize(sColor0, 0));
     vec2 uv0 = res.uv_rect.p0;
     vec2 uv1 = res.uv_rect.p1;
 
@@ -113,6 +113,6 @@
     float alpha = do_clip();
     float perspective_divisor = mix(gl_FragCoord.w, 1.0, vLayerAndPerspective.y);
     vec2 uv = clamp(vUv * perspective_divisor, vUvSampleBounds.xy, vUvSampleBounds.zw);
-    write_output(alpha * textureLod(sPrevPassColor, vec3(uv, vLayerAndPerspective.x), 0.0));
+    write_output(alpha * textureLod(sColor0, vec3(uv, vLayerAndPerspective.x), 0.0));
 }
 #endif