# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/cache/DBSchema.cpp
# Commit: a8625d790fe8
# Full Hash: a8625d790fe85f6a5bb949d5b1644753796a0d4d
# Author: Simon Giesecke <sgiesecke@mozilla.com>
# Date: 2021-01-19 03:30:20
# Description:
#   Bug 1684838 - Check result of CreateAndExecuteSingleStepStatement in ReadRequest. r=jstutte
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D102185
# ==============================================================================

diff -r 812caf90c2c5 -r a8625d790fe8 dom/cache/DBSchema.cpp
--- a/dom/cache/DBSchema.cpp	Mon Jan 18 12:51:20 2021 +0000
+++ b/dom/cache/DBSchema.cpp	Mon Jan 18 12:57:26 2021 +0000
@@ -2296,6 +2296,8 @@
                           return Ok{};
                         }));
 
+  CACHE_TRY(OkIf(state), Err(NS_ERROR_UNEXPECTED));
+
   nsresult rv = state->GetUTF8String(0, savedRequest.mValue.method());
   if (NS_WARN_IF(NS_FAILED(rv))) {
     return Err(rv);
