# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/wr/webrender/src/render_task_cache.rs
# Commit: e38dce4a5b06
# Full Hash: e38dce4a5b06869dd4a4d753f41f7594a8cddfb6
# Author: Nicolas Silva <nsilva@mozilla.com>
# Date: 2021-04-22 21:31:57
# Regressor Bug: 1702228
# File Overlap Count: 2
# Description:
#   Bug 1702228 - Cache linear gradients by default. r=gw
#   
#   This patch breaks linear gradients into two primitives:
#    - LinearGradient is always rendered via the brush shader. It is only used with SWGL.
#    - CachedLinearGradient is always rendered via a cached render task and the brush image shader. Its implementation is very similar to conic and radial gradients, with the addition of a fast-path for axis aligned gradients with two stops.
# ==============================================================================

diff -r b3f8befa510f -r e38dce4a5b06 gfx/wr/webrender/src/render_task_cache.rs
--- a/gfx/wr/webrender/src/render_task_cache.rs	Thu Apr 22 10:34:54 2021 +0000
+++ b/gfx/wr/webrender/src/render_task_cache.rs	Thu Apr 22 10:34:54 2021 +0000
@@ -13,7 +13,10 @@
 use crate::internal_types::FastHashMap;
 use crate::picture::{SurfaceIndex, SurfaceInfo};
 use crate::prim_store::image::ImageCacheKey;
-use crate::prim_store::gradient::{FastLinearGradientCacheKey, RadialGradientCacheKey, ConicGradientCacheKey};
+use crate::prim_store::gradient::{
+    FastLinearGradientCacheKey, LinearGradientCacheKey, RadialGradientCacheKey,
+    ConicGradientCacheKey,
+};
 use crate::prim_store::line_dec::LineDecorationCacheKey;
 use crate::resource_cache::CacheItem;
 use std::{mem, usize, f32, i32};
@@ -46,6 +49,7 @@
     BorderSegment(BorderSegmentCacheKey),
     LineDecoration(LineDecorationCacheKey),
     FastLinearGradient(FastLinearGradientCacheKey),
+    LinearGradient(LinearGradientCacheKey),
     RadialGradient(RadialGradientCacheKey),
     ConicGradient(ConicGradientCacheKey),
 }