# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/gtk/nsWindow.cpp
# Commit: 5a2bb4ad146d
# Full Hash: 5a2bb4ad146db9bc75e31c8a9c636be220741a36
# Author: Robert Mader <robert.mader@posteo.de>
# Date: 2021-04-27 22:18:30
# Regressor Bug: 1707577
# File Overlap Count: 1
# Description:
#   Bug 1707577 - Drop dlsym for gtk_widget_is_visible(), r=stransky
#   
#   It was introduced in GDK 3.8, we require 3.14 now.
#   
#   Depends on D113404
# ==============================================================================

diff -r 481d9de05d33 -r 5a2bb4ad146d widget/gtk/nsWindow.cpp
--- a/widget/gtk/nsWindow.cpp	Tue Apr 27 18:57:59 2021 +0000
+++ b/widget/gtk/nsWindow.cpp	Tue Apr 27 18:58:00 2021 +0000
@@ -1733,11 +1733,7 @@
 
   // A workaround for https://gitlab.gnome.org/GNOME/gtk/issues/1986
   // gdk_window_move_to_rect() does not reposition visible windows.
-  static auto sGtkWidgetIsVisible =
-      (gboolean(*)(GtkWidget*))dlsym(RTLD_DEFAULT, "gtk_widget_is_visible");
-
-  bool isWidgetVisible =
-      (sGtkWidgetIsVisible != nullptr) && sGtkWidgetIsVisible(mShell);
+  bool isWidgetVisible = gtk_widget_is_visible(mShell);
   if (isWidgetVisible) {
     LOG(
         ("  temporary hide popup due to "
