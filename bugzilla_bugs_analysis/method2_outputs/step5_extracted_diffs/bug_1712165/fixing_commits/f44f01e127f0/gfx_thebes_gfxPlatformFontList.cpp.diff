# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: gfx/thebes/gfxPlatformFontList.cpp
# Commit: f44f01e127f0
# Full Hash: f44f01e127f0dcc96d74bd10606b318e41946906
# Author: Jonathan Kew <jkew@mozilla.com>
# Date: 2021-05-22 03:53:20
# Description:
#   Bug 1712165 - Reorder conditions to avoid a possible race between the InitFontList thread and main thread accessing gfxPlatformFontList. r=lsalzman
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D115690
# ==============================================================================

diff -r 360f7d0ede58 -r f44f01e127f0 gfx/thebes/gfxPlatformFontList.cpp
--- a/gfx/thebes/gfxPlatformFontList.cpp	Fri May 21 16:30:21 2021 +0000
+++ b/gfx/thebes/gfxPlatformFontList.cpp	Fri May 21 16:39:17 2021 +0000
@@ -464,7 +464,7 @@
     LOG_FONTINIT(("(fontinit) system fontlist initialization\n"));
   }
 
-  if (mFontlistInitCount) {
+  if (IsInitialized()) {
     // Font-list reinitialization always occurs on the main thread, in response
     // to a change notification; it's only the initial creation during startup
     // that may be on another thread.