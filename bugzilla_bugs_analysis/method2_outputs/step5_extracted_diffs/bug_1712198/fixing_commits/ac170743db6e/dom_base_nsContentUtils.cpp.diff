# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/base/nsContentUtils.cpp
# Commit: ac170743db6e
# Full Hash: ac170743db6e3739747938e47c51f57227662c72
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2021-05-26 09:48:46
# Description:
#   Bug 1712198 - Unwrap object in IsCallerChromeOrErrorPage. r=edgar
#   
#   This is what e.g. our use counter setup does:
#   
#     https://searchfox.org/mozilla-central/rev/6e630edb09c3ab06d0103665b16c9ea7dce782c5/dom/bindings/BindingUtils.cpp#4037
# ==============================================================================

diff -r 57e00910ad33 -r ac170743db6e dom/base/nsContentUtils.cpp
--- a/dom/base/nsContentUtils.cpp	Tue May 25 12:53:34 2021 +0000
+++ b/dom/base/nsContentUtils.cpp	Tue May 25 13:02:59 2021 +0000
@@ -2135,7 +2135,8 @@
   if (ThreadsafeIsSystemCaller(aCx)) {
     return true;
   }
-  nsGlobalWindowInner* win = xpc::WindowGlobalOrNull(aObject);
+  nsGlobalWindowInner* win =
+      xpc::WindowGlobalOrNull(js::UncheckedUnwrap(aObject));
   if (!win) {
     return false;
   }
