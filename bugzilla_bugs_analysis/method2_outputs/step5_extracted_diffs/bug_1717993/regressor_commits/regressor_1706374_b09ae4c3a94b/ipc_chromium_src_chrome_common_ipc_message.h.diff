# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: ipc/chromium/src/chrome/common/ipc_message.h
# Commit: b09ae4c3a94b
# Full Hash: b09ae4c3a94b663279189c50172c1f403d499183
# Author: Nika Layzell <nika@thelayzells.com>
# Date: 2021-06-22 21:29:07
# Regressor Bug: 1706374
# File Overlap Count: 1
# Description:
#   Bug 1706374 - Part 11: Add NodeController component bridging IPC and Ports, r=handyman
#   
#   The NodeController and NodeChannel types act as the backbone connecting the
#   existing IPC logic and driving the ports routing code. Individual NodeChannel
#   objects wrap and respond to messages from IPC::Channel, and the NodeController
# ==============================================================================

diff -r 04422175004b -r b09ae4c3a94b ipc/chromium/src/chrome/common/ipc_message.h
--- a/ipc/chromium/src/chrome/common/ipc_message.h	Mon Jun 21 21:53:10 2021 +0000
+++ b/ipc/chromium/src/chrome/common/ipc_message.h	Mon Jun 21 21:53:10 2021 +0000
@@ -11,6 +11,7 @@
 
 #include "base/basictypes.h"
 #include "base/pickle.h"
+#include "mojo/core/ports/user_message.h"
 #include "mozilla/RefPtr.h"
 #include "mozilla/TimeStamp.h"
 
@@ -44,8 +45,10 @@
 #endif
 struct LogData;
 
-class Message : public Pickle {
+class Message : public mojo::core::ports::UserMessage, public Pickle {
  public:
+  static const TypeInfo kUserMessageTypeInfo;
+
   typedef uint32_t msgid_t;
 
   enum NestedLevel {
@@ -275,6 +278,9 @@
   // We should not be sending messages that are smaller than our header size.
   void AssertAsLargeAsHeader() const;
 
+  // UserMessage implementation
+  size_t GetSizeIfSerialized() const override { return size(); }
+
   void WriteFooter(const void* data, uint32_t data_len);
   [[nodiscard]] bool ReadFooter(void* buffer, uint32_t buffer_len);
   uint32_t FooterSize() const;