# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/libwebrtcglue/MediaConduitInterface.h
# Commit: 83122b946cad
# Full Hash: 83122b946cada91c9df705e66e4cbca68eb49852
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2021-11-01 18:17:33
# Regressor Bug: 1654112
# File Overlap Count: 5
# Description:
#   Bug 1654112 - Make MediaSessionConduit::DeliverPacket async. r=bwc
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D107064
# ==============================================================================

diff -r 0e22eb5eaa5c -r 83122b946cad dom/media/webrtc/libwebrtcglue/MediaConduitInterface.h
--- a/dom/media/webrtc/libwebrtcglue/MediaConduitInterface.h	Thu Mar 25 16:55:12 2021 -0500
+++ b/dom/media/webrtc/libwebrtcglue/MediaConduitInterface.h	Thu Feb 25 17:40:18 2021 +0100
@@ -129,6 +129,7 @@
 
  public:
   enum Type { AUDIO, VIDEO };
+  enum class PacketType { RTP, RTCP };
 
   static std::string LocalDirectionToString(
       const MediaSessionConduitLocalDirection aDirection) {
@@ -146,8 +147,8 @@
    * Obtained packets are passed to the Media-Engine for further
    * processing , say, decoding
    */
-  virtual MediaConduitErrorCode ReceivedRTPPacket(
-      const void* data, int len, webrtc::RTPHeader& header) = 0;
+  virtual void ReceivedRTPPacket(const uint8_t* data, int len,
+                                 webrtc::RTPHeader& header) = 0;
 
   /**
    * Function triggered on Incoming RTCP packet from the remote
@@ -157,8 +158,7 @@
    * Obtained packets are passed to the Media-Engine for further
    * processing , say, decoding
    */
-  virtual MediaConduitErrorCode ReceivedRTCPPacket(const void* data,
-                                                   int len) = 0;
+  virtual void ReceivedRTCPPacket(const uint8_t* data, int len) = 0;
 
   virtual Maybe<DOMHighResTimeStamp> LastRtcpReceived() const = 0;
   virtual DOMHighResTimeStamp GetNow() const = 0;
@@ -228,7 +228,8 @@
 
   virtual bool HasCodecPluginID(uint64_t aPluginID) = 0;
 
-  virtual MediaConduitErrorCode DeliverPacket(const void* data, int len) = 0;
+  virtual void DeliverPacket(rtc::CopyOnWriteBuffer packet,
+                             PacketType type) = 0;
 
   virtual void DeleteStreams() = 0;
 