# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: media/webrtc/signaling/gtest/mediapipeline_unittest.cpp
# Commit: 8d80a4ba914c
# Full Hash: 8d80a4ba914c6f81430ba1c55471a8d2b3aac60e
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2021-11-01 18:17:33
# Regressor Bug: 1654112
# File Overlap Count: 2
# Description:
#   Bug 1654112 - Create CallWorkerThread which implements AbstractThread for a TaskQueueWrapper. r=ng
#   
#   Ideally TaskQueueWrapper would implement both webrtc::TaskQueueBase and
#   AbstractThread, but webrtc::TaskQueueBase is not refcounted so implementing both
#   in the same class is not possible.
# ==============================================================================

diff -r e0a2e54e4de8 -r 8d80a4ba914c media/webrtc/signaling/gtest/mediapipeline_unittest.cpp
--- a/media/webrtc/signaling/gtest/mediapipeline_unittest.cpp	Thu Apr 08 11:31:43 2021 +0200
+++ b/media/webrtc/signaling/gtest/mediapipeline_unittest.cpp	Mon Apr 12 14:49:20 2021 +0200
@@ -268,7 +268,8 @@
             MakeUnique<media::ShutdownBlockingTicket>(
                 u"WebrtcCallWrapper shutdown blocker"_ns,
                 NS_LITERAL_STRING_FROM_CSTRING(__FILE__), __LINE__),
-            aModuleThread, aAudioStateConfig, aAudioDecoderFactory, aTrials)),
+            AbstractThread::MainThread(), aModuleThread, aAudioStateConfig,
+            aAudioDecoderFactory, aTrials)),
         audio_conduit_(
             AudioSessionConduit::Create(call_, test_utils->sts_target())),
         audio_pipeline_(),
