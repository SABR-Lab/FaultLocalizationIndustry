# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/transportbridge/MediaPipeline.h
# Commit: 970ed33359b5
# Full Hash: 970ed33359b5223277984f77c521faaa0079aa88
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2021-11-01 18:17:33
# Regressor Bug: 1654112
# File Overlap Count: 2
# Description:
#   Bug 1654112 - Implement MediaConduitControl for controlling conduits async through state mirroring. r=ng,bwc
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D112868
# ==============================================================================

diff -r ed2e505b5873 -r 970ed33359b5 dom/media/webrtc/transportbridge/MediaPipeline.h
--- a/dom/media/webrtc/transportbridge/MediaPipeline.h	Wed Apr 21 01:13:43 2021 +0200
+++ b/dom/media/webrtc/transportbridge/MediaPipeline.h	Tue Aug 10 14:13:49 2021 +0200
@@ -86,6 +86,7 @@
                 RefPtr<MediaTransportHandler> aTransportHandler,
                 DirectionType aDirection,
                 RefPtr<nsISerialEventTarget> aMainThread,
+                RefPtr<AbstractThread> aCallThread,
                 RefPtr<nsISerialEventTarget> aStsThread,
                 RefPtr<MediaSessionConduit> aConduit);
 
@@ -222,6 +223,7 @@
   // Pointers to the threads we need. Initialized at creation
   // and used all over the place.
   const RefPtr<nsISerialEventTarget> mMainThread;
+  const RefPtr<AbstractThread> mCallThread;
   const RefPtr<nsISerialEventTarget> mStsThread;
 
  protected:
@@ -278,6 +280,7 @@
   MediaPipelineTransmit(const std::string& aPc,
                         RefPtr<MediaTransportHandler> aTransportHandler,
                         RefPtr<nsISerialEventTarget> aMainThread,
+                        RefPtr<AbstractThread> aCallThread,
                         RefPtr<nsISerialEventTarget> aStsThread, bool aIsVideo,
                         RefPtr<MediaSessionConduit> aConduit);
 
@@ -363,6 +366,7 @@
   MediaPipelineReceive(const std::string& aPc,
                        RefPtr<MediaTransportHandler> aTransportHandler,
                        RefPtr<nsISerialEventTarget> aMainThread,
+                       RefPtr<AbstractThread> aCallThread,
                        RefPtr<nsISerialEventTarget> aStsThread,
                        RefPtr<MediaSessionConduit> aConduit);
 
@@ -377,6 +381,7 @@
   MediaPipelineReceiveAudio(const std::string& aPc,
                             RefPtr<MediaTransportHandler> aTransportHandler,
                             RefPtr<nsISerialEventTarget> aMainThread,
+                            RefPtr<AbstractThread> aCallThread,
                             RefPtr<nsISerialEventTarget> aStsThread,
                             RefPtr<AudioSessionConduit> aConduit,
                             const RefPtr<dom::MediaStreamTrack>& aTrack,
@@ -407,6 +412,7 @@
   MediaPipelineReceiveVideo(const std::string& aPc,
                             RefPtr<MediaTransportHandler> aTransportHandler,
                             RefPtr<nsISerialEventTarget> aMainThread,
+                            RefPtr<AbstractThread> aCallThread,
                             RefPtr<nsISerialEventTarget> aStsThread,
                             RefPtr<VideoSessionConduit> aConduit,
                             const RefPtr<dom::MediaStreamTrack>& aTrack,