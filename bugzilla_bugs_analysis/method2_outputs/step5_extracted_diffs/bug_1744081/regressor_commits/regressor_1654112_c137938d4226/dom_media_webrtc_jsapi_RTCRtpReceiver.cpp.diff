# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/jsapi/RTCRtpReceiver.cpp
# Commit: c137938d4226
# Full Hash: c137938d422606ad8ee3bceb50dac639fa2a562d
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2021-11-01 18:17:33
# Regressor Bug: 1654112
# File Overlap Count: 2
# Description:
#   Bug 1654112 - Make MediaPipeline natively async with WatchManager. r=bwc
#   
#   On its own this patch should mainly be seen as a refactor of the way we handle
#   races in MediaPipelineTransmit::SetTrack. Namely that Stop() immediately
#   followed by SetTrack was exposed to racing prior to this patch.
# ==============================================================================

diff -r af4c24767e48 -r c137938d4226 dom/media/webrtc/jsapi/RTCRtpReceiver.cpp
--- a/dom/media/webrtc/jsapi/RTCRtpReceiver.cpp	Fri Apr 09 10:26:12 2021 +0200
+++ b/dom/media/webrtc/jsapi/RTCRtpReceiver.cpp	Tue Apr 13 15:02:15 2021 +0200
@@ -499,7 +499,7 @@
 void RTCRtpReceiver::Shutdown() {
   ASSERT_ON_THREAD(mMainThread);
   if (mPipeline) {
-    mPipeline->Shutdown_m();
+    mPipeline->Shutdown();
     mPipeline->mConduit->SetRtcpEventObserver(nullptr);
     mPipeline = nullptr;
   }