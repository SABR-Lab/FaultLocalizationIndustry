# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/canvas/PWebGL.ipdl
# Commit: 3d201ea88341
# Full Hash: 3d201ea8834161911890a06bae578b64d18eefa9
# Author: Kelsey Gilbert <jgilbert@mozilla.com>
# Date: 2021-12-15 09:11:58
# Regressor Bug: 1746111
# File Overlap Count: 1
# Description:
#   Bug 1746111 - (Re)serialize WebRTC frame SurfaceDescriptorBuffers for convert-and-upload on WebGLParent. r=gfx-reviewers,nika,lsalzman
#   
#   Also generally de-inline (WebGLParent::TexImage not DispatchCommand)
#   TexImage(SurfaceDescriptor).
#   
# ==============================================================================

diff -r a87211c8eedd -r 3d201ea88341 dom/canvas/PWebGL.ipdl
--- a/dom/canvas/PWebGL.ipdl	Wed Dec 15 01:49:11 2021 +0000
+++ b/dom/canvas/PWebGL.ipdl	Wed Dec 15 01:54:21 2021 +0000
@@ -11,7 +11,7 @@
 using mozilla::layers::SurfaceDescriptor from "mozilla/layers/LayersTypes.h";
 using std::string from "string";
 using mozilla::uvec2 from "mozilla/dom/WebGLIpdl.h";
-using mozilla::webgl::Int32Vector from "mozilla/dom/WebGLIpdl.h";
+using mozilla::uvec3 from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::CompileResult from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::ContextLossReason from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::FrontBufferSnapshotIpc from "mozilla/dom/WebGLIpdl.h";
@@ -20,10 +20,12 @@
 using mozilla::webgl::InitContextResult from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::Int32Vector from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::LinkResult from "mozilla/dom/WebGLIpdl.h";
-using mozilla::webgl::ShaderPrecisionFormat from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::OpaqueFramebufferOptions from "mozilla/dom/WebGLIpdl.h";
+using mozilla::webgl::PackingInfo from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::ReadPixelsDesc from "mozilla/dom/WebGLIpdl.h";
 using mozilla::webgl::ReadPixelsResultIpc from "mozilla/dom/WebGLIpdl.h";
+using mozilla::webgl::ShaderPrecisionFormat from "mozilla/dom/WebGLIpdl.h";
+[MoveOnly] using mozilla::webgl::TexUnpackBlobDesc from "mozilla/dom/WebGLIpdl.h";
 
 namespace mozilla {
 namespace dom {
@@ -47,6 +49,9 @@
 
   async DispatchCommands(Shmem commands, uint64_t size);
 
+  async TexImage(uint32_t level, uint32_t respecFormat, uvec3 offset,
+                 PackingInfo pi, TexUnpackBlobDesc src);
+
   // -
 
   sync GetBufferSubData(uint32_t target, uint64_t srcByteOffset, uint64_t byteSize) returns (Shmem ret);