# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: docshell/base/CanonicalBrowsingContext.h
# Commit: e9fc94b33da9
# Full Hash: e9fc94b33da9dc047b37e8bd2efe7f6b20fda079
# Author: Peter Van der Beken <peterv@propagandism.org>
# Date: 2021-12-14 21:34:09
# Regressor Bug: 1742865
# File Overlap Count: 1
# Description:
#   Bug 1742865 - Handle meta refresh correctly with session history in the parent. r=smaug
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D132837
# ==============================================================================

diff -r f5bcc7acaf26 -r e9fc94b33da9 docshell/base/CanonicalBrowsingContext.h
--- a/docshell/base/CanonicalBrowsingContext.h	Tue Dec 14 10:10:32 2021 +0000
+++ b/docshell/base/CanonicalBrowsingContext.h	Tue Dec 14 10:13:58 2021 +0000
@@ -459,6 +459,12 @@
 
   void RemovePendingDiscard();
 
+  bool ShouldAddEntryForRefresh(const SessionHistoryEntry* aEntry) {
+    nsCOMPtr<nsIURI> currentURI = GetCurrentURI();
+    return BrowsingContext::ShouldAddEntryForRefresh(currentURI,
+                                                     aEntry->Info());
+  }
+
   // XXX(farre): Store a ContentParent pointer here rather than mProcessId?
   // Indicates which process owns the docshell.
   uint64_t mProcessId;