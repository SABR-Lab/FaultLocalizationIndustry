# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/TextEvents.h
# Commit: 5f90ad3d8781
# Full Hash: 5f90ad3d87818a0810f74bde3bfc71d485eea801
# Author: Masayuki Nakano <masayuki@d-toybox.com>
# Date: 2022-02-08 17:32:27
# Regressor Bug: 1746104
# File Overlap Count: 1
# Description:
#   Bug 1746104 - part 5-1: Get rid of `WidgetQueryContentEvent::Reply::mHasSelection` r=m_kato
#   
#   It's intended to indicate whether the selection is collapsed or not, but it can
#   be referred by other members, there is no reasonable user and the name makes
#   developers confused.
# ==============================================================================

diff -r dc81d96d0adb -r 5f90ad3d8781 widget/TextEvents.h
--- a/widget/TextEvents.h	Mon Feb 07 22:33:37 2022 +0000
+++ b/widget/TextEvents.h	Mon Feb 07 22:33:37 2022 +0000
@@ -1173,8 +1173,6 @@
     CopyableTArray<mozilla::LayoutDeviceIntRect> mRectArray;
     // true if selection is reversed (end < start)
     bool mReversed;
-    // true if the selection exists
-    bool mHasSelection;
     // true if DOM element under mouse belongs to widget
     bool mWidgetIsHit;
 
@@ -1184,7 +1182,6 @@
           mContentsRoot(nullptr),
           mFocusedWidget(nullptr),
           mReversed(false),
-          mHasSelection(false),
           mWidgetIsHit(false) {}
 
     // Don't allow to copy/move because of `mEventMessage`.
@@ -1272,8 +1269,7 @@
                   << ToString(aReply.mTentativeCaretOffset).c_str() << ", ";
         }
       }
-      aStream << "mHasSelection=" << (aReply.mHasSelection ? "true" : "false");
-      if (aReply.mHasSelection) {
+      if (aReply.mOffsetAndData.isSome() && aReply.mOffsetAndData->Length()) {
         if (aReply.mEventMessage == eQuerySelectedText) {
           aStream << ", mReversed=" << (aReply.mReversed ? "true" : "false");
         }