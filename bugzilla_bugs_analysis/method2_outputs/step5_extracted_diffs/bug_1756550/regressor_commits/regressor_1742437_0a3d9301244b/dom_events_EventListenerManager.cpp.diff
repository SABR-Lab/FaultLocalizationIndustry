# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/events/EventListenerManager.cpp
# Commit: 0a3d9301244b
# Full Hash: 0a3d9301244b91559c4c19314ce991525d9f605c
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2022-02-18 21:52:29
# Regressor Bug: 1742437
# File Overlap Count: 1
# Description:
#   Bug 1742437 - move mElement from ScriptFetchOptions to DOMScriptLoadContext; r=jonco,smaug
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D136742
# ==============================================================================

diff -r 46d45c7bae2f -r 0a3d9301244b dom/events/EventListenerManager.cpp
--- a/dom/events/EventListenerManager.cpp	Fri Feb 18 12:45:48 2022 +0000
+++ b/dom/events/EventListenerManager.cpp	Fri Feb 18 12:45:49 2022 +0000
@@ -1235,10 +1235,11 @@
   }
 
   RefPtr<ScriptFetchOptions> fetchOptions = new ScriptFetchOptions(
-      CORS_NONE, aElement->OwnerDoc()->GetReferrerPolicy(), aElement,
+      CORS_NONE, aElement->OwnerDoc()->GetReferrerPolicy(),
       aElement->OwnerDoc()->NodePrincipal(), nullptr);
 
-  RefPtr<EventScript> eventScript = new EventScript(fetchOptions, uri);
+  RefPtr<EventScript> eventScript =
+      new EventScript(fetchOptions, uri, aElement);
 
   JS::CompileOptions options(cx);
   // Use line 0 to make the function body starts from line 1.