# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/script/ModuleLoader.cpp
# Commit: 1751a35aae40
# Full Hash: 1751a35aae40046ff5a7edb4bd43b1fc83b250ff
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2022-02-21 21:39:46
# Regressor Bug: 1742437
# File Overlap Count: 1
# Description:
#   Bug 1742437 - move mWebExtGlobal from ScriptLoadRequest to DOMScriptLoadContext; r=jonco,smaug
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D136744
# ==============================================================================

diff -r 835c89a0687b -r 1751a35aae40 dom/script/ModuleLoader.cpp
--- a/dom/script/ModuleLoader.cpp	Mon Feb 21 15:39:05 2022 +0000
+++ b/dom/script/ModuleLoader.cpp	Mon Feb 21 15:39:06 2022 +0000
@@ -114,9 +114,9 @@
   // Update the module map to indicate that a module is currently being fetched.
 
   MOZ_ASSERT(aRequest->IsLoading());
-  MOZ_ASSERT(
-      !ModuleMapContainsURL(aRequest->mURI, aRequest->GetWebExtGlobal()));
-  ModuleMapKey key(aRequest->mURI, aRequest->GetWebExtGlobal());
+  MOZ_ASSERT(!ModuleMapContainsURL(aRequest->mURI,
+                                   aRequest->mLoadContext->GetWebExtGlobal()));
+  ModuleMapKey key(aRequest->mURI, aRequest->mLoadContext->GetWebExtGlobal());
   mFetchingModules.InsertOrUpdate(
       key, RefPtr<GenericNonExclusivePromise::Private>{});
 }
@@ -134,7 +134,7 @@
        "%u)",
        aRequest, aRequest->mModuleScript.get(), unsigned(aResult)));
 
-  ModuleMapKey key(aRequest->mURI, aRequest->GetWebExtGlobal());
+  ModuleMapKey key(aRequest->mURI, aRequest->mLoadContext->GetWebExtGlobal());
   RefPtr<GenericNonExclusivePromise::Private> promise;
   if (!mFetchingModules.Remove(key, getter_AddRefs(promise))) {
     LOG(