# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/script/ScriptLoadContext.cpp
# Commit: 7d5683180ac3
# Full Hash: 7d5683180ac3f9e7cc96d68dde27b8b48642a7ac
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2022-02-18 09:08:22
# Regressor Bug: 1742437
# File Overlap Count: 5
# Description:
#   Bug 1742437 - re-scope all generic module/script loader files under js/loader; r=jonco
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D138133
# ==============================================================================

diff -r a48aff5f2555 -r 7d5683180ac3 dom/script/ScriptLoadContext.cpp
--- a/dom/script/ScriptLoadContext.cpp	Thu Feb 17 15:57:52 2022 +0000
+++ b/dom/script/ScriptLoadContext.cpp	Thu Feb 17 15:57:52 2022 +0000
@@ -4,7 +4,6 @@
  * License, v. 2.0. If a copy of the MPL was not distributed with this
  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
 
-#include "ScriptLoadRequest.h"
 #include "GeckoProfiler.h"
 
 #include "mozilla/dom/Document.h"
@@ -15,15 +14,13 @@
 
 #include "js/OffThreadScriptCompilation.h"
 #include "js/SourceText.h"
+#include "js/loader/ScriptLoadRequest.h"
 
 #include "ModuleLoadRequest.h"
 #include "nsContentUtils.h"
 #include "nsICacheInfoChannel.h"
 #include "nsIClassOfService.h"
 #include "nsISupportsPriority.h"
-#include "ScriptSettings.h"
-
-using JS::SourceText;
 
 namespace mozilla {
 namespace dom {
@@ -134,7 +131,7 @@
   mOffThreadToken = nullptr;
 }
 
-void ScriptLoadContext::SetRequest(ScriptLoadRequest* aRequest) {
+void ScriptLoadContext::SetRequest(JS::loader::ScriptLoadRequest* aRequest) {
   MOZ_ASSERT(!mRequest);
   mRequest = aRequest;
 }
@@ -172,7 +169,8 @@
 
 bool ScriptLoadContext::IsPreload() const {
   if (mRequest->IsModuleRequest() && !mRequest->IsTopLevel()) {
-    ModuleLoadRequest* root = mRequest->AsModuleRequest()->GetRootModule();
+    JS::loader::ModuleLoadRequest* root =
+        mRequest->AsModuleRequest()->GetRootModule();
     return root->GetLoadContext()->IsPreload();
   }
 
@@ -182,7 +180,8 @@
 
 nsIGlobalObject* ScriptLoadContext::GetWebExtGlobal() const {
   if (mRequest->IsModuleRequest() && !mRequest->IsTopLevel()) {
-    ModuleLoadRequest* root = mRequest->AsModuleRequest()->GetRootModule();
+    JS::loader::ModuleLoadRequest* root =
+        mRequest->AsModuleRequest()->GetRootModule();
     return root->GetLoadContext()->GetWebExtGlobal();
   }
 
@@ -196,7 +195,8 @@
 
 nsIScriptElement* ScriptLoadContext::GetScriptElement() const {
   if (mRequest->IsModuleRequest() && !mRequest->IsTopLevel()) {
-    ModuleLoadRequest* root = mRequest->AsModuleRequest()->GetRootModule();
+    JS::loader::ModuleLoadRequest* root =
+        mRequest->AsModuleRequest()->GetRootModule();
     return root->GetLoadContext()->GetScriptElement();
   }
   nsCOMPtr<nsIScriptElement> scriptElement = do_QueryInterface(mElement);