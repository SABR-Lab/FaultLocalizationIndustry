# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/script/ModuleLoader.cpp
# Commit: 9355004c7f6a
# Full Hash: 9355004c7f6a72ca7f8c11df9d70076626767ae9
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2022-02-18 09:08:22
# Regressor Bug: 1742437
# File Overlap Count: 1
# Description:
#   Bug 1742437 - move mWebExtGlobal from ScriptLoadRequest to DOMScriptLoadContext; r=jonco,smaug
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D136744
# ==============================================================================

diff -r 0a5f61274aed -r 9355004c7f6a dom/script/ModuleLoader.cpp
--- a/dom/script/ModuleLoader.cpp	Thu Feb 17 15:57:48 2022 +0000
+++ b/dom/script/ModuleLoader.cpp	Thu Feb 17 15:57:49 2022 +0000
@@ -114,9 +114,9 @@
   // Update the module map to indicate that a module is currently being fetched.
 
   MOZ_ASSERT(aRequest->IsLoading());
-  MOZ_ASSERT(
-      !ModuleMapContainsURL(aRequest->mURI, aRequest->GetWebExtGlobal()));
-  ModuleMapKey key(aRequest->mURI, aRequest->GetWebExtGlobal());
+  MOZ_ASSERT(!ModuleMapContainsURL(aRequest->mURI,
+                                   aRequest->mLoadContext->GetWebExtGlobal()));
+  ModuleMapKey key(aRequest->mURI, aRequest->mLoadContext->GetWebExtGlobal());
   mFetchingModules.InsertOrUpdate(
       key, RefPtr<GenericNonExclusivePromise::Private>{});
 }
@@ -134,7 +134,7 @@
        "%u)",
        aRequest, aRequest->mModuleScript.get(), unsigned(aResult)));
 
-  ModuleMapKey key(aRequest->mURI, aRequest->GetWebExtGlobal());
+  ModuleMapKey key(aRequest->mURI, aRequest->mLoadContext->GetWebExtGlobal());
   RefPtr<GenericNonExclusivePromise::Private> promise;
   if (!mFetchingModules.Remove(key, getter_AddRefs(promise))) {
     LOG(