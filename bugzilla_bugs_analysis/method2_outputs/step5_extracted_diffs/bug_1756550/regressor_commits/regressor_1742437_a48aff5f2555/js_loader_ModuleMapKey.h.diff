# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/loader/ModuleMapKey.h
# Commit: a48aff5f2555
# Full Hash: a48aff5f2555af61a9bc1ee0d77f6058f47d0501
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2022-02-18 09:08:22
# Regressor Bug: 1742437
# File Overlap Count: 2
# Description:
#   Bug 1742437 - Move module loader files into a central folder; r=jonco
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D137532
# ==============================================================================

diff -r 7e54a223001d -r a48aff5f2555 js/loader/ModuleMapKey.h
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/js/loader/ModuleMapKey.h	Thu Feb 17 15:57:52 2022 +0000
@@ -0,0 +1,47 @@
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+
+#ifndef ModuleMapKey_h__
+#define ModuleMapKey_h__
+
+#include "nsURIHashKey.h"
+#include "nsIGlobalObject.h"
+
+namespace mozilla::dom {
+
+class ModuleMapKey : public nsURIHashKey {
+ public:
+  using KeyType = ModuleMapKey&;
+  using KeyTypePointer = const ModuleMapKey*;
+
+  ModuleMapKey() = default;
+  ModuleMapKey(const nsIURI* aURI, nsIGlobalObject* aWebExtGlobal);
+  explicit ModuleMapKey(const ModuleMapKey* aKey);
+  ModuleMapKey(ModuleMapKey&& aToMove) noexcept;
+
+  ModuleMapKey& operator=(const ModuleMapKey& aOther) = default;
+
+  KeyType GetKey() { return *this; }
+  KeyTypePointer GetKeyPointer() const { return this; }
+  static KeyTypePointer KeyToPointer(KeyType aKey) { return &aKey; }
+
+  bool KeyEquals(KeyTypePointer aOther) const;
+  static PLDHashNumber HashKey(KeyTypePointer aKey);
+
+  nsCOMPtr<nsIGlobalObject> mWebExtGlobal;
+};
+
+inline void ImplCycleCollectionUnlink(ModuleMapKey& aField) {
+  ImplCycleCollectionUnlink(aField.mWebExtGlobal);
+}
+
+inline void ImplCycleCollectionTraverse(
+    nsCycleCollectionTraversalCallback& aCallback, ModuleMapKey& aField,
+    const char* aName, uint32_t aFlags = 0) {
+  ImplCycleCollectionTraverse(aCallback, aField.mWebExtGlobal, aName, aFlags);
+}
+
+}  // namespace mozilla::dom
+
+#endif