# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/GfxInfoBase.cpp
# Commit: 4f5567292c37
# Full Hash: 4f5567292c37eedabac14b615f41c961cfc244f3
# Author: stransky <stransky@redhat.com>
# Date: 2022-02-24 03:51:41
# Regressor Bug: 1751987
# File Overlap Count: 1
# Description:
#   Bug 1751987 [Linux] Add VA-API feature r=aosmond
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D139301
# ==============================================================================

diff -r b7ea622c1205 -r 4f5567292c37 widget/GfxInfoBase.cpp
--- a/widget/GfxInfoBase.cpp	Wed Feb 23 11:47:06 2022 +0000
+++ b/widget/GfxInfoBase.cpp	Wed Feb 23 11:47:07 2022 +0000
@@ -234,6 +234,9 @@
     case nsIGfxInfo::FEATURE_DMABUF:
       name = BLOCKLIST_PREF_BRANCH "dmabuf";
       break;
+    case nsIGfxInfo::FEATURE_VAAPI:
+      name = BLOCKLIST_PREF_BRANCH "vaapi";
+      break;
     case nsIGfxInfo::FEATURE_WEBRENDER_SHADER_CACHE:
       name = BLOCKLIST_PREF_BRANCH "webrender.program-binary-disk";
       break;
@@ -486,6 +489,9 @@
   if (aFeature.EqualsLiteral("DMABUF")) {
     return nsIGfxInfo::FEATURE_DMABUF;
   }
+  if (aFeature.EqualsLiteral("VAAPI")) {
+    return nsIGfxInfo::FEATURE_VAAPI;
+  }
   if (aFeature.EqualsLiteral("WEBRENDER_PARTIAL_PRESENT")) {
     return nsIGfxInfo::FEATURE_WEBRENDER_PARTIAL_PRESENT;
   }
@@ -1370,6 +1376,7 @@
                         nsIGfxInfo::FEATURE_ALLOW_WEBGL_OUT_OF_PROCESS,
                         nsIGfxInfo::FEATURE_X11_EGL,
                         nsIGfxInfo::FEATURE_DMABUF,
+                        nsIGfxInfo::FEATURE_VAAPI,
                         nsIGfxInfo::FEATURE_WEBRENDER_PARTIAL_PRESENT,
                         0};
 