# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/nsIPrintSettings.idl
# Commit: 8b047a24a91d
# Full Hash: 8b047a24a91df99818fd01165b6b00d05258a3d4
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2022-03-31 09:35:41
# Regressor Bug: 1760836
# File Overlap Count: 1
# Description:
#   Bug 1760836 - Support printing to an nsIOutputStream. r=jfkthame,jrmuizel,webdriver-reviewers,geckoview-reviewers,agi
#   
#   The trickiest bits are the PrintTargetCG ones, the rest is just plumbing
#   and cleanups and tests, but let me know if you want those to be split
#   out, can do.
# ==============================================================================

diff -r a04583558158 -r 8b047a24a91d widget/nsIPrintSettings.idl
--- a/widget/nsIPrintSettings.idl	Wed Mar 30 18:46:53 2022 +0000
+++ b/widget/nsIPrintSettings.idl	Wed Mar 30 18:51:58 2022 +0000
@@ -5,7 +5,6 @@
 
 #include "nsISupports.idl"
 
-
 %{ C++
 #include "nsMargin.h"
 #include "nsTArray.h"
@@ -22,6 +21,7 @@
 [ref] native nsNativeIntMarginRef(nsIntMargin);
 
 interface nsIPrintSession;
+interface nsIOutputStream;
 
 /**
  * Simplified graphics interface for JS rendering.
@@ -78,24 +78,25 @@
   const long kJustCenter = 1;
   const long kJustRight  = 2;
 
-  /**
-   * Page Size Unit Constants
-   */
+  /** Page Size Unit Constants */
   const short kPaperSizeInches      = 0;
   const short kPaperSizeMillimeters = 1;
 
-  /**
-   * Orientation Constants
-   */
+  /** Orientation Constants */
   const short kPortraitOrientation  = 0;
   const short kLandscapeOrientation = 1;
 
-  /**
-   * Output file format
-   */
+  /** Output file format */
   const short kOutputFormatNative = 0;
   const short kOutputFormatPDF    = 2;
 
+  /** Output destination */
+  cenum OutputDestinationType : 8 {
+    kOutputDestinationPrinter = 0,
+    kOutputDestinationFile = 1,
+    kOutputDestinationStream = 2,
+  };
+
   /**
    * Duplex printing options.
    *
@@ -298,17 +299,19 @@
    */
   attribute long    numPagesPerSheet;
 
-  attribute AString printerName;   /* name of destination printer */
-
-  attribute boolean printToFile;
-  attribute AString toFileName;
-  attribute short   outputFormat;
+  /** Output device information */
+  [infallible] attribute nsIPrintSettings_OutputDestinationType outputDestination;
+  [infallible] attribute short outputFormat;
 
-  attribute long    printPageDelay; /* in milliseconds */
+  attribute AString printerName;          /* for kOutputDestinationPrinter */
+  attribute AString toFileName;           /* for kOutputDestinationFile */
+  attribute nsIOutputStream outputStream; /* for kOutputDestinationPrinter */
 
-  attribute long    resolution;     /* print resolution (dpi) */
+  [infallible] attribute long printPageDelay; /* in milliseconds */
 
-  attribute long    duplex;         /* duplex mode */
+  [infallible] attribute long resolution;     /* print resolution (dpi) */
+
+  [infallible] attribute long duplex;         /* duplex mode */
 
   /* initialize helpers */
   /**
@@ -316,7 +319,7 @@
    * from a printer specified by the "printerName" attr.
    * If a different name is set into the "printerName"
    * attribute than the one it was initialized with the PS
-   * will then get intialized from that printer.
+   * will then get initialized from that printer.
    */
   attribute boolean isInitializedFromPrinter;
 
@@ -324,7 +327,7 @@
    * This attribute tracks whether the PS has been initialized
    * from prefs. If a different name is set into the "printerName"
    * attribute than the one it was initialized with the PS
-   * will then get intialized from prefs again.
+   * will then get initialized from prefs again.
    */
   attribute boolean isInitializedFromPrefs;
 