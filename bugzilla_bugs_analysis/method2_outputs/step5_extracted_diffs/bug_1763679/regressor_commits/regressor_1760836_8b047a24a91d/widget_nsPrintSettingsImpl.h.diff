# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/nsPrintSettingsImpl.h
# Commit: 8b047a24a91d
# Full Hash: 8b047a24a91df99818fd01165b6b00d05258a3d4
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2022-03-31 09:35:41
# Regressor Bug: 1760836
# File Overlap Count: 1
# Description:
#   Bug 1760836 - Support printing to an nsIOutputStream. r=jfkthame,jrmuizel,webdriver-reviewers,geckoview-reviewers,agi
#   
#   The trickiest bits are the PrintTargetCG ones, the rest is just plumbing
#   and cleanups and tests, but let me know if you want those to be split
#   out, can do.
# ==============================================================================

diff -r a04583558158 -r 8b047a24a91d widget/nsPrintSettingsImpl.h
--- a/widget/nsPrintSettingsImpl.h	Wed Mar 30 18:46:53 2022 +0000
+++ b/widget/nsPrintSettingsImpl.h	Wed Mar 30 18:51:58 2022 +0000
@@ -83,8 +83,6 @@
   virtual nsresult _Clone(nsIPrintSettings** _retval);
   virtual nsresult _Assign(nsIPrintSettings* aPS);
 
-  typedef enum { eHeader, eFooter } nsHeaderFooterEnum;
-
   // Members
   nsWeakPtr mSession;  // Should never be touched by Clone or Assign
 
@@ -95,19 +93,20 @@
 
   nsTArray<int32_t> mPageRanges;
 
-  double mScaling;
-  bool mPrintBGColors;  // print background colors
-  bool mPrintBGImages;  // print background images
+  double mScaling = 1.0;
+  bool mPrintBGColors = false;
+  bool mPrintBGImages = false;
 
-  bool mIsCancelled;
-  bool mSaveOnCancel;
-  bool mPrintSilent;
-  bool mShrinkToFit;
-  bool mShowMarginGuides;
-  bool mHonorPageRuleMargins;
-  bool mIsPrintSelectionRBEnabled;
-  bool mPrintSelectionOnly;
-  int32_t mPrintPageDelay;
+  bool mIsCancelled = false;
+  bool mSaveOnCancel = true;
+  bool mPrintSilent = false;
+  bool mShrinkToFit = true;
+  bool mShowMarginGuides = false;
+  bool mHonorPageRuleMargins = true;
+  bool mIsPrintSelectionRBEnabled = false;
+  bool mPrintSelectionOnly = false;
+
+  int32_t mPrintPageDelay = 50;  // XXX Do we really want this?
 
   nsString mTitle;
   nsString mURL;
@@ -115,23 +114,24 @@
   nsString mFooterStrs[NUM_HEAD_FOOT];
 
   nsString mPaperId;
-  double mPaperWidth;
-  double mPaperHeight;
-  int16_t mPaperSizeUnit;
+  double mPaperWidth = 8.5;
+  double mPaperHeight = 11.0;
+  int16_t mPaperSizeUnit = kPaperSizeInches;
 
-  bool mPrintReversed;
-  bool mPrintInColor;    // a false means grayscale
-  int32_t mOrientation;  // see orientation consts
-  int32_t mResolution;
-  int32_t mDuplex;
-  int32_t mNumCopies;
-  int32_t mNumPagesPerSheet;
+  bool mPrintReversed = false;
+  bool mPrintInColor = true;
+  int32_t mOrientation = kPortraitOrientation;
+  int32_t mResolution = 0;
+  int32_t mDuplex = kDuplexNone;
+  int32_t mNumCopies = 1;
+  int32_t mNumPagesPerSheet = 1;
+  int16_t mOutputFormat = kOutputFormatNative;
+  OutputDestinationType mOutputDestination = kOutputDestinationPrinter;
   nsString mPrinter;
-  bool mPrintToFile;
   nsString mToFileName;
-  int16_t mOutputFormat;
-  bool mIsInitedFromPrinter;
-  bool mIsInitedFromPrefs;
+  nsCOMPtr<nsIOutputStream> mOutputStream;
+  bool mIsInitedFromPrinter = false;
+  bool mIsInitedFromPrefs = false;
 };
 
 #endif /* nsPrintSettings_h__ */