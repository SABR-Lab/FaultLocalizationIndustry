# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/serviceworkers/NavigationPreloadManager.h
# Commit: 40c22bd043ba
# Full Hash: 40c22bd043bac8fa0c7ee3618572b6b9f3769a76
# Author: Peter Van der Beken <peterv@propagandism.org>
# Date: 2022-05-03 15:57:51
# Description:
#   Bug 1764935 - Deal properly with Promise creation failure in NavigationPreloadManager. r=asuth
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D144341
# ==============================================================================

diff -r 3f83c6e28484 -r 40c22bd043ba dom/serviceworkers/NavigationPreloadManager.h
--- a/dom/serviceworkers/NavigationPreloadManager.h	Tue May 03 08:11:27 2022 +0000
+++ b/dom/serviceworkers/NavigationPreloadManager.h	Tue May 03 08:23:25 2022 +0000
@@ -39,19 +39,20 @@
                        JS::Handle<JSObject*> aGivenProto) override;
 
   // WebIdl implementation
-  already_AddRefed<Promise> Enable();
+  already_AddRefed<Promise> Enable(ErrorResult& aError);
 
-  already_AddRefed<Promise> Disable();
+  already_AddRefed<Promise> Disable(ErrorResult& aError);
 
-  already_AddRefed<Promise> SetHeaderValue(const nsACString& aHeader);
+  already_AddRefed<Promise> SetHeaderValue(const nsACString& aHeader,
+                                           ErrorResult& aError);
 
-  already_AddRefed<Promise> GetState();
+  already_AddRefed<Promise> GetState(ErrorResult& aError);
 
  private:
   ~NavigationPreloadManager() = default;
 
   // General method for Enable()/Disable()
-  already_AddRefed<Promise> SetEnabled(bool aEnabled);
+  already_AddRefed<Promise> SetEnabled(bool aEnabled, ErrorResult& aError);
 
   nsCOMPtr<nsIGlobalObject> mGlobal;
   RefPtr<ServiceWorkerRegistration::Inner> mInner;