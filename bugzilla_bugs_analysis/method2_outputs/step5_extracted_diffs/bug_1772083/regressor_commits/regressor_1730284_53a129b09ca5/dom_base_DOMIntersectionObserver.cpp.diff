# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/base/DOMIntersectionObserver.cpp
# Commit: 53a129b09ca5
# Full Hash: 53a129b09ca592aaec955eea02ab15664a3adb9c
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2022-05-26 21:36:38
# Regressor Bug: 1730284
# File Overlap Count: 1
# Description:
#   Bug 1730284 - Use whether the embedder element intersects the viewport to decide whether to throttle in-process iframes. r=smaug
#   
#   This is more likely to be understandable by developers, matches other
#   browsers more closely (see bug comments), and seems more in-line with
#   what we do for OOP iframes.
# ==============================================================================

diff -r 79a95b01b69d -r 53a129b09ca5 dom/base/DOMIntersectionObserver.cpp
--- a/dom/base/DOMIntersectionObserver.cpp	Thu May 26 15:32:32 2022 +0000
+++ b/dom/base/DOMIntersectionObserver.cpp	Thu May 26 15:45:01 2022 +0000
@@ -579,6 +579,8 @@
         if (nsIScrollableFrame* scrollFrame =
                 presShell->GetRootScrollFrameAsScrollable()) {
           rootRect = scrollFrame->GetScrollPortRect();
+        } else if (rootFrame) {
+          rootRect = rootFrame->GetRectRelativeToSelf();
         }
       }
     }