# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: accessible/android/SessionAccessibility.cpp
# Commit: 5956f91b3975
# Full Hash: 5956f91b3975ff848ab22b5b2abbd524422ede6d
# Author: Eitan Isaacson <eitan@monotonous.org>
# Date: 2022-06-29 03:44:30
# Regressor Bug: 1771934
# File Overlap Count: 1
# Description:
#   Bug 1771934 - Return null accessible when SessionAcc is not fully attached. r=Jamie
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D149295
# ==============================================================================

diff -r 8362b5d22558 -r 5956f91b3975 accessible/android/SessionAccessibility.cpp
--- a/accessible/android/SessionAccessibility.cpp	Tue Jun 28 18:56:34 2022 +0000
+++ b/accessible/android/SessionAccessibility.cpp	Tue Jun 28 19:40:08 2022 +0000
@@ -987,6 +987,18 @@
   }
 }
 
+Accessible* SessionAccessibility::GetAccessibleByID(int32_t aID) const {
+  auto gvAccessor(mWindow.Access());
+  if (!gvAccessor || !gvAccessor->GetNsWindow() ||
+      !gvAccessor->GetNsWindow()->GetRootAccessible()) {
+    // If GeckoViewSupport is detached, closed, or does not have a root
+    // accessible, return null.
+    return nullptr;
+  }
+
+  return mIDToAccessibleMap.Get(aID);
+}
+
 void SessionAccessibility::RegisterAccessible(Accessible* aAccessible) {
   if (IPCAccessibilityActive()) {
     // Don't register accessible in content process.