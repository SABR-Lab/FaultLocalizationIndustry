# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: gfx/layers/BufferTexture.h
# Commit: c32962d08e6c
# Full Hash: c32962d08e6c36fa350f2a24f184fff65cf0524a
# Author: Lee Salzman <lsalzman@mozilla.com>
# Date: 2022-08-05 21:30:02
# Description:
#   Bug 1781064 - Get buffer size directly from BufferTextureData. r=aosmond,gfx-reviewers
#   
#   Since the BufferTextureData is getting created based on ImageDataSerialize::ComputeRGBBufferSize,
#   the stride may be padded for alignment which doesn't agree with the simple calculation duplicated
#   here. In general, it is less error-prone to just ask the BufferTextureData itself for its buffer
# ==============================================================================

diff -r ae21d9a82aad -r c32962d08e6c gfx/layers/BufferTexture.h
--- a/gfx/layers/BufferTexture.h	Fri Aug 05 17:24:05 2022 +0000
+++ b/gfx/layers/BufferTexture.h	Fri Aug 05 18:48:48 2022 +0000
@@ -76,6 +76,8 @@
 
   gfx::SurfaceFormat GetFormat() const;
 
+  virtual size_t GetBufferSize() = 0;
+
  protected:
   static BufferTextureData* Create(
       gfx::IntSize aSize, gfx::SurfaceFormat aFormat,
@@ -90,13 +92,12 @@
                                            TextureFlags aTextureFlags);
 
   virtual uint8_t* GetBuffer() = 0;
-  virtual size_t GetBufferSize() = 0;
 
   BufferTextureData(const BufferDescriptor& aDescriptor,
                     gfx::BackendType aMoz2DBackend)
       : mDescriptor(aDescriptor), mMoz2DBackend(aMoz2DBackend) {}
 
-  virtual ~BufferTextureData() = default;
+  ~BufferTextureData() override = default;
 
   BufferDescriptor mDescriptor;
   gfx::BackendType mMoz2DBackend;
