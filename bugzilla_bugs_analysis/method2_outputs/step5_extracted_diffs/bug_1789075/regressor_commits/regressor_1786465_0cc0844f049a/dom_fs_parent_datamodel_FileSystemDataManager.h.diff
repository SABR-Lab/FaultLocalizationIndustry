# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/fs/parent/datamodel/FileSystemDataManager.h
# Commit: 0cc0844f049a
# Full Hash: 0cc0844f049af2d440767f5217f58d04479d03ff
# Author: Jan Varga <jvarga@mozilla.com>
# Date: 2022-08-31 21:54:47
# Regressor Bug: 1786465
# File Overlap Count: 2
# Description:
#   Bug 1786465 - Handle pending open/close operations in GetOrCreateFileSystemDataManager; r=dom-storage-reviewers,jesup
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D155790
# ==============================================================================

diff -r fbc09d7df86e -r 0cc0844f049a dom/fs/parent/datamodel/FileSystemDataManager.h
--- a/dom/fs/parent/datamodel/FileSystemDataManager.h	Wed Aug 31 09:34:59 2022 +0000
+++ b/dom/fs/parent/datamodel/FileSystemDataManager.h	Wed Aug 31 09:34:59 2022 +0000
@@ -60,6 +60,8 @@
 
   void UnregisterActor(NotNull<FileSystemManagerParent*> aActor);
 
+  bool IsOpen() const { return mState == State::Open; }
+
   RefPtr<BoolPromise> OnOpen();
 
   RefPtr<BoolPromise> OnClose();
@@ -69,6 +71,10 @@
 
   bool IsInactive() const;
 
+  bool IsOpening() const { return mState == State::Opening; }
+
+  bool IsClosing() const { return mState == State::Closing; }
+
   RefPtr<BoolPromise> BeginOpen();
 
   RefPtr<BoolPromise> BeginClose();