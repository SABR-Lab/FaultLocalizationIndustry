# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/fs/include/fs/FileSystemRequestHandler.h
# Commit: 214c4d6bf7f9
# Full Hash: 214c4d6bf7f98a332c4ab81d325d9245ae810955
# Author: Jan Varga <jvarga@mozilla.com>
# Date: 2022-10-20 21:51:26
# Regressor Bug: 1792245
# File Overlap Count: 2
# Description:
#   Bug 1792245 - Add ErrorResult to FileSystemRequestHandler methods; r=dom-storage-reviewers,jesup
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D159572
# ==============================================================================

diff -r 330c69218a93 -r 214c4d6bf7f9 dom/fs/include/fs/FileSystemRequestHandler.h
--- a/dom/fs/include/fs/FileSystemRequestHandler.h	Thu Oct 20 07:33:41 2022 +0300
+++ b/dom/fs/include/fs/FileSystemRequestHandler.h	Thu Oct 20 04:21:30 2022 +0000
@@ -12,7 +12,11 @@
 template <class T>
 class RefPtr;
 
-namespace mozilla::dom {
+namespace mozilla {
+
+class ErrorResult;
+
+namespace dom {
 
 class FileSystemHandle;
 class FileSystemManager;
@@ -28,52 +32,58 @@
 class FileSystemRequestHandler {
  public:
   virtual void GetRootHandle(RefPtr<FileSystemManager> aManager,
-                             RefPtr<Promise> aPromise);
+                             RefPtr<Promise> aPromise, ErrorResult& aError);
 
   virtual void GetDirectoryHandle(RefPtr<FileSystemManager>& aManager,
                                   const FileSystemChildMetadata& aDirectory,
-                                  bool aCreate, RefPtr<Promise> aPromise);
+                                  bool aCreate, RefPtr<Promise> aPromise,
+                                  ErrorResult& aError);
 
   virtual void GetFileHandle(RefPtr<FileSystemManager>& aManager,
                              const FileSystemChildMetadata& aFile, bool aCreate,
-                             RefPtr<Promise> aPromise);
+                             RefPtr<Promise> aPromise, ErrorResult& aError);
 
   virtual void GetFile(RefPtr<FileSystemManager>& aManager,
                        const FileSystemEntryMetadata& aFile,
-                       RefPtr<Promise> aPromise);
+                       RefPtr<Promise> aPromise, ErrorResult& aError);
 
   virtual void GetAccessHandle(RefPtr<FileSystemManager>& aManager,
                                const FileSystemEntryMetadata& aFile,
-                               const RefPtr<Promise>& aPromise);
+                               const RefPtr<Promise>& aPromise,
+                               ErrorResult& aError);
 
   virtual void GetEntries(RefPtr<FileSystemManager>& aManager,
                           const EntryId& aDirectory, PageNumber aPage,
                           RefPtr<Promise> aPromise,
-                          RefPtr<FileSystemEntryMetadataArray>& aSink);
+                          RefPtr<FileSystemEntryMetadataArray>& aSink,
+                          ErrorResult& aError);
 
   virtual void RemoveEntry(RefPtr<FileSystemManager>& aManager,
                            const FileSystemChildMetadata& aEntry,
-                           bool aRecursive, RefPtr<Promise> aPromise);
+                           bool aRecursive, RefPtr<Promise> aPromise,
+                           ErrorResult& aError);
 
   virtual void MoveEntry(RefPtr<FileSystemManager>& aManager,
                          FileSystemHandle* aHandle,
                          const FileSystemEntryMetadata& aEntry,
                          const FileSystemChildMetadata& aNewEntry,
-                         RefPtr<Promise> aPromise);
+                         RefPtr<Promise> aPromise, ErrorResult& aError);
 
   virtual void RenameEntry(RefPtr<FileSystemManager>& aManager,
                            FileSystemHandle* aHandle,
                            const FileSystemEntryMetadata& aEntry,
-                           const Name& aName, RefPtr<Promise> aPromise);
+                           const Name& aName, RefPtr<Promise> aPromise,
+                           ErrorResult& aError);
 
   virtual void Resolve(RefPtr<FileSystemManager>& aManager,
                        const FileSystemEntryPair& aEndpoints,
-                       RefPtr<Promise> aPromise);
+                       RefPtr<Promise> aPromise, ErrorResult& aError);
 
   virtual ~FileSystemRequestHandler() = default;
 };  // class FileSystemRequestHandler
 
 }  // namespace fs
-}  // namespace mozilla::dom
+}  // namespace dom
+}  // namespace mozilla
 
 #endif  // DOM_FS_CHILD_FILESYSTEMREQUESTHANDLER_H_