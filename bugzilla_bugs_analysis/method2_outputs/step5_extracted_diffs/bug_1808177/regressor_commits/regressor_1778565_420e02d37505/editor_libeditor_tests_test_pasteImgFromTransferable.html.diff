# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: editor/libeditor/tests/test_pasteImgFromTransferable.html
# Commit: 420e02d37505
# Full Hash: 420e02d3750587b6dfaa72229a38e4ff8bb38149
# Author: Tom Schuster <evilpies@gmail.com>
# Date: 2022-10-19 04:09:55
# Regressor Bug: 1778565
# File Overlap Count: 1
# Description:
#   Bug 1778565 - Editor: Handle nsIFile transferable as blob. r=nika,masayuki
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D155753
# ==============================================================================

diff -r 3f19cab95424 -r 420e02d37505 editor/libeditor/tests/test_pasteImgFromTransferable.html
--- a/editor/libeditor/tests/test_pasteImgFromTransferable.html	Tue Oct 18 17:35:29 2022 +0000
+++ b/editor/libeditor/tests/test_pasteImgFromTransferable.html	Tue Oct 18 17:35:33 2022 +0000
@@ -60,8 +60,13 @@
     trans.init(null);
     trans.setTransferData(test.mimeType, stringStream);
 
+    let evt = new Promise(resolve =>
+      edit.addEventListener("input", resolve, {once: true}));
+
     getHTMLEditor(window).pasteTransferable(trans);
 
+    await evt;
+
     is(edit.innerHTML,
        "<img src=\"data:" + test.mimeType + ";base64," + test.base64 + "\" alt=\"\">",
        "pastedTransferable pastes image as data URL");
