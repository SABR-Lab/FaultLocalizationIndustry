# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: toolkit/content/tests/widgets/popup_shared.js
# Commit: 761952daa28c
# Full Hash: 761952daa28c591f7d2bcfaa038749947ec9d4e6
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2023-02-15 09:39:02
# Description:
#   Bug 1816074 - Prevent activating menubar without a selectable menu item. r=smaug
#   
#   We might not have an active item if all items are disabled.
#   
#   Add the null-check just to be safe too.
# ==============================================================================

diff -r a98793b8ce26 -r 761952daa28c toolkit/content/tests/widgets/popup_shared.js
--- a/toolkit/content/tests/widgets/popup_shared.js	Tue Feb 14 16:07:39 2023 +0000
+++ b/toolkit/content/tests/widgets/popup_shared.js	Tue Feb 14 16:01:50 2023 +0000
@@ -52,6 +52,9 @@
   document.addEventListener("DOMMenuBarActive", eventOccurred);
   document.addEventListener("DOMMenuBarInactive", eventOccurred);
 
+  // This is useful to explicitly finish a test that shouldn't trigger events.
+  document.addEventListener("TestDone", eventOccurred);
+
   gPopupTests = tests;
   gWindowUtils = SpecialPowers.getDOMWindowUtils(window);
 