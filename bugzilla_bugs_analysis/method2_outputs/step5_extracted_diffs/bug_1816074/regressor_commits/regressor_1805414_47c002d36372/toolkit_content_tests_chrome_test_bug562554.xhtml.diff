# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/content/tests/chrome/test_bug562554.xhtml
# Commit: 47c002d36372
# Full Hash: 47c002d3637247e71ee901f32421deaecc9d8ea3
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2023-01-05 03:40:49
# Regressor Bug: 1805414
# File Overlap Count: 2
# Description:
#   Bug 1805414 - Remove nsMenuFrame and nsMenuParent. r=smaug,Jamie,desktop-theme-reviewers,settings-reviewers,dao
#   
#   Move most the event handling stuff to the DOM. I've left nsMenuBarFrame
#   for now, but I will be removing that in the future.
#   
# ==============================================================================

diff -r 0c989b2bcd78 -r 47c002d36372 toolkit/content/tests/chrome/test_bug562554.xhtml
--- a/toolkit/content/tests/chrome/test_bug562554.xhtml	Wed Jan 04 18:28:34 2023 +0000
+++ b/toolkit/content/tests/chrome/test_bug562554.xhtml	Wed Jan 04 19:01:13 2023 +0000
@@ -11,8 +11,8 @@
 
   <toolbarbutton type="menu" id="toolbarmenu" height="200" style="-moz-box-pack: start; -moz-box-align: start">
     <menupopup id="menupopup" onpopupshowing="eventReceived('popupshowing'); return false;"/>
-    <stack>
-      <button style="width: 100px; height: 30px; margin-left: 0; margin-top: 0;" allowevents="true"
+    <stack style="pointer-events: none">
+      <button style="pointer-events: auto; width: 100px; height: 30px; margin-left: 0; margin-top: 0;" allowevents="true"
               onclick="eventReceived('clickbutton1'); return false;"/>
       <button style="width: 100px; height: 30px; margin-left: 70px; margin-top: 0;"
               onclick="eventReceived('clickbutton2'); return false;"/>
@@ -43,10 +43,6 @@
   () => synthesizeMouse($("toolbarmenu"), 10, 15, {}, window),
   () => is(eventCount.clickbutton1, 1, "Button 1 clicked"),
 
-  // Click on button2 where it intersects with button1 - should call popupshowing
-  () => synthesizeMouse($("toolbarmenu"), 85, 15, {}, window),
-  () => is(eventCount.popupshowing, 2, "Got second popupshowing event"),
-
   // Click on button2 outside of intersection - should call popupshowing
   () => synthesizeMouse($("toolbarmenu"), 150, 15, {}, window)
 ];
@@ -65,7 +61,7 @@
 function finishTest() {
   is(eventCount.clickbutton1, 1, "Correct number of clicks on button 1");
   is(eventCount.clickbutton2, 0, "Correct number of clicks on button 2");
-  is(eventCount.popupshowing, 3, "Correct number of popupshowing events received");
+  is(eventCount.popupshowing, 2, "Correct number of popupshowing events received");
 
   SimpleTest.finish();
 }