# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/workers/WorkerPrivate.h
# Commit: e7b103c79b1a
# Full Hash: e7b103c79b1aafa9e4f01f4c976e0d2ef46b7c41
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2022-12-15 09:27:59
# Regressor Bug: 1247687
# File Overlap Count: 1
# Description:
#   Bug 1247687 - Implement requestCredentials for Module Workers; r=jonco
#   
#   This weaves credentials through from the private to script creation.
#   
#   Depends on D155567
# ==============================================================================

diff -r 4dbd510fb042 -r e7b103c79b1a dom/workers/WorkerPrivate.h
--- a/dom/workers/WorkerPrivate.h	Wed Dec 14 14:55:36 2022 +0000
+++ b/dom/workers/WorkerPrivate.h	Wed Dec 14 14:55:36 2022 +0000
@@ -145,9 +145,10 @@
 
   static already_AddRefed<WorkerPrivate> Constructor(
       JSContext* aCx, const nsAString& aScriptURL, bool aIsChromeWorker,
-      WorkerKind aWorkerKind, const WorkerType aWorkerType,
-      const nsAString& aWorkerName, const nsACString& aServiceWorkerScope,
-      WorkerLoadInfo* aLoadInfo, ErrorResult& aRv, nsString aId = u""_ns);
+      WorkerKind aWorkerKind, RequestCredentials aRequestCredentials,
+      const WorkerType aWorkerType, const nsAString& aWorkerName,
+      const nsACString& aServiceWorkerScope, WorkerLoadInfo* aLoadInfo,
+      ErrorResult& aRv, nsString aId = u""_ns);
 
   static already_AddRefed<WorkerPrivate> Constructor(
       JSContext* aCx, const nsAString& aScriptURL, bool aIsChromeWorker,
@@ -644,6 +645,7 @@
   const nsString& ScriptURL() const { return mScriptURL; }
 
   const nsString& WorkerName() const { return mWorkerName; }
+  RequestCredentials WorkerCredentials() const { return mCredentialsMode; }
   enum WorkerType WorkerType() const { return mWorkerType; }
 
   WorkerKind Kind() const { return mWorkerKind; }
@@ -1056,9 +1058,10 @@
  private:
   WorkerPrivate(
       WorkerPrivate* aParent, const nsAString& aScriptURL, bool aIsChromeWorker,
-      WorkerKind aWorkerKind, enum WorkerType aWorkerType,
-      const nsAString& aWorkerName, const nsACString& aServiceWorkerScope,
-      WorkerLoadInfo& aLoadInfo, nsString&& aId, const nsID& aAgentClusterId,
+      WorkerKind aWorkerKind, RequestCredentials aRequestCredentials,
+      enum WorkerType aWorkerType, const nsAString& aWorkerName,
+      const nsACString& aServiceWorkerScope, WorkerLoadInfo& aLoadInfo,
+      nsString&& aId, const nsID& aAgentClusterId,
       const nsILoadInfo::CrossOriginOpenerPolicy aAgentClusterOpenerPolicy);
 
   ~WorkerPrivate();
@@ -1200,6 +1203,7 @@
 
   // This is the worker name for shared workers and dedicated workers.
   const nsString mWorkerName;
+  const RequestCredentials mCredentialsMode;
   enum WorkerType mWorkerType;
 
   const WorkerKind mWorkerKind;
