# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/workers/WorkerPrivate.h
# Commit: f3204b9ec0dc
# Full Hash: f3204b9ec0dc99aad004ce80499052fe5dcd5494
# Author: Yulia Startsev <ystartsev@mozilla.com>
# Date: 2023-01-19 04:46:07
# Regressor Bug: 1247687
# File Overlap Count: 1
# Description:
#   Bug 1247687 - Implement requestCredentials for Module Workers; r=jonco
#   
#   This weaves credentials through from the private to script creation.
#   
#   Depends on D155567
# ==============================================================================

diff -r 7327e6438343 -r f3204b9ec0dc dom/workers/WorkerPrivate.h
--- a/dom/workers/WorkerPrivate.h	Wed Jan 18 13:46:31 2023 +0000
+++ b/dom/workers/WorkerPrivate.h	Wed Jan 18 13:46:31 2023 +0000
@@ -146,9 +146,10 @@
 
   static already_AddRefed<WorkerPrivate> Constructor(
       JSContext* aCx, const nsAString& aScriptURL, bool aIsChromeWorker,
-      WorkerKind aWorkerKind, const WorkerType aWorkerType,
-      const nsAString& aWorkerName, const nsACString& aServiceWorkerScope,
-      WorkerLoadInfo* aLoadInfo, ErrorResult& aRv, nsString aId = u""_ns);
+      WorkerKind aWorkerKind, RequestCredentials aRequestCredentials,
+      const WorkerType aWorkerType, const nsAString& aWorkerName,
+      const nsACString& aServiceWorkerScope, WorkerLoadInfo* aLoadInfo,
+      ErrorResult& aRv, nsString aId = u""_ns);
 
   static already_AddRefed<WorkerPrivate> Constructor(
       JSContext* aCx, const nsAString& aScriptURL, bool aIsChromeWorker,
@@ -645,6 +646,7 @@
   const nsString& ScriptURL() const { return mScriptURL; }
 
   const nsString& WorkerName() const { return mWorkerName; }
+  RequestCredentials WorkerCredentials() const { return mCredentialsMode; }
   enum WorkerType WorkerType() const { return mWorkerType; }
 
   WorkerKind Kind() const { return mWorkerKind; }
@@ -1060,9 +1062,10 @@
  private:
   WorkerPrivate(
       WorkerPrivate* aParent, const nsAString& aScriptURL, bool aIsChromeWorker,
-      WorkerKind aWorkerKind, enum WorkerType aWorkerType,
-      const nsAString& aWorkerName, const nsACString& aServiceWorkerScope,
-      WorkerLoadInfo& aLoadInfo, nsString&& aId, const nsID& aAgentClusterId,
+      WorkerKind aWorkerKind, RequestCredentials aRequestCredentials,
+      enum WorkerType aWorkerType, const nsAString& aWorkerName,
+      const nsACString& aServiceWorkerScope, WorkerLoadInfo& aLoadInfo,
+      nsString&& aId, const nsID& aAgentClusterId,
       const nsILoadInfo::CrossOriginOpenerPolicy aAgentClusterOpenerPolicy);
 
   ~WorkerPrivate();
@@ -1210,6 +1213,7 @@
 
   // This is the worker name for shared workers and dedicated workers.
   const nsString mWorkerName;
+  const RequestCredentials mCredentialsMode;
   enum WorkerType mWorkerType;
 
   const WorkerKind mWorkerKind;
