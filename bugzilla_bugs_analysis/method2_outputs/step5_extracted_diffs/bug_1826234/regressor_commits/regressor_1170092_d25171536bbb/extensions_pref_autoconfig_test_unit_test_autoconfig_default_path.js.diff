# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: extensions/pref/autoconfig/test/unit/test_autoconfig_default_path.js
# Commit: d25171536bbb
# Full Hash: d25171536bbbb2e990fa16149c7bdb62171dde3c
# Author: Jan Horak <jhorak@redhat.com>
# Date: 2023-03-02 21:22:31
# Regressor Bug: 1170092
# File Overlap Count: 1
# Description:
#   Bug 1170092 Load preferences from /etc/firefox/defaults/pref on Linux; r=mkaply
#   
#   Preferences from /etc/firefox/defaults/pref overwrites preferences set in omni.jar
#   and firefox/defaults/pref. The code was used for flatpak and snap only, but it could
#   be used also for regular Linux builds.
# ==============================================================================

diff -r 907dd0b20c7f -r d25171536bbb extensions/pref/autoconfig/test/unit/test_autoconfig_default_path.js
--- a/extensions/pref/autoconfig/test/unit/test_autoconfig_default_path.js	Thu Mar 02 14:35:26 2023 +0000
+++ b/extensions/pref/autoconfig/test/unit/test_autoconfig_default_path.js	Thu Mar 02 14:41:56 2023 +0000
@@ -8,6 +8,9 @@
 function run_test() {
   updateAppInfo();
 
+  try {
+    Services.dirsvc.undefine("SysConfD");
+  } catch (e) {}
   let defaultSysConfD = Services.dirsvc.get("SysConfD", Ci.nsIFile);
   equal("/etc/xpcshell", defaultSysConfD.path, "SysConfD is in /etc");
 }