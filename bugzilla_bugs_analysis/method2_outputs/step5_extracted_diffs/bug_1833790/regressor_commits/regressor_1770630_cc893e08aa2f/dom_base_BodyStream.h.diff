# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/base/BodyStream.h
# Commit: cc893e08aa2f
# Full Hash: cc893e08aa2f8e98312e33eb5af8f684b015c29c
# Author: Andrew Sutherland <asutherland@asutherland.org>
# Date: 2022-08-03 03:42:48
# Regressor Bug: 1770630
# File Overlap Count: 1
# Description:
#   Bug 1770630 - Worker stream readers should contribute to busy count. r=dom-worker-reviewers,jstutte
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D149185
# ==============================================================================

diff -r 57951e2dc196 -r cc893e08aa2f dom/base/BodyStream.h
--- a/dom/base/BodyStream.h	Tue Aug 02 20:55:25 2022 +0000
+++ b/dom/base/BodyStream.h	Tue Aug 02 20:56:53 2022 +0000
@@ -30,7 +30,7 @@
 namespace dom {
 
 class BodyStream;
-class WeakWorkerRef;
+class StrongWorkerRef;
 class ReadableStream;
 class ReadableStreamController;
 
@@ -200,7 +200,8 @@
   nsCOMPtr<nsIInputStream> mOriginalInputStream;
   nsCOMPtr<nsIAsyncInputStream> mInputStream;
 
-  RefPtr<WeakWorkerRef> mWorkerRef;
+  RefPtr<StrongWorkerRef> mWorkerRef;
+  RefPtr<StrongWorkerRef> mAsyncWaitWorkerRef;
 };
 
 }  // namespace dom