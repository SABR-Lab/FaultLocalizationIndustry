# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/nsBaseWidget.cpp
# Commit: 18b0781ce212
# Full Hash: 18b0781ce21219d1eda1f4f6b2c2e42f96a465c2
# Author: Daniel Holbert <dholbert@cs.stanford.edu>
# Date: 2023-06-08 09:27:30
# Regressor Bug: 1837226
# File Overlap Count: 1
# Description:
#   Bug 1837226 part 3: Make nsBaseWidget::SwipeFinished destroy its SwipeTracker before clearing pointer. r=hiro
#   
#   This new call should generally be a no-op, since we already un-register before
#   we get here, i.e. before we call SwipeFinished on the widget. This new call is
#   just to be extra-sure we're unregistered.  With this change, nsBaseWidget is
# ==============================================================================

diff -r e0cb5c181518 -r 18b0781ce212 widget/nsBaseWidget.cpp
--- a/widget/nsBaseWidget.cpp	Wed Jun 07 22:02:29 2023 +0000
+++ b/widget/nsBaseWidget.cpp	Wed Jun 07 22:02:30 2023 +0000
@@ -2229,7 +2229,10 @@
       kAsyncDragDropTimeout, EventQueuePriority::Idle);
 }
 
-void nsBaseWidget::SwipeFinished() { mSwipeTracker = nullptr; }
+void nsBaseWidget::SwipeFinished() {
+  mSwipeTracker->Destroy();
+  mSwipeTracker = nullptr;
+}
 
 void nsBaseWidget::ReportSwipeStarted(uint64_t aInputBlockId,
                                       bool aStartSwipe) {
