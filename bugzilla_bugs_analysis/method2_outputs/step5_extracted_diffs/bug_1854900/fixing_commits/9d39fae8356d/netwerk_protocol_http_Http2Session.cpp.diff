# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: netwerk/protocol/http/Http2Session.cpp
# Commit: 9d39fae8356d
# Full Hash: 9d39fae8356d824621d14f7cca7f0aa9fb31c900
# Author: Kershaw Chang <kershaw@mozilla.com>
# Date: 2023-09-26 03:11:50
# Description:
#   Bug 1854900 - Add null check for mConnection, r=necko-reviewers,valentin
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D189102
# ==============================================================================

diff -r 3df1e7cfaf94 -r 9d39fae8356d netwerk/protocol/http/Http2Session.cpp
--- a/netwerk/protocol/http/Http2Session.cpp	Mon Sep 25 11:20:53 2023 +0000
+++ b/netwerk/protocol/http/Http2Session.cpp	Mon Sep 25 11:49:26 2023 +0000
@@ -368,7 +368,9 @@
          this, pingTimeout));
     if ((now - mPingSentEpoch) >= pingTimeout) {
       LOG3(("Http2Session::ReadTimeoutTick %p Ping Timer Exhaustion\n", this));
-      mConnection->SetCloseReason(ConnectionCloseReason::IDLE_TIMEOUT);
+      if (mConnection) {
+        mConnection->SetCloseReason(ConnectionCloseReason::IDLE_TIMEOUT);
+      }
       mPingSentEpoch = 0;
       if (isTrr) {
         // These must be set this way to ensure we gracefully restart all
