# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: layout/generic/nsIFrame.cpp
# Commit: 8e959a7ded5f
# Full Hash: 8e959a7ded5f111e711c06a6728f76d3bd660699
# Author: Timothy Nikkel <tnikkel@gmail.com>
# Date: 2023-12-03 09:26:44
# Description:
#   Bug 1862277. Call InvalidateRenderingObservers in nsIFrame::Init for frames that won't get a reflow. r=layout-reviewers,emilio
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D194067
# ==============================================================================

diff -r fe75ab906c79 -r 8e959a7ded5f layout/generic/nsIFrame.cpp
--- a/layout/generic/nsIFrame.cpp	Sun Dec 03 02:44:55 2023 +0200
+++ b/layout/generic/nsIFrame.cpp	Sun Dec 03 05:02:16 2023 +0000
@@ -732,6 +732,12 @@
   if (!IsPlaceholderFrame() && !aPrevInFlow) {
     UpdateVisibleDescendantsState();
   }
+
+  if (!aPrevInFlow && HasAnyStateBits(NS_FRAME_IS_NONDISPLAY)) {
+    // We aren't going to get a reflow, so nothing else will call
+    // InvalidateRenderingObservers, we have to do it here.
+    SVGObserverUtils::InvalidateRenderingObservers(this);
+  }
 }
 
 void nsIFrame::InitPrimaryFrame() {