# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: gfx/layers/AnimationHelper.cpp
# Commit: 729abedf9bda
# Full Hash: 729abedf9bda03da3f75ad660fafc2fa92a67bf5
# Author: Zach Hoffman <zach@zrhoffman.net>
# Date: 2023-12-18 17:17:57
# Regressor Bug: 1846516
# File Overlap Count: 1
# Description:
#   Bug 1846516 - [css-properties-values-api] Use AnimatedPropertyID to communicate between Gecko and Servo. r=emilio,layout-reviewers,firefox-style-system-reviewers
#   
#   Co-authored-by: Frederic Wang <fred.wang@free.fr>
#   Co-authored-by: Emilio Cobos √Ålvarez <emilio@crisal.io>
#   
# ==============================================================================

diff -r 63603267402e -r 729abedf9bda gfx/layers/AnimationHelper.cpp
--- a/gfx/layers/AnimationHelper.cpp	Mon Dec 18 09:24:08 2023 +0000
+++ b/gfx/layers/AnimationHelper.cpp	Mon Dec 18 09:24:08 2023 +0000
@@ -19,9 +19,10 @@
 #include "mozilla/dom/Nullable.h"             // for dom::Nullable
 #include "mozilla/layers/APZSampler.h"        // for APZSampler
 #include "mozilla/layers/CompositorThread.h"  // for CompositorThreadHolder
-#include "mozilla/LayerAnimationInfo.h"       // for GetCSSPropertiesFor()
-#include "mozilla/Maybe.h"                    // for Maybe<>
-#include "mozilla/MotionPathUtils.h"          // for ResolveMotionPath()
+#include "mozilla/AnimatedPropertyID.h"
+#include "mozilla/LayerAnimationInfo.h"  // for GetCSSPropertiesFor()
+#include "mozilla/Maybe.h"               // for Maybe<>
+#include "mozilla/MotionPathUtils.h"     // for ResolveMotionPath()
 #include "mozilla/ServoBindings.h"  // for Servo_ComposeAnimationSegment, etc
 #include "mozilla/StyleAnimationValue.h"  // for StyleAnimationValue, etc
 #include "nsCSSPropertyID.h"              // for eCSSProperty_offset_path, etc
@@ -626,8 +627,9 @@
 
   for (const auto& value : aValues) {
     MOZ_ASSERT(value);
-    nsCSSPropertyID id = Servo_AnimationValue_GetPropertyId(value);
-    switch (id) {
+    AnimatedPropertyID property(eCSSProperty_UNKNOWN);
+    Servo_AnimationValue_GetPropertyId(value, &property);
+    switch (property.mID) {
       case eCSSProperty_transform:
         MOZ_ASSERT(!transform);
         transform = Servo_AnimationValue_GetTransform(value);