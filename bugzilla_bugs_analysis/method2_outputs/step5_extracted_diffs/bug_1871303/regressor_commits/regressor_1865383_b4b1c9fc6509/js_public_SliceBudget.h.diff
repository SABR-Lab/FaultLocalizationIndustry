# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/public/SliceBudget.h
# Commit: b4b1c9fc6509
# Full Hash: b4b1c9fc65090f4a10a3d214d98766de25c14a68
# Author: Jon Coppeard <jcoppeard@mozilla.com>
# Date: 2023-11-21 04:58:33
# Regressor Bug: 1865383
# File Overlap Count: 2
# Description:
#   Bug 1865383 - Check slice budget when we start marking or sweeping r=sfink
#   
#   The patch forces a budget check when we start marking or sweeping unless we
#   have just started a GC slice in the current state.
#   
# ==============================================================================

diff -r 64a78f18c3fa -r b4b1c9fc6509 js/public/SliceBudget.h
--- a/js/public/SliceBudget.h	Mon Nov 20 16:27:28 2023 +0000
+++ b/js/public/SliceBudget.h	Mon Nov 20 16:28:11 2023 +0000
@@ -112,14 +112,12 @@
     counter -= steps;
   }
 
-  // Do enough steps to force an "expensive" (time) check on the next call to
-  // isOverBudget. Useful when switching between major phases of an operation
-  // like a cycle collection.
-  void stepAndForceCheck() {
+  // Force an "expensive" (time) check on the next call to isOverBudget. Useful
+  // when switching between major phases of an operation like a cycle
+  // collection.
+  void forceCheck() {
     if (isTimeBudget()) {
       counter = 0;
-    } else {
-      counter--;
     }
   }
 