# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: dom/media/TimeUnits.h
# Commit: 0d9c1ac74d9c
# Full Hash: 0d9c1ac74d9cf147aa99fad91c7e1eca0e24fa1b
# Author: Paul Adenot <paul@paul.cx>
# Date: 2024-02-02 04:43:27
# Description:
#   Bug 1874723 - Accept imprecision when trimming audio content media in certain cases. r=alwu
#   
#   In the test case, the time base is 69 (generated by a fuzzer), and so there's a
#   very large loss in precision in the computation, and eventually the assumption
#   doesn't hold. It should however hold for the common case.
# ==============================================================================

diff -r f84c76f9460d -r 0d9c1ac74d9c dom/media/TimeUnits.h
--- a/dom/media/TimeUnits.h	Thu Feb 01 17:10:37 2024 +0000
+++ b/dom/media/TimeUnits.h	Thu Feb 01 17:13:15 2024 +0000
@@ -118,6 +118,9 @@
   int64_t ToMicroseconds() const;
   int64_t ToNanoseconds() const;
   int64_t ToTicksAtRate(int64_t aRate) const;
+  // Only to be used in release assertions or unit testing, returns true if this
+  // TimeUnit has base aBase
+  bool IsBase(int64_t aBase) const;
   double ToSeconds() const;
   nsCString ToString() const;
   TimeDuration ToTimeDuration() const;