# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/TimeUnits.cpp
# Commit: 2d3d0f6297de
# Full Hash: 2d3d0f6297debb08ec41087dbfab29222fb0fc62
# Author: alwu <alwu@mozilla.com>
# Date: 2023-08-01 03:45:57
# Regressor Bug: 1845213
# File Overlap Count: 1
# Description:
#   Bug 1845213 - part2 : round up the inbase to make the result more precise. r=padenot
#   
#   Eg. {448/48,000} - {1/1,000,000} without rounding, the result would be
#   {447/48,000}, which loses around 20ms precision.
#   
# ==============================================================================

diff -r 3d24fe88db0d -r 2d3d0f6297de dom/media/TimeUnits.cpp
--- a/dom/media/TimeUnits.cpp	Mon Jul 31 19:45:50 2023 +0000
+++ b/dom/media/TimeUnits.cpp	Mon Jul 31 19:45:50 2023 +0000
@@ -62,7 +62,7 @@
                                aBase, aValue)
                    .get());
   }
-  return TimeUnit(static_cast<int64_t>(inBase), aBase);
+  return TimeUnit(static_cast<int64_t>(std::round(inBase)), aBase);
 }
 
 TimeUnit TimeUnit::FromInfinity() { return TimeUnit(INT64_MAX); }