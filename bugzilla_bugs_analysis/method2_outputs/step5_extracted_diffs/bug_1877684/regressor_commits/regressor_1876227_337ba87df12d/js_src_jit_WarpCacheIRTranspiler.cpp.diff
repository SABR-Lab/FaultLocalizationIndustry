# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/src/jit/WarpCacheIRTranspiler.cpp
# Commit: 337ba87df12d
# Full Hash: 337ba87df12db1c7f3a9da7b35d083c37ed93dfb
# Author: Andr√© Bargull <andre.bargull@gmail.com>
# Date: 2024-01-27 21:19:38
# Regressor Bug: 1876227
# File Overlap Count: 1
# Description:
#   Bug 1876227: Support non-number inputs when assigning to TypedArray elements. r=jandem
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D199513
# ==============================================================================

diff -r 52e30e216e08 -r 337ba87df12d js/src/jit/WarpCacheIRTranspiler.cpp
--- a/js/src/jit/WarpCacheIRTranspiler.cpp	Sat Jan 27 09:50:17 2024 +0000
+++ b/js/src/jit/WarpCacheIRTranspiler.cpp	Sat Jan 27 09:51:34 2024 +0000
@@ -1363,6 +1363,15 @@
   return defineOperand(resultId, ins);
 }
 
+bool WarpCacheIRTranspiler::emitDoubleToUint8Clamped(NumberOperandId inputId,
+                                                     Int32OperandId resultId) {
+  MDefinition* input = getOperand(inputId);
+  auto* ins = MClampToUint8::New(alloc(), input);
+  add(ins);
+
+  return defineOperand(resultId, ins);
+}
+
 bool WarpCacheIRTranspiler::emitGuardToInt32ModUint32(ValOperandId valId,
                                                       Int32OperandId resultId) {
   MDefinition* input = getOperand(valId);