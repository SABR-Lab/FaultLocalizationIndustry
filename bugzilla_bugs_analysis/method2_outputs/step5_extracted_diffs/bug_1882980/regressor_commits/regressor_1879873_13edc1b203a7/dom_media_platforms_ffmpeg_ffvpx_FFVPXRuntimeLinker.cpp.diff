# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/platforms/ffmpeg/ffvpx/FFVPXRuntimeLinker.cpp
# Commit: 13edc1b203a7
# Full Hash: 13edc1b203a76bf9d3bc00ba19a7f3b167a2ac45
# Author: Paul Adenot <paul@paul.cx>
# Date: 2024-02-27 04:32:10
# Regressor Bug: 1879873
# File Overlap Count: 1
# Description:
#   Bug 1879873 - Directly use tx instead of the older avfft interface. r=karlt,media-playback-reviewers
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D202156
# ==============================================================================

diff -r 71824d88e1cd -r 13edc1b203a7 dom/media/platforms/ffmpeg/ffvpx/FFVPXRuntimeLinker.cpp
--- a/dom/media/platforms/ffmpeg/ffvpx/FFVPXRuntimeLinker.cpp	Mon Feb 26 16:07:08 2024 +0000
+++ b/dom/media/platforms/ffmpeg/ffvpx/FFVPXRuntimeLinker.cpp	Mon Feb 26 16:07:09 2024 +0000
@@ -145,19 +145,13 @@
 }
 
 /* static */
-void FFVPXRuntimeLinker::GetRDFTFuncs(FFmpegRDFTFuncs* aOutFuncs) {
+void FFVPXRuntimeLinker::GetFFTFuncs(FFmpegFFTFuncs* aOutFuncs) {
   []() MOZ_NO_THREAD_SAFETY_ANALYSIS {
     MOZ_ASSERT(sLinkStatus != LinkStatus_INIT);
   }();
-  if (sFFVPXLib.av_rdft_init && sFFVPXLib.av_rdft_calc &&
-      sFFVPXLib.av_rdft_end) {
-    aOutFuncs->init = sFFVPXLib.av_rdft_init;
-    aOutFuncs->calc = sFFVPXLib.av_rdft_calc;
-    aOutFuncs->end = sFFVPXLib.av_rdft_end;
-  } else {
-    NS_WARNING("RDFT functions expected but not found");
-    *aOutFuncs = FFmpegRDFTFuncs();  // zero
-  }
+  MOZ_ASSERT(sFFVPXLib.av_tx_init && sFFVPXLib.av_tx_uninit);
+  aOutFuncs->init = sFFVPXLib.av_tx_init;
+  aOutFuncs->uninit = sFFVPXLib.av_tx_uninit;
 }
 
 }  // namespace mozilla