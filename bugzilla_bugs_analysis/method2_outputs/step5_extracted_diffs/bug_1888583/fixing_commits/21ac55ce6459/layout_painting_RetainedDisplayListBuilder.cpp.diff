# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: layout/painting/RetainedDisplayListBuilder.cpp
# Commit: 21ac55ce6459
# Full Hash: 21ac55ce6459f3b6dbc524b186fa8b181063a6ae
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2024-04-03 09:34:09
# Description:
#   Bug 1888583 - Keep papering over caret invalidation issues. r=sefeng
#   
#   We used to do this before bug 1860328 (see also bug 1547802, which
#   introduced this wallpaper).
#   
# ==============================================================================

diff -r 52bb75377d06 -r 21ac55ce6459 layout/painting/RetainedDisplayListBuilder.cpp
--- a/layout/painting/RetainedDisplayListBuilder.cpp	Tue Apr 02 08:54:52 2024 +0000
+++ b/layout/painting/RetainedDisplayListBuilder.cpp	Tue Apr 02 09:37:42 2024 +0000
@@ -1568,6 +1568,8 @@
     MarkFramesWithItemsAndImagesModified(&mList);
   }
 
+  mBuilder.InvalidateCaretFramesIfNeeded();
+
   // We set the override dirty regions during ComputeRebuildRegion or in
   // DisplayPortUtils::InvalidateForDisplayPortChange. The display port change
   // also marks the frame modified, so those regions are cleared here as well.