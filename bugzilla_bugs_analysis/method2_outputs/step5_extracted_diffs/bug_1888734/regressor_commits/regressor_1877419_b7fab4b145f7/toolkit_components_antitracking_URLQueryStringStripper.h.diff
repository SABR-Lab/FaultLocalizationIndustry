# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: toolkit/components/antitracking/URLQueryStringStripper.h
# Commit: b7fab4b145f7
# Full Hash: b7fab4b145f74d207f421836b32e86625f1759c5
# Author: abhishekmadan30 <148475204+abhishekmadan30@users.noreply.github.com>
# Date: 2024-03-26 21:18:53
# Regressor Bug: 1877419
# File Overlap Count: 1
# Description:
#   Bug 1877419 - Part 1: Added nested stripping of urls to copy without site tracking. r=pbz,necko-reviewers
#   
#   Depends on D204914
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D202943
# ==============================================================================

diff -r 78436da20d95 -r b7fab4b145f7 toolkit/components/antitracking/URLQueryStringStripper.h
--- a/toolkit/components/antitracking/URLQueryStringStripper.h	Tue Mar 26 14:42:07 2024 +0000
+++ b/toolkit/components/antitracking/URLQueryStringStripper.h	Tue Mar 26 14:42:07 2024 +0000
@@ -49,6 +49,12 @@
   void PopulateStripList(const nsAString& aList);
   void PopulateAllowList(const nsACString& aList);
 
+  // Recursive helper function that helps strip URIs of tracking parameters
+  // and enables the stripping of tracking paramerters that are in a URI which
+  // is nested in a query parameter
+  nsresult StripForCopyOrShareInternal(nsIURI* aURI, nsIURI** strippedURI,
+                                       int& aStripCount, bool aStripNestedURIs);
+
   nsTHashSet<nsString> mList;
   nsTHashSet<nsCString> mAllowList;
   nsCOMPtr<nsIURLQueryStrippingListService> mListService;
