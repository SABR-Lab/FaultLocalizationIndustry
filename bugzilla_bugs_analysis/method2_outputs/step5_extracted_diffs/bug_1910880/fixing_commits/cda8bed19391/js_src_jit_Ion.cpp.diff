# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: js/src/jit/Ion.cpp
# Commit: cda8bed19391
# Full Hash: cda8bed193914e4e6bedf875aecd9abbcc74606e
# Author: Jan de Mooij <jdemooij@mozilla.com>
# Date: 2024-08-02 15:37:12
# Description:
#   Bug 1910880 - Use a real JIT exit frame for Wasm JitEntry stub. r=rhunt
#   
#   JS JIT callers can call Wasm code either directly from Ion or through the JitEntry stub.
#   In the JitEntry case, we didn't have a real JS JIT exit frame. To make JS frame iteration
#   still work in this case, a special `JSJitToWasm` frame type was used to transition from Wasm
# ==============================================================================

diff -r 9b92adc2e91f -r cda8bed19391 js/src/jit/Ion.cpp
--- a/js/src/jit/Ion.cpp	Fri Aug 02 06:59:32 2024 +0000
+++ b/js/src/jit/Ion.cpp	Fri Aug 02 07:14:08 2024 +0000
@@ -2325,9 +2325,8 @@
 
   for (OnlyJSJitFrameIter iter(activations); !iter.done(); ++iter, ++frameno) {
     const JSJitFrameIter& frame = iter.frame();
-    MOZ_ASSERT_IF(frameno == 1, frame.isExitFrame() ||
-                                    frame.type() == FrameType::Bailout ||
-                                    frame.type() == FrameType::JSJitToWasm);
+    MOZ_ASSERT_IF(frameno == 1,
+                  frame.isExitFrame() || frame.type() == FrameType::Bailout);
 
 #ifdef JS_JITSPEW
     switch (frame.type()) {
@@ -2335,10 +2334,6 @@
         JitSpew(JitSpew_IonInvalidate, "#%zu exit frame @ %p", frameno,
                 frame.fp());
         break;
-      case FrameType::JSJitToWasm:
-        JitSpew(JitSpew_IonInvalidate, "#%zu wasm exit frame @ %p", frameno,
-                frame.fp());
-        break;
       case FrameType::BaselineJS:
       case FrameType::IonJS:
       case FrameType::Bailout: {