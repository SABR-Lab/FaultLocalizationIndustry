# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/ipc/BrowserChild.h
# Commit: 384b025f56d3
# Full Hash: 384b025f56d3f87e045ecede6b1a16b71c0b5d4f
# Author: David P <daparks@mozilla.com>
# Date: 2024-07-04 16:09:52
# Regressor Bug: 1893119
# File Overlap Count: 1
# Description:
#   Bug 1893119: Part 21 - Separate nsIDragService and nsIDragSession implementations r=gstoll,geckoview-reviewers,rkraesig,win-reviewers,m_kato
#   
#   Split the class inheritance trees for nsIDragService and nsIDragSession.
#   Remember that, before the start of this patch series, the inheritance
#   diagram was:
# ==============================================================================

diff -r beeda5ef3712 -r 384b025f56d3 dom/ipc/BrowserChild.h
--- a/dom/ipc/BrowserChild.h	Thu Jul 04 07:48:11 2024 +0000
+++ b/dom/ipc/BrowserChild.h	Thu Jul 04 07:48:11 2024 +0000
@@ -85,6 +85,13 @@
 class RequestData;
 class WebProgressData;
 
+#define DOM_BROWSERCHILD_IID                          \
+  {                                                   \
+    0x58a5775d, 0xba05, 0x45bf, {                     \
+      0xbd, 0xb8, 0xd7, 0x61, 0xf9, 0x01, 0x01, 0x31  \
+    }                                                 \
+  }
+
 class BrowserChildMessageManager : public ContentFrameMessageManager,
                                    public nsIMessageSender,
                                    public nsSupportsWeakReference {
@@ -181,6 +188,7 @@
     return mUniqueId;
   }
 
+  NS_DECLARE_STATIC_IID_ACCESSOR(DOM_BROWSERCHILD_IID)
   NS_DECL_CYCLE_COLLECTING_ISUPPORTS
   NS_DECL_NSIWEBBROWSERCHROME
   NS_DECL_NSIINTERFACEREQUESTOR
@@ -658,6 +666,7 @@
       const Maybe<bool> aCanvasFingerprinterKnownText);
 
   already_AddRefed<nsIDragSession> GetDragSession();
+  void SetDragSession(nsIDragSession* aSession);
 
   mozilla::ipc::IPCResult RecvInvokeChildDragSession(
       const MaybeDiscarded<WindowContext>& aSourceWindowContext,
@@ -777,6 +786,8 @@
   RefPtr<ContentChild> mManager;
   RefPtr<BrowsingContext> mBrowsingContext;
   RefPtr<nsBrowserStatusFilter> mStatusFilter;
+  RefPtr<nsIDragSession> mDragSession;
+
   Maybe<CodeNameIndex> mPreviousConsumedKeyDownCode;
   uint32_t mChromeFlags;
   uint32_t mMaxTouchPoints;
@@ -879,6 +890,8 @@
   DISALLOW_EVIL_CONSTRUCTORS(BrowserChild);
 };
 
+NS_DEFINE_STATIC_IID_ACCESSOR(BrowserChild, DOM_BROWSERCHILD_IID)
+
 }  // namespace dom
 }  // namespace mozilla
 