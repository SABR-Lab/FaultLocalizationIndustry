# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/src/jit-test/tests/cacheir/date-basic.js
# Commit: fb72a2390e63
# Full Hash: fb72a2390e63c25c244588c80ae15b8b8e8a5910
# Author: Andr√© Bargull <andre.bargull@gmail.com>
# Date: 2024-10-17 20:50:15
# Regressor Bug: 1925195
# File Overlap Count: 1
# Description:
#   Bug 1925195 - Part 4: Inline Date.prototype.get{Hours,Minutes,Seconds}. r=jandem
#   
#   The local time components aren't stored in separate slots, but instead in a
#   single slot which stores the number of seconds since the start of the year.
#   
# ==============================================================================

diff -r 12d75626c542 -r fb72a2390e63 js/src/jit-test/tests/cacheir/date-basic.js
--- a/js/src/jit-test/tests/cacheir/date-basic.js	Thu Oct 17 12:37:01 2024 +0000
+++ b/js/src/jit-test/tests/cacheir/date-basic.js	Thu Oct 17 12:37:02 2024 +0000
@@ -111,3 +111,72 @@
   }
 }
 testDateGetFullYearMonthDateDay();
+
+function testDateGetHours() {
+  var timeValues = [
+    0,
+    12,
+    23,
+    NaN,
+  ];
+
+  for (var i = 0; i < 250; ++i) {
+    var t = timeValues[i & 3];
+
+    // Create a new Date object with an uninitialized local time cache.
+    var d = new Date(2000, 0, 1, t);
+
+    // First call to getHours initializes the cache.
+    assertEq(d.getHours(), t);
+
+    // Second call to getHours uses the cached value.
+    assertEq(d.getHours(), t);
+  }
+}
+testDateGetHours();
+
+function testDateGetMinutes() {
+  var timeValues = [
+    0,
+    30,
+    59,
+    NaN,
+  ];
+
+  for (var i = 0; i < 250; ++i) {
+    var t = timeValues[i & 3];
+
+    // Create a new Date object with an uninitialized local time cache.
+    var d = new Date(2000, 0, 1, 0, t);
+
+    // First call to getMinutes initializes the cache.
+    assertEq(d.getMinutes(), t);
+
+    // Second call to getMinutes uses the cached value.
+    assertEq(d.getMinutes(), t);
+  }
+}
+testDateGetMinutes();
+
+function testDateGetSeconds() {
+  var timeValues = [
+    0,
+    30,
+    59,
+    NaN,
+  ];
+
+  for (var i = 0; i < 250; ++i) {
+    var t = timeValues[i & 3];
+
+    // Create a new Date object with an uninitialized local time cache.
+    var d = new Date(2000, 0, 1, 0, 0, t);
+
+    // First call to getSeconds initializes the cache.
+    assertEq(d.getSeconds(), t);
+
+    // Second call to getSeconds uses the cached value.
+    assertEq(d.getSeconds(), t);
+  }
+}
+testDateGetSeconds();