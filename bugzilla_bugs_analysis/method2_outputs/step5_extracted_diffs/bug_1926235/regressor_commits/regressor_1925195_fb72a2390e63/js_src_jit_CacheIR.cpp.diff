# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: js/src/jit/CacheIR.cpp
# Commit: fb72a2390e63
# Full Hash: fb72a2390e63c25c244588c80ae15b8b8e8a5910
# Author: Andr√© Bargull <andre.bargull@gmail.com>
# Date: 2024-10-17 20:50:15
# Regressor Bug: 1925195
# File Overlap Count: 1
# Description:
#   Bug 1925195 - Part 4: Inline Date.prototype.get{Hours,Minutes,Seconds}. r=jandem
#   
#   The local time components aren't stored in separate slots, but instead in a
#   single slot which stores the number of seconds since the start of the year.
#   
# ==============================================================================

diff -r 12d75626c542 -r fb72a2390e63 js/src/jit/CacheIR.cpp
--- a/js/src/jit/CacheIR.cpp	Thu Oct 17 12:37:01 2024 +0000
+++ b/js/src/jit/CacheIR.cpp	Thu Oct 17 12:37:02 2024 +0000
@@ -10503,6 +10503,24 @@
     case DateComponent::Day:
       writer.loadFixedSlotResult(objId, DateObject::offsetOfLocalDaySlot());
       break;
+    case DateComponent::Hours: {
+      ValOperandId secondsIntoYearValId = writer.loadFixedSlot(
+          objId, DateObject::offsetOfLocalSecondsIntoYearSlot());
+      writer.dateHoursFromSecondsIntoYearResult(secondsIntoYearValId);
+      break;
+    }
+    case DateComponent::Minutes: {
+      ValOperandId secondsIntoYearValId = writer.loadFixedSlot(
+          objId, DateObject::offsetOfLocalSecondsIntoYearSlot());
+      writer.dateMinutesFromSecondsIntoYearResult(secondsIntoYearValId);
+      break;
+    }
+    case DateComponent::Seconds: {
+      ValOperandId secondsIntoYearValId = writer.loadFixedSlot(
+          objId, DateObject::offsetOfLocalSecondsIntoYearSlot());
+      writer.dateSecondsFromSecondsIntoYearResult(secondsIntoYearValId);
+      break;
+    }
   }
 
   writer.returnFromIC();
@@ -10520,6 +10538,15 @@
     case DateComponent::Day:
       trackAttached("DateGetDay");
       break;
+    case DateComponent::Hours:
+      trackAttached("DateGetHours");
+      break;
+    case DateComponent::Minutes:
+      trackAttached("DateGetMinutes");
+      break;
+    case DateComponent::Seconds:
+      trackAttached("DateGetSeconds");
+      break;
   }
   return AttachDecision::Attach;
 }
@@ -12239,6 +12266,12 @@
       return tryAttachDateGet(DateComponent::Date);
     case InlinableNative::DateGetDay:
       return tryAttachDateGet(DateComponent::Day);
+    case InlinableNative::DateGetHours:
+      return tryAttachDateGet(DateComponent::Hours);
+    case InlinableNative::DateGetMinutes:
+      return tryAttachDateGet(DateComponent::Minutes);
+    case InlinableNative::DateGetSeconds:
+      return tryAttachDateGet(DateComponent::Seconds);
 
     // Testing functions.
     case InlinableNative::TestBailout: