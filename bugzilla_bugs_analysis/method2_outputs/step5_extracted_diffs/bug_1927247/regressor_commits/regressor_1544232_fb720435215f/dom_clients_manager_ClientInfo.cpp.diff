# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/clients/manager/ClientInfo.cpp
# Commit: fb720435215f
# Full Hash: fb720435215fa5be3b2bd2101f3a54382954b70c
# Author: Andrew Sutherland <asutherland@asutherland.org>
# Date: 2024-10-24 09:44:34
# Regressor Bug: 1544232
# File Overlap Count: 4
# Description:
#   Bug 1544232 - Limit lifetime extension of SWs by SWs to the sender's lifetime. r=edenchuang
#   
#   This patch introduces an explicit concept of lifetimes with mechanisms
#   in place so that actions taken by Clients (windows or non-ServiceWorker
#   orkers) will extend the lifetime of a ServiceWorker, but a ServiceWorker
# ==============================================================================

diff -r 25452f6623a0 -r fb720435215f dom/clients/manager/ClientInfo.cpp
--- a/dom/clients/manager/ClientInfo.cpp	Thu Oct 24 03:02:41 2024 +0000
+++ b/dom/clients/manager/ClientInfo.cpp	Thu Oct 24 03:02:42 2024 +0000
@@ -14,14 +14,14 @@
 using mozilla::ipc::PrincipalInfo;
 using mozilla::ipc::PrincipalInfoToPrincipal;
 
-ClientInfo::ClientInfo(const nsID& aId, ClientType aType,
+ClientInfo::ClientInfo(const nsID& aId, const Maybe<nsID>& aAgentClusterId,
+                       ClientType aType,
                        const mozilla::ipc::PrincipalInfo& aPrincipalInfo,
-                       const TimeStamp& aCreationTime)
-    : mData(MakeUnique<IPCClientInfo>(aId, mozilla::Nothing(), aType,
-                                      aPrincipalInfo, aCreationTime, ""_ns,
-                                      mozilla::dom::FrameType::None,
-                                      mozilla::Nothing(), mozilla::Nothing())) {
-}
+                       const TimeStamp& aCreationTime, const nsCString& aURL,
+                       mozilla::dom::FrameType aFrameType)
+    : mData(MakeUnique<IPCClientInfo>(
+          aId, aAgentClusterId, aType, aPrincipalInfo, aCreationTime, aURL,
+          aFrameType, mozilla::Nothing(), mozilla::Nothing())) {}
 
 ClientInfo::ClientInfo(const IPCClientInfo& aData)
     : mData(MakeUnique<IPCClientInfo>(aData)) {}