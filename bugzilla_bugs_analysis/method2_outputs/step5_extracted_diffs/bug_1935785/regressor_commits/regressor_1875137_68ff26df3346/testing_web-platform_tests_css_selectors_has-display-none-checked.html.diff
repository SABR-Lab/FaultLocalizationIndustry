# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: testing/web-platform/tests/css/selectors/has-display-none-checked.html
# Commit: 68ff26df3346
# Full Hash: 68ff26df33468fe750b39f175b43b8507718ece4
# Author: Emilio Cobos Álvarez <emilio@crisal.io>
# Date: 2024-01-18 21:34:14
# Regressor Bug: 1875137
# File Overlap Count: 1
# Description:
#   Bug 1875137 - Don't ignore state changes in display: none subtrees if needed for :has(). r=dshin
#   
#   Just like we do for attribute invalidation.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D198929
# ==============================================================================

diff -r f61c77fafa8a -r 68ff26df3346 testing/web-platform/tests/css/selectors/has-display-none-checked.html
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/testing/web-platform/tests/css/selectors/has-display-none-checked.html	Thu Jan 18 13:18:51 2024 +0000
@@ -0,0 +1,28 @@
+<!doctype html>
+<html class="reftest-wait">
+<meta charset="utf-8">
+<title>:has() invalidation inside display: none subtree</title>
+<link rel="author" href="mailto:emilio@crisal.io" title="Emilio Cobos Álvarez">
+<link rel="author" href="https://mozilla.org" title="Mozilla">
+<link rel="help" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1875137">
+<link rel="help" href="https://drafts.csswg.org/selectors/#relational">
+<link rel="match" href="has-display-none-checked-ref.html">
+<style>
+body:has(input:checked) #fail {
+  display: none;
+}
+body:not(:has(input:checked)) #pass {
+  display: none;
+}
+</style>
+<div style="display: none">
+  <input type="checkbox" id="on">
+</div>
+<div id="fail">FAIL</div>
+<div id="pass">PASS</div>
+<script>
+  document.addEventListener("TestRendered", function() {
+    document.querySelector("input").checked = true;
+    document.documentElement.className = "";
+  });
+</script>
