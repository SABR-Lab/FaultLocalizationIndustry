# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: mfbt/Atomics.h
# Commit: 2fbec9faf49c
# Full Hash: 2fbec9faf49c7b3389b485a7b836173ba2dbf5cc
# Author: stransky <stransky@redhat.com>
# Date: 2024-12-10 16:36:00
# Regressor Bug: 1934497
# File Overlap Count: 2
# Description:
#   Bug 1934497 [Wayland] Implement wl_surface abstraction as WaylandSurface r=emilio
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D230847
# ==============================================================================

diff -r f6ea1323c158 -r 2fbec9faf49c mfbt/Atomics.h
--- a/mfbt/Atomics.h	Tue Dec 10 07:12:50 2024 +0000
+++ b/mfbt/Atomics.h	Tue Dec 10 07:12:51 2024 +0000
@@ -512,6 +512,27 @@
   Atomic(Atomic& aOther) = delete;
 };
 
+/**
+ * Atomic<T> implementation for double type.
+ */
+template <MemoryOrdering Order>
+class Atomic<double, Order> : protected detail::AtomicBase<double, Order> {
+  typedef typename detail::AtomicBase<double, Order> Base;
+
+ public:
+  constexpr Atomic() : Base() {}
+  explicit constexpr Atomic(double aInit) : Base(aInit) {}
+
+  operator double() const {
+    return double(Base::Intrinsics::load(Base::mValue));
+  }
+
+  double operator=(double aVal) { return Base::operator=(aVal); }
+
+ private:
+  Atomic(Atomic& aOther) = delete;
+};
+
 // Relax the CPU during a spinlock.  It's a good idea to place this in a
 // spinlock so that the CPU doesn't pipeline the loop otherwise flushing the
 // pipeline when the loop finally breaks can be expensive.