# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/gtk/WaylandSurface.cpp
# Commit: 8af28b4f8ccb
# Full Hash: 8af28b4f8ccbdf4c317d3f382d430d2df7868949
# Author: stransky <stransky@redhat.com>
# Date: 2024-12-17 17:00:49
# Regressor Bug: 1934497
# File Overlap Count: 2
# Description:
#   Bug 1934497 [Wayland] Fix non unified build bustage r=emilio CLOSED TREE
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D232322
# ==============================================================================

diff -r 58a807c8fde7 -r 8af28b4f8ccb widget/gtk/WaylandSurface.cpp
--- a/widget/gtk/WaylandSurface.cpp	Tue Dec 17 08:03:59 2024 +0000
+++ b/widget/gtk/WaylandSurface.cpp	Tue Dec 17 08:53:58 2024 +0000
@@ -8,6 +8,10 @@
 #include "WaylandSurface.h"
 #include "WaylandBuffer.h"
 #include <wayland-egl.h>
+#include "nsGtkUtils.h"
+#include "mozilla/StaticPrefs_widget.h"
+#include <dlfcn.h>
+#include <fcntl.h>
 
 /*
   TODO:
@@ -19,15 +23,13 @@
 */
 
 #undef LOG
-#undef LOGVERBOSE
-
 #ifdef MOZ_LOGGING
-#  undef LOGWAYLAND
-
 #  include "mozilla/Logging.h"
 #  include "nsTArray.h"
 #  include "Units.h"
 #  include "nsWindow.h"
+#  undef LOGWAYLAND
+#  undef LOGVERBOSE
 extern mozilla::LazyLogModule gWidgetWaylandLog;
 extern mozilla::LazyLogModule gWidgetLog;
 #  define LOGWAYLAND(str, ...)                           \
@@ -42,6 +44,7 @@
     MOZ_LOG(gWidgetWaylandLog, mozilla::LogLevel::Verbose, (__VA_ARGS__))
 #else
 #  define LOGWAYLAND(...)
+#  undef LOGVERBOSE
 #  define LOGVERBOSE(...)
 #  define LOGS(...)
 #  define LOGS_VERBOSE(...)