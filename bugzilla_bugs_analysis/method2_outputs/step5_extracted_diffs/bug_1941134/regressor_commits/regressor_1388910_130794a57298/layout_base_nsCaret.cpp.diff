# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: layout/base/nsCaret.cpp
# Commit: 130794a57298
# Full Hash: 130794a57298f50adb259e805866e563ec72cf63
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2024-11-20 04:44:54
# Regressor Bug: 1388910
# File Overlap Count: 3
# Description:
#   Bug 1388910 - Remove -moz-user-modify property. r=dshin
#   
#   We successfully unshipped it in bug 1920118.
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D229530
# ==============================================================================

diff -r 059d2181d771 -r 130794a57298 layout/base/nsCaret.cpp
--- a/layout/base/nsCaret.cpp	Tue Nov 19 19:31:58 2024 +0000
+++ b/layout/base/nsCaret.cpp	Tue Nov 19 19:35:35 2024 +0000
@@ -143,7 +143,6 @@
 void nsCaret::SetVisible(bool aVisible) {
   const bool wasVisible = mVisible;
   mVisible = aVisible;
-  mIgnoreUserModify = aVisible;
   if (mVisible != wasVisible) {
     CaretVisibilityMaybeChanged();
   }
@@ -500,9 +499,7 @@
   // Where the selection is targeting the <br>. We want to display the caret,
   // since the <br> we're focused at is editable, but we do want to paint it at
   // the adjusted frame offset, so that we can see the collapsed whitespace.
-  const nsStyleUI* ui = unadjustedFrame->StyleUI();
-  if ((!mIgnoreUserModify && ui->UserModify() == StyleUserModify::ReadOnly) ||
-      unadjustedFrame->IsContentDisabled()) {
+  if (unadjustedFrame->IsContentDisabled()) {
     return nullptr;
   }
 
@@ -728,8 +725,3 @@
     }
   }
 }
-
-void nsCaret::SetIgnoreUserModify(bool aIgnoreUserModify) {
-  mIgnoreUserModify = aIgnoreUserModify;
-  SchedulePaint();
-}