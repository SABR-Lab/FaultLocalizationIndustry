# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/events/Event.cpp
# Commit: aefcf10217ab
# Full Hash: aefcf10217ab75ebb5ae82cf4fef71a16db897fa
# Author: Masayuki Nakano <masayuki@d-toybox.com>
# Date: 2024-12-03 16:21:08
# Regressor Bug: 1680669
# File Overlap Count: 1
# Description:
#   Bug 1680669 - part 3: Add a utility method to `WidgetEvent` to check whether the corresponding DOM event supports coordinates r=smaug
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D222725
# ==============================================================================

diff -r edde7fe51b4b -r aefcf10217ab dom/events/Event.cpp
--- a/dom/events/Event.cpp	Tue Dec 03 07:09:44 2024 +0000
+++ b/dom/events/Event.cpp	Tue Dec 03 07:09:49 2024 +0000
@@ -589,13 +589,7 @@
     return Some(EventStateManager::sLastScreenPoint);
   }
 
-  if (!aEvent || (aEvent->mClass != eMouseEventClass &&
-                  aEvent->mClass != eMouseScrollEventClass &&
-                  aEvent->mClass != eWheelEventClass &&
-                  aEvent->mClass != ePointerEventClass &&
-                  aEvent->mClass != eTouchEventClass &&
-                  aEvent->mClass != eDragEventClass &&
-                  aEvent->mClass != eSimpleGestureEventClass)) {
+  if (!aEvent || !aEvent->DOMEventSupportsCoords()) {
     return Nothing();
   }
 
@@ -655,15 +649,8 @@
     return EventStateManager::sLastClientPoint;
   }
 
-  if (!aEvent ||
-      (aEvent->mClass != eMouseEventClass &&
-       aEvent->mClass != eMouseScrollEventClass &&
-       aEvent->mClass != eWheelEventClass &&
-       aEvent->mClass != eTouchEventClass &&
-       aEvent->mClass != eDragEventClass &&
-       aEvent->mClass != ePointerEventClass &&
-       aEvent->mClass != eSimpleGestureEventClass) ||
-      !aPresContext || !aEvent->AsGUIEvent()->mWidget) {
+  if (!aPresContext || !aEvent || !aEvent->DOMEventSupportsCoords() ||
+      !aEvent->AsGUIEvent()->mWidget) {
     return aDefaultPoint;
   }
 