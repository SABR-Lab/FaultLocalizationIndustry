# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: layout/painting/nsDisplayList.cpp
# Commit: d1cbe9636c3a
# Full Hash: d1cbe9636c3a2c8034db1e6e5abd0bd9def37a57
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2025-03-28 21:29:38
# Description:
#   Bug 1956453 - Simplify how we suppress the canvas background color. r=mstange
#   
#   Instead of conditionally inserting the item at the bottom of the
#   BorderBackground() list, just suppress its color.
#   
# ==============================================================================

diff -r c3ca3f7bd01a -r d1cbe9636c3a layout/painting/nsDisplayList.cpp
--- a/layout/painting/nsDisplayList.cpp	Thu Mar 27 18:27:40 2025 +0000
+++ b/layout/painting/nsDisplayList.cpp	Thu Mar 27 18:30:00 2025 +0000
@@ -2770,6 +2770,9 @@
 
 void nsDisplaySolidColor::Paint(nsDisplayListBuilder* aBuilder,
                                 gfxContext* aCtx) {
+  if (!NS_GET_A(mColor)) {
+    return;
+  }
   int32_t appUnitsPerDevPixel = mFrame->PresContext()->AppUnitsPerDevPixel();
   DrawTarget* drawTarget = aCtx->GetDrawTarget();
   Rect rect = NSRectToSnappedRect(GetPaintRect(aBuilder, aCtx),
@@ -2787,6 +2790,9 @@
     wr::DisplayListBuilder& aBuilder, wr::IpcResourceUpdateQueue& aResources,
     const StackingContextHelper& aSc, RenderRootStateManager* aManager,
     nsDisplayListBuilder* aDisplayListBuilder) {
+  if (!NS_GET_A(mColor)) {
+    return true;
+  }
   LayoutDeviceRect bounds = LayoutDeviceRect::FromAppUnits(
       mBounds, mFrame->PresContext()->AppUnitsPerDevPixel());
   wr::LayoutRect r = wr::ToLayoutRect(bounds);