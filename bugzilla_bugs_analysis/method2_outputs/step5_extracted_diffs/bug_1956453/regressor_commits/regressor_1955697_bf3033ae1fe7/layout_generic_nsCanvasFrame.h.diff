# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: layout/generic/nsCanvasFrame.h
# Commit: bf3033ae1fe7
# Full Hash: bf3033ae1fe73d4384d9f3957f3efbfe4d36223a
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2025-03-25 21:02:33
# Regressor Bug: 1955697
# File Overlap Count: 3
# Description:
#   Bug 1955697 - Remove nsDisplayCanvasBackgroundColor. r=mstange
#   
#   We no longer need it, as now it behaves just like a solid color.
#   
#   This causes an expectation change in an internal windowUtils.elementFromPoint
# ==============================================================================

diff -r 01cecf5bf7e5 -r bf3033ae1fe7 layout/generic/nsCanvasFrame.h
--- a/layout/generic/nsCanvasFrame.h	Tue Mar 25 08:09:57 2025 +0000
+++ b/layout/generic/nsCanvasFrame.h	Tue Mar 25 08:09:58 2025 +0000
@@ -116,39 +116,6 @@
 };
 
 namespace mozilla {
-/**
- * Override nsDisplayBackground methods so that we pass aBGClipRect to
- * PaintBackground, covering the whole overflow area.
- * We can also paint an "extra background color" behind the normal
- * background.
- */
-class nsDisplayCanvasBackgroundColor final : public nsDisplaySolidColorBase {
- public:
-  nsDisplayCanvasBackgroundColor(nsDisplayListBuilder* aBuilder,
-                                 nsIFrame* aFrame);
-
-  nsRect GetBounds(nsDisplayListBuilder* aBuilder, bool* aSnap) const override {
-    auto* frame = static_cast<nsCanvasFrame*>(mFrame);
-    *aSnap = true;
-    return frame->CanvasArea() + ToReferenceFrame();
-  }
-  void HitTest(nsDisplayListBuilder* aBuilder, const nsRect& aRect,
-               HitTestState* aState, nsTArray<nsIFrame*>* aOutFrames) override {
-    // We need to override so we don't consider border-radius.
-    aOutFrames->AppendElement(mFrame);
-  }
-  bool CreateWebRenderCommands(
-      mozilla::wr::DisplayListBuilder& aBuilder,
-      mozilla::wr::IpcResourceUpdateQueue& aResources,
-      const StackingContextHelper& aSc,
-      mozilla::layers::RenderRootStateManager* aManager,
-      nsDisplayListBuilder* aDisplayListBuilder) override;
-  void Paint(nsDisplayListBuilder* aBuilder, gfxContext* aCtx) override;
-
-  NS_DISPLAY_DECL_NAME("CanvasBackgroundColor", TYPE_CANVAS_BACKGROUND_COLOR)
-
-  void WriteDebugInfo(std::stringstream& aStream) override;
-};
 
 class nsDisplayCanvasBackgroundImage final : public nsDisplayBackgroundImage {
  public: