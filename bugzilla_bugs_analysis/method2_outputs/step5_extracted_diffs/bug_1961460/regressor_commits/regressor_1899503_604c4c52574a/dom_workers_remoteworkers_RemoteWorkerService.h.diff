# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/workers/remoteworkers/RemoteWorkerService.h
# Commit: 604c4c52574a
# Full Hash: 604c4c52574ae48f4f168eb999bc0af15dd5e0d6
# Author: Eden Chuang <echuang@mozilla.com>
# Date: 2025-04-15 21:21:06
# Regressor Bug: 1899503
# File Overlap Count: 2
# Description:
#   Bug 1899503 - P2 PRemoteWorkerDebuggerMangaer binding implementation. r=asuth
#   
#   This patch implements the PRemoteWorkerDebuggerManager binding.
#   
#   PRemoteWorkerDebuggerManager is the IPC that handles the registration/unregistration of remote debuggers.
# ==============================================================================

diff -r 77eda17d0795 -r 604c4c52574a dom/workers/remoteworkers/RemoteWorkerService.h
--- a/dom/workers/remoteworkers/RemoteWorkerService.h	Tue Apr 15 09:47:38 2025 +0000
+++ b/dom/workers/remoteworkers/RemoteWorkerService.h	Tue Apr 15 09:47:39 2025 +0000
@@ -18,9 +18,12 @@
 
 namespace mozilla::dom {
 
+class RemoteWorkerDebuggerManagerChild;
 class RemoteWorkerService;
 class RemoteWorkerServiceChild;
 class RemoteWorkerServiceShutdownBlocker;
+class PRemoteWorkerDebuggerManagerChild;
+class PRemoteWorkerDebuggerParent;
 class PRemoteWorkerServiceChild;
 
 /**
@@ -71,9 +74,14 @@
   // To be called when a process is initialized on main-thread.
   static void InitializeParent();
   static void InitializeChild(
-      mozilla::ipc::Endpoint<PRemoteWorkerServiceChild> aEndpoint);
+      mozilla::ipc::Endpoint<PRemoteWorkerServiceChild> aEndpoint,
+      mozilla::ipc::Endpoint<PRemoteWorkerDebuggerManagerChild>
+          aDebuggerChildEp);
 
   static nsIThread* Thread();
+  static void RegisterRemoteDebugger(
+      RemoteWorkerDebuggerInfo aDebuggerInfo,
+      mozilla::ipc::Endpoint<PRemoteWorkerDebuggerParent> aDebuggerParentEp);
 
   // Called by RemoteWorkerChild instances on the "Worker Launcher" thread at
   // their creation to assist in tracking when it's safe to shutdown the
@@ -96,7 +104,9 @@
   ~RemoteWorkerService();
 
   nsresult InitializeOnMainThread(
-      mozilla::ipc::Endpoint<PRemoteWorkerServiceChild> aEndpoint);
+      mozilla::ipc::Endpoint<PRemoteWorkerServiceChild> aEndpoint,
+      mozilla::ipc::Endpoint<PRemoteWorkerDebuggerManagerChild>
+          aDebuggerChildEp);
 
   void InitializeOnTargetThread(
       mozilla::ipc::Endpoint<PRemoteWorkerServiceChild> aEndpoint);
@@ -113,6 +123,7 @@
 
   nsCOMPtr<nsIThread> mThread;
   RefPtr<RemoteWorkerServiceChild> mActor;
+  RefPtr<RemoteWorkerDebuggerManagerChild> mDebuggerManagerActor;
   // The keep-alive is set and cleared on the main thread but we will hand out
   // additional references to it from the "Worker Launcher" thread, so it's
   // appropriate to use a mutex.  (Alternately we could have used a ThreadBound
