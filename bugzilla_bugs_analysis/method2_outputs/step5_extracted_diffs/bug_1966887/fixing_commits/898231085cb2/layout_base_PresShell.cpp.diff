# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: layout/base/PresShell.cpp
# Commit: 898231085cb2
# Full Hash: 898231085cb23dab2a6bf540853a35f375ee7c08
# Author: Masayuki Nakano <masayuki@d-toybox.com>
# Date: 2025-05-18 09:14:32
# Description:
#   Bug 1966887 - Remove the assertion in `EnsurePrecedingPointerRawUpdate()` which checks recursive calls r=smaug
#   
#   The assertion was intended to detect unexpected recursive event dispatching of
#   `ePointerRawUpdate`.  However, if may occur if spinning the event loop with
#   opening a modal dialog or synchronous XHR.  Therefore, the assertion may fail
# ==============================================================================

diff -r fed8d1373082 -r 898231085cb2 layout/base/PresShell.cpp
--- a/layout/base/PresShell.cpp	Sat May 17 07:42:45 2025 +0000
+++ b/layout/base/PresShell.cpp	Sat May 17 07:49:14 2025 +0000
@@ -7407,15 +7407,6 @@
     }
   }
 
-#ifdef MOZ_DIAGNOSTIC_ASSERT_ENABLED
-  static bool sDispatchingRawUpdateEventFromHere = false;
-  MOZ_DIAGNOSTIC_ASSERT(
-      !sDispatchingRawUpdateEventFromHere,
-      "Dispatching ePointerRawUpdate should not be done recursively");
-  AutoRestore<bool> restoreDispathingFlag(sDispatchingRawUpdateEventFromHere);
-  sDispatchingRawUpdateEventFromHere = true;
-#endif  // #ifdef MOZ_DIAGNOSTIC_ASSERT_ENABLED
-
   if (const WidgetMouseEvent* const mouseEvent = aSourceEvent.AsMouseEvent()) {
     // If `convertToPointer` is `false`, it means that we've already handled the
     // event to dispatch a preceding pointer event.  Therefore, its preceding
