# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/TouchEvents.h
# Commit: f8a2a169b296
# Full Hash: f8a2a169b2969d29e04733ae27a56459e5359973
# Author: Alexandru Marc <amarc@mozila.com>
# Date: 2025-05-16 09:19:19
# Regressor Bug: 1550462
# File Overlap Count: 1
# Description:
#   Revert "Bug 1550462 - part 3: Enable `pointerrawupdate` event r=smaug" for causing mochitest failures @ test_pointerrawupdate_event_count.html
#   
#   This reverts commit eb27445e0352d6b4df540adb40e21f72fc052e80.
#   
#   Revert "Bug 1550462 - part 2: Make `PresShell::HandleEvent` dispatch preceding `pointerrawupdate` event r=smaug,dom-core,edgar"
# ==============================================================================

diff -r 8d25773fc82f -r f8a2a169b296 widget/TouchEvents.h
--- a/widget/TouchEvents.h	Fri May 16 06:20:47 2025 +0000
+++ b/widget/TouchEvents.h	Fri May 16 09:30:09 2025 +0300
@@ -151,23 +151,13 @@
 
   MOZ_COUNTED_DEFAULT_CTOR(WidgetTouchEvent)
 
-  enum class CloneTouches : bool { No, Yes };
-  WidgetTouchEvent(const WidgetTouchEvent& aOther,
-                   CloneTouches aCloneTouches = CloneTouches::No)
+  WidgetTouchEvent(const WidgetTouchEvent& aOther)
       : WidgetInputEvent(aOther.IsTrusted(), aOther.mMessage, aOther.mWidget,
                          eTouchEventClass) {
     MOZ_COUNT_CTOR(WidgetTouchEvent);
     mModifiers = aOther.mModifiers;
     mTimeStamp = aOther.mTimeStamp;
-    if (static_cast<bool>(aCloneTouches)) {
-      mTouches.SetCapacity(aOther.mTouches.Length());
-      for (const RefPtr<dom::Touch>& touch : aOther.mTouches) {
-        RefPtr<dom::Touch> clonedTouch = new dom::Touch(*touch);
-        mTouches.AppendElement(std::move(clonedTouch));
-      }
-    } else {
-      mTouches.AppendElements(aOther.mTouches);
-    }
+    mTouches.AppendElements(aOther.mTouches);
     mInputSource = aOther.mInputSource;
     mButton = aOther.mButton;
     mButtons = aOther.mButtons;
@@ -223,20 +213,6 @@
     mTouches.AppendElements(aEvent.mTouches);
     mInputSource = aEvent.mInputSource;
   }
-
-  void SetConvertToPointerRawUpdate(bool aConvert) {
-    for (dom::Touch* const touch : mTouches) {
-      touch->convertToPointerRawUpdate = aConvert;
-    }
-  }
-  [[nodiscard]] bool CanConvertToPointerRawUpdate() const {
-    for (const dom::Touch* const touch : mTouches) {
-      if (touch->convertToPointerRawUpdate) {
-        return true;
-      }
-    }
-    return false;
-  }
 };
 
 }  // namespace mozilla