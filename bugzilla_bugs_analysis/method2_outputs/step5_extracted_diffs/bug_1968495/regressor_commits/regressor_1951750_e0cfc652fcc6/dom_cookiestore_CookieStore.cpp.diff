# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/cookiestore/CookieStore.cpp
# Commit: e0cfc652fcc6
# Full Hash: e0cfc652fcc63f25f39127b7cf60b5a25ab71245
# Author: Valentin Gosu <valentin.gosu@gmail.com>
# Date: 2025-03-28 21:29:38
# Regressor Bug: 1951750
# File Overlap Count: 1
# Description:
#   Bug 1951750 - Don't allow space in cookieStore names or values r=baku
#   
#   Depends on D240695
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D241967
# ==============================================================================

diff -r 123069093c2f -r e0cfc652fcc6 dom/cookiestore/CookieStore.cpp
--- a/dom/cookiestore/CookieStore.cpp	Thu Mar 27 19:06:33 2025 +0000
+++ b/dom/cookiestore/CookieStore.cpp	Thu Mar 27 19:06:33 2025 +0000
@@ -48,6 +48,9 @@
     if (*iter == 0x3B || *iter == 0x7F || (*iter <= 0x1F && *iter != 0x09)) {
       return false;
     }
+    if (*iter == 0x20) {
+      return false;
+    }
   }
   return true;
 }
