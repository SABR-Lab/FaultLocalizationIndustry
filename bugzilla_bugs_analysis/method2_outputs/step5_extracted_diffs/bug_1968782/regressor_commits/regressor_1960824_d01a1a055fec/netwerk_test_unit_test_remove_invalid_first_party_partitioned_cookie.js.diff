# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: netwerk/test/unit/test_remove_invalid_first_party_partitioned_cookie.js
# Commit: d01a1a055fec
# Full Hash: d01a1a055fece12b906b938954f984bd69278ef7
# Author: Andrea Marchesini <amarchesini@mozilla.com>
# Date: 2025-04-30 20:49:53
# Regressor Bug: 1960824
# File Overlap Count: 1
# Description:
#   Bug 1960824 - Introduce nsICookie::SAMESITE_UNSET, r=edgul,webdriver-reviewers,extension-reviewers,cookie-reviewers,valentin,Sasha,robwu
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D246638
# ==============================================================================

diff -r 307ff391dd02 -r d01a1a055fec netwerk/test/unit/test_remove_invalid_first_party_partitioned_cookie.js
--- a/netwerk/test/unit/test_remove_invalid_first_party_partitioned_cookie.js	Wed Apr 30 08:53:12 2025 +0000
+++ b/netwerk/test/unit/test_remove_invalid_first_party_partitioned_cookie.js	Wed Apr 30 08:59:18 2025 +0000
@@ -14,10 +14,13 @@
   // Close the profile.
   await promise_close_profile();
 
+  // Remove the cookie file in order to create another database file.
+  do_get_cookie_file(profile).remove(false);
+
   // Create a schema 14 database.
   let schema14db = new CookieDatabaseConnection(
     do_get_cookie_file(profile),
-    14
+    15
   );
 
   let now = Math.round(Date.now() / 1000);
@@ -37,7 +40,6 @@
     false, // isBrowserElement
     { partitionKey: "(https,example.com)" },
     Ci.nsICookie.SAMESITE_NONE,
-    Ci.nsICookie.SAMESITE_NONE,
     Ci.nsICookie.SCHEME_UNSET,
     false // isPartitioned
   );
@@ -58,7 +60,6 @@
     false, // isBrowserElement
     { partitionKey: "(https,example.com)" },
     Ci.nsICookie.SAMESITE_NONE,
-    Ci.nsICookie.SAMESITE_NONE,
     Ci.nsICookie.SCHEME_UNSET,
     true // isPartitioned
   );
@@ -79,7 +80,6 @@
     false, // isBrowserElement
     {},
     Ci.nsICookie.SAMESITE_NONE,
-    Ci.nsICookie.SAMESITE_NONE,
     Ci.nsICookie.SCHEME_UNSET,
     false // isPartitioned
   );
@@ -100,7 +100,6 @@
     false, // isBrowserElement
     { partitionKey: "(https,example.org)" },
     Ci.nsICookie.SAMESITE_NONE,
-    Ci.nsICookie.SAMESITE_NONE,
     Ci.nsICookie.SCHEME_UNSET,
     false // isPartitioned
   );
@@ -121,7 +120,6 @@
     false, // isBrowserElement
     { partitionKey: "(https,example.org)" },
     Ci.nsICookie.SAMESITE_NONE,
-    Ci.nsICookie.SAMESITE_NONE,
     Ci.nsICookie.SCHEME_UNSET,
     true // isPartitioned
   );