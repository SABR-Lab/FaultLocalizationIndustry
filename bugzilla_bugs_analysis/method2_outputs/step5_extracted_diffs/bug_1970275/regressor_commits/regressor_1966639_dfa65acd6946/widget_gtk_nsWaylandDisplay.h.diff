# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/gtk/nsWaylandDisplay.h
# Commit: dfa65acd6946
# Full Hash: dfa65acd69461e0143aa95b2c1c70e39ce469e51
# Author: stransky <stransky@redhat.com>
# Date: 2025-06-03 21:32:22
# Regressor Bug: 1966639
# File Overlap Count: 1
# Description:
#   Bug 1966639 [Wayland] Implement async roundtrip callbacks r=emilio
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D252138
# ==============================================================================

diff -r 32b1a5a7c6f5 -r dfa65acd6946 widget/gtk/nsWaylandDisplay.h
--- a/widget/gtk/nsWaylandDisplay.h	Tue Jun 03 07:15:04 2025 +0000
+++ b/widget/gtk/nsWaylandDisplay.h	Tue Jun 03 07:34:32 2025 +0000
@@ -110,6 +110,11 @@
   bool HasDMABufFeedback() const { return mDmabufIsFeedback; }
   void EnsureDMABufFormats();
 
+  static void AsyncRoundtripCallback(void* aData, wl_callback* aCallback,
+                                     uint32_t aTime);
+  void RequestAsyncRoundtrip();
+  void WaitForAsyncRoundtrips();
+
   ~nsWaylandDisplay();
 
  private:
@@ -136,6 +141,7 @@
   wp_fractional_scale_manager_v1* mFractionalScaleManager = nullptr;
   wp_color_manager_v1* mColorManager = nullptr;
   RefPtr<DMABufFormats> mFormats;
+  GList* mAsyncRoundtrips = nullptr;
 
   struct ColorManagerSupportedFeature {
     bool mICC = false;
