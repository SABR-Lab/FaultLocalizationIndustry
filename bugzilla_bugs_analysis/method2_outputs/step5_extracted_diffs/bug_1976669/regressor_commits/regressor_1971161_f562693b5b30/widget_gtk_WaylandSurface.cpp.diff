# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/gtk/WaylandSurface.cpp
# Commit: f562693b5b30
# Full Hash: f562693b5b30344af6419b1668bcbcf3a804daba
# Author: stransky <stransky@redhat.com>
# Date: 2025-07-08 16:25:02
# Regressor Bug: 1971161
# File Overlap Count: 1
# Description:
#   Bug 1971161 [Wayland] Refresh monitor setup on wp_color_management_output_v1::image_description_changed signal r=emilio
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D256433
# ==============================================================================

diff -r e977efc8bc30 -r f562693b5b30 widget/gtk/WaylandSurface.cpp
--- a/widget/gtk/WaylandSurface.cpp	Tue Jul 08 11:41:56 2025 +0000
+++ b/widget/gtk/WaylandSurface.cpp	Tue Jul 08 11:41:56 2025 +0000
@@ -1272,8 +1272,7 @@
 void WaylandSurface::ImageDescriptionFailed(
     void* aData, struct wp_image_description_v1* aImageDescription,
     uint32_t aCause, const char* aMsg) {
-  RefPtr waylandSurface =
-      already_AddRefed(reinterpret_cast<WaylandSurface*>(aData));
+  RefPtr waylandSurface = dont_AddRef(static_cast<WaylandSurface*>(aData));
   WaylandSurfaceLock lock(waylandSurface);
   waylandSurface->mHDRSet = false;
   LOGS("[%p] WaylandSurface::ImageDescriptionFailed()",
