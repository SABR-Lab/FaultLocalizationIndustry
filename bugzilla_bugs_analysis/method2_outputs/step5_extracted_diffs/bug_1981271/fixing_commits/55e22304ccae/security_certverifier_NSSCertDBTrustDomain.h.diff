# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: security/certverifier/NSSCertDBTrustDomain.h
# Commit: 55e22304ccae
# Full Hash: 55e22304ccaea2af33219077000171821441822c
# Author: Dana Keeler <dkeeler@mozilla.com>
# Date: 2025-08-07 04:23:39
# Description:
#   Bug 1981271 - reset state specific to the built candidate chain root when continuing path building r=nkulatova
#   
#   Any state that NSSCertDBTrustDomain keeps with regard to a built candidate
#   chain (and in particular, the root of that chain), must be reset if path
#   building continues with other potential chains. In particular, this means that
# ==============================================================================

diff -r 2c224e8a6135 -r 55e22304ccae security/certverifier/NSSCertDBTrustDomain.h
--- a/security/certverifier/NSSCertDBTrustDomain.h	Wed Aug 06 18:09:45 2025 +0000
+++ b/security/certverifier/NSSCertDBTrustDomain.h	Wed Aug 06 18:13:58 2025 +0000
@@ -230,6 +230,9 @@
   // Resets the OCSP stapling status and SCT lists accumulated during
   // the chain building.
   void ResetAccumulatedState();
+  // Resets state related to a fully-built candidate chain that becomes invalid
+  // if that chain is found to not be acceptable.
+  void ResetCandidateBuiltChainState();
 
   CertVerifier::OCSPStaplingStatus GetOCSPStaplingStatus() const {
     return mOCSPStaplingStatus;