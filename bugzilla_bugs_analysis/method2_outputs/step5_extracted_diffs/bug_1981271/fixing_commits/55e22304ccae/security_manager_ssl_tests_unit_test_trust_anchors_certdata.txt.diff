# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: security/manager/ssl/tests/unit/test_trust_anchors/certdata.txt
# Commit: 55e22304ccae
# Full Hash: 55e22304ccaea2af33219077000171821441822c
# Author: Dana Keeler <dkeeler@mozilla.com>
# Date: 2025-08-07 04:23:39
# Description:
#   Bug 1981271 - reset state specific to the built candidate chain root when continuing path building r=nkulatova
#   
#   Any state that NSSCertDBTrustDomain keeps with regard to a built candidate
#   chain (and in particular, the root of that chain), must be reset if path
#   building continues with other potential chains. In particular, this means that
# ==============================================================================

diff -r 2c224e8a6135 -r 55e22304ccae security/manager/ssl/tests/unit/test_trust_anchors/certdata.txt
--- a/security/manager/ssl/tests/unit/test_trust_anchors/certdata.txt	Wed Aug 06 18:09:45 2025 +0000
+++ b/security/manager/ssl/tests/unit/test_trust_anchors/certdata.txt	Wed Aug 06 18:13:58 2025 +0000
@@ -126,3 +126,115 @@
 CKA_TRUST_CODE_SIGNING CK_TRUST CKT_NSS_MUST_VERIFY_TRUST
 CKA_TRUST_STEP_UP_APPROVED CK_BBOOL CK_FALSE
 
+#
+# Certificate "Distrusted After Jan 2 2022 Root"
+#
+# Issuer: CN=ca2
+# Serial Number:77:51:1d:e0:56:45:9c:98:93:1b:b8:84:fc:2f:f5:25:08:2c:bc:91
+# Subject: CN=ca2
+# Not Valid Before: Wed Jan 01 00:00:00 2020
+# Not Valid After : Sun Jan 01 00:00:00 2051
+# Fingerprint (SHA-256): 4B:B7:81:96:F0:5D:60:DC:40:9A:9D:FF:0A:B8:32:DD:0D:65:27:E8:37:1C:9D:CE:66:82:AD:68:14:B6:EE:8C
+# Fingerprint (SHA1): 0D:FF:EA:CA:DA:B2:0C:38:CE:6B:D2:75:E3:5F:84:E8:B6:A6:F5:95
+CKA_CLASS CK_OBJECT_CLASS CKO_CERTIFICATE
+CKA_TOKEN CK_BBOOL CK_TRUE
+CKA_PRIVATE CK_BBOOL CK_FALSE
+CKA_MODIFIABLE CK_BBOOL CK_FALSE
+CKA_LABEL UTF8 "Distrusted After Jan 2 2022 Root"
+CKA_CERTIFICATE_TYPE CK_CERTIFICATE_TYPE CKC_X_509
+CKA_SUBJECT MULTILINE_OCTAL
+\060\016\061\014\060\012\006\003\125\004\003\014\003\143\141\062
+END
+CKA_ID UTF8 "0"
+CKA_ISSUER MULTILINE_OCTAL
+\060\016\061\014\060\012\006\003\125\004\003\014\003\143\141\062
+END
+CKA_SERIAL_NUMBER MULTILINE_OCTAL
+\002\024\167\121\035\340\126\105\234\230\223\033\270\204\374\057
+\365\045\010\054\274\221
+END
+CKA_VALUE MULTILINE_OCTAL
+\060\202\002\313\060\202\001\263\240\003\002\001\002\002\024\167
+\121\035\340\126\105\234\230\223\033\270\204\374\057\365\045\010
+\054\274\221\060\015\006\011\052\206\110\206\367\015\001\001\013
+\005\000\060\016\061\014\060\012\006\003\125\004\003\014\003\143
+\141\062\060\042\030\017\062\060\062\060\060\061\060\061\060\060
+\060\060\060\060\132\030\017\062\060\065\061\060\061\060\061\060
+\060\060\060\060\060\132\060\016\061\014\060\012\006\003\125\004
+\003\014\003\143\141\062\060\202\001\042\060\015\006\011\052\206
+\110\206\367\015\001\001\001\005\000\003\202\001\017\000\060\202
+\001\012\002\202\001\001\000\272\210\121\250\104\216\026\326\101
+\375\156\266\210\006\066\020\075\074\023\331\352\344\065\112\264
+\354\365\150\127\154\044\173\301\307\045\250\340\330\037\275\261
+\234\006\233\156\032\206\362\153\342\257\132\165\153\152\144\161
+\010\172\245\132\247\105\207\367\034\325\044\234\002\176\315\103
+\374\036\151\320\070\040\051\223\253\040\303\111\344\333\271\114
+\302\153\154\016\355\025\202\017\361\176\255\151\032\261\323\002
+\072\213\052\101\356\247\160\340\017\015\215\375\146\013\053\260
+\044\222\244\175\271\210\141\171\220\261\127\220\075\322\073\305
+\340\270\110\037\250\067\323\210\103\357\047\026\330\125\267\146
+\132\252\176\002\220\057\072\173\020\200\006\044\314\034\154\227
+\255\226\141\133\267\342\226\022\300\165\061\243\014\221\335\264
+\312\367\374\255\035\045\323\011\357\271\027\016\247\150\341\263
+\173\057\042\157\151\343\264\212\225\141\035\356\046\326\045\235
+\253\221\010\116\066\313\034\044\004\054\277\026\213\057\345\361
+\217\231\027\061\270\263\376\111\043\372\162\121\304\061\325\003
+\254\332\030\012\065\355\215\002\003\001\000\001\243\035\060\033
+\060\014\006\003\125\035\023\004\005\060\003\001\001\377\060\013
+\006\003\125\035\017\004\004\003\002\001\006\060\015\006\011\052
+\206\110\206\367\015\001\001\013\005\000\003\202\001\001\000\265
+\347\264\065\343\355\327\123\312\321\127\247\257\060\133\155\370
+\232\324\065\332\002\077\042\075\145\354\357\002\350\326\307\233
+\241\150\024\175\045\155\020\146\174\240\110\040\205\212\246\262
+\250\334\174\031\015\116\042\111\147\340\117\246\232\020\174\321
+\040\133\047\077\201\300\153\204\043\141\174\113\353\152\224\145
+\217\036\363\111\342\376\235\307\147\303\112\046\066\235\271\366
+\265\336\113\170\155\372\316\106\326\260\246\351\205\210\031\001
+\307\051\263\034\300\215\360\004\154\022\156\364\121\222\001\212
+\032\112\110\352\033\014\271\221\047\122\202\270\222\354\154\305
+\207\274\066\275\061\002\247\343\134\173\003\212\115\142\234\174
+\314\331\366\151\046\033\205\173\112\274\027\247\112\100\336\236
+\051\046\217\343\113\136\321\051\036\303\337\227\142\276\234\166
+\045\013\215\274\305\152\146\305\304\217\157\272\343\371\156\015
+\250\373\151\005\343\073\211\111\052\357\315\263\322\024\126\134
+\356\150\227\133\116\260\372\334\310\251\157\160\317\007\354\230
+\243\340\016\271\171\151\044\305\163\042\313\107\056\266\014
+END
+CKA_NSS_MOZILLA_CA_POLICY CK_BBOOL CK_TRUE
+# For Server Distrust After: Thu Jan 02 00:00:00 2022
+CKA_NSS_SERVER_DISTRUST_AFTER MULTILINE_OCTAL
+\062\062\060\061\060\062\060\060\060\060\060\060\132
+END
+CKA_NSS_EMAIL_DISTRUST_AFTER CK_BBOOL CK_FALSE
+
+# Trust for "Distrusted After Jan 2 2022 Root"
+# Issuer: CN=ca2
+# Serial Number:77:51:1d:e0:56:45:9c:98:93:1b:b8:84:fc:2f:f5:25:08:2c:bc:91
+# Subject: CN=ca2
+# Not Valid Before: Wed Jan 01 00:00:00 2020
+# Not Valid After : Sun Jan 01 00:00:00 2051
+# Fingerprint (SHA-256): 4B:B7:81:96:F0:5D:60:DC:40:9A:9D:FF:0A:B8:32:DD:0D:65:27:E8:37:1C:9D:CE:66:82:AD:68:14:B6:EE:8C
+# Fingerprint (SHA1): 0D:FF:EA:CA:DA:B2:0C:38:CE:6B:D2:75:E3:5F:84:E8:B6:A6:F5:95
+CKA_CLASS CK_OBJECT_CLASS CKO_NSS_TRUST
+CKA_TOKEN CK_BBOOL CK_TRUE
+CKA_PRIVATE CK_BBOOL CK_FALSE
+CKA_MODIFIABLE CK_BBOOL CK_FALSE
+CKA_LABEL UTF8 "Distrusted After Jan 2 2022 Root"
+CKA_CERT_SHA1_HASH MULTILINE_OCTAL
+\015\377\352\312\332\262\014\070\316\153\322\165\343\137\204\350
+\266\246\365\225
+END
+CKA_CERT_MD5_HASH MULTILINE_OCTAL
+\242\032\337\064\203\065\351\224\167\351\276\266\044\211\016\011
+END
+CKA_ISSUER MULTILINE_OCTAL
+\060\016\061\014\060\012\006\003\125\004\003\014\003\143\141\062
+END
+CKA_SERIAL_NUMBER MULTILINE_OCTAL
+\002\024\167\121\035\340\126\105\234\230\223\033\270\204\374\057
+\365\045\010\054\274\221
+END
+CKA_TRUST_SERVER_AUTH CK_TRUST CKT_NSS_TRUSTED_DELEGATOR
+CKA_TRUST_EMAIL_PROTECTION CK_TRUST CKT_NSS_MUST_VERIFY_TRUST
+CKA_TRUST_CODE_SIGNING CK_TRUST CKT_NSS_MUST_VERIFY_TRUST
+CKA_TRUST_STEP_UP_APPROVED CK_BBOOL CK_FALSE