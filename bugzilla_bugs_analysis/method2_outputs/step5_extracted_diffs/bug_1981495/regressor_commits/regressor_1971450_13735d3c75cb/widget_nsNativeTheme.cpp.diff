# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/nsNativeTheme.cpp
# Commit: 13735d3c75cb
# Full Hash: 13735d3c75cb7a6fabbdcae93bdfce3376d526e4
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2025-06-17 09:24:05
# Regressor Bug: 1971450
# File Overlap Count: 1
# Description:
#   Bug 1971450 - Remove internal appearance values for meter / progress / range thumb / chunk. r=dshin
#   
#   This is technically a behavior change because we don't really look at
#   the appearance value of the progressbar etc anymore. We could do that if
#   wanted, but it's more consistent to just look at the individual frame
# ==============================================================================

diff -r 275b63046ac5 -r 13735d3c75cb widget/nsNativeTheme.cpp
--- a/widget/nsNativeTheme.cpp	Mon Jun 16 22:22:24 2025 +0000
+++ b/widget/nsNativeTheme.cpp	Mon Jun 16 22:28:59 2025 +0000
@@ -202,14 +202,10 @@
 
   /**
    * Progress bar appearance should be the same for the bar and the container
-   * frame. nsProgressFrame owns the logic and will tell us what we should do.
+   * frame.
    */
-  if (aAppearance == StyleAppearance::Progresschunk ||
-      aAppearance == StyleAppearance::ProgressBar) {
-    nsProgressFrame* progressFrame = do_QueryFrame(
-        aAppearance == StyleAppearance::Progresschunk ? aFrame->GetParent()
-                                                      : aFrame);
-    if (progressFrame) {
+  if (aAppearance == StyleAppearance::ProgressBar) {
+    if (nsProgressFrame* progressFrame = do_QueryFrame(aFrame)) {
       return !progressFrame->ShouldUseNativeStyle();
     }
   }
@@ -218,12 +214,8 @@
    * Meter bar appearance should be the same for the bar and the container
    * frame. nsMeterFrame owns the logic and will tell us what we should do.
    */
-  if (aAppearance == StyleAppearance::Meterchunk ||
-      aAppearance == StyleAppearance::Meter) {
-    nsMeterFrame* meterFrame = do_QueryFrame(
-        aAppearance == StyleAppearance::Meterchunk ? aFrame->GetParent()
-                                                   : aFrame);
-    if (meterFrame) {
+  if (aAppearance == StyleAppearance::Meter) {
+    if (nsMeterFrame* meterFrame = do_QueryFrame(aFrame)) {
       return !meterFrame->ShouldUseNativeStyle();
     }
   }
@@ -233,12 +225,8 @@
    * comes to native theming (either all parts, or no parts, are themed).
    * nsRangeFrame owns the logic and will tell us what we should do.
    */
-  if (aAppearance == StyleAppearance::Range ||
-      aAppearance == StyleAppearance::RangeThumb) {
-    nsRangeFrame* rangeFrame = do_QueryFrame(
-        aAppearance == StyleAppearance::RangeThumb ? aFrame->GetParent()
-                                                   : aFrame);
-    if (rangeFrame) {
+  if (aAppearance == StyleAppearance::Range) {
+    if (nsRangeFrame* rangeFrame = do_QueryFrame(aFrame)) {
       return !rangeFrame->ShouldUseNativeStyle();
     }
   }
@@ -572,11 +560,8 @@
          aAppearance == StyleAppearance::SpinnerDownbutton ||
          aAppearance == StyleAppearance::Toolbarbutton ||
          aAppearance == StyleAppearance::ProgressBar ||
-         aAppearance == StyleAppearance::Progresschunk ||
          aAppearance == StyleAppearance::Meter ||
-         aAppearance == StyleAppearance::Meterchunk ||
          aAppearance == StyleAppearance::Range ||
-         aAppearance == StyleAppearance::RangeThumb ||
          aAppearance == StyleAppearance::Listbox ||
          (aFrame && aFrame->StyleUI()->mMozTheme == StyleMozTheme::NonNative);
 }