# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: dom/media/webrtc/libwebrtcglue/WebrtcTaskQueueWrapper.h
# Commit: 089becdb709e
# Full Hash: 089becdb709edf0ee24e60ebfdc4f0be25459eec
# Author: Andreas Pehrson <apehrson@mozilla.com>
# Date: 2025-06-19 21:40:31
# Regressor Bug: 1968812
# File Overlap Count: 1
# Description:
#   Bug 1968812 - Don't hold a lock while running tasks in WebrtcTaskQueueWrapper. r=bwc
#   
#   It can cause deadlocks, as observed with TimerThread, which also holds a lock
#   while running tasks. This patch simplifies the Delete function of
#   WebrtcTaskQueueWrapper, which is possible since there is now only a single
# ==============================================================================

diff -r 1c0d9fdb8a06 -r 089becdb709e dom/media/webrtc/libwebrtcglue/WebrtcTaskQueueWrapper.h
--- a/dom/media/webrtc/libwebrtcglue/WebrtcTaskQueueWrapper.h	Thu Jun 19 08:18:29 2025 +0000
+++ b/dom/media/webrtc/libwebrtcglue/WebrtcTaskQueueWrapper.h	Thu Jun 19 08:18:30 2025 +0000
@@ -36,7 +36,7 @@
  */
 std::unique_ptr<webrtc::TaskQueueBase, webrtc::TaskQueueDeleter>
 CreateWebrtcTaskQueue(already_AddRefed<nsIEventTarget> aTarget,
-                      const nsCString& aName, bool aSupportsTailDispatch);
+                      const nsACString& aName, bool aSupportsTailDispatch);
 
 /**
  * Creates a mozilla task queue that also exposes a webrtc::TaskQueueBase.
@@ -56,7 +56,7 @@
  * mozilla::TaskQueue.
  */
 RefPtr<TaskQueue> CreateWebrtcTaskQueueWrapper(
-    already_AddRefed<nsIEventTarget> aTarget, const nsCString& aName,
+    already_AddRefed<nsIEventTarget> aTarget, const nsACString& aName,
     bool aSupportsTailDispatch);
 
 /**
