# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/nsBaseWidget.cpp
# Commit: 18c714c3af0f
# Full Hash: 18c714c3af0f77750cc36ec9f162e9d84d3f537f
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2025-04-29 20:49:47
# Regressor Bug: 1919165
# File Overlap Count: 1
# Description:
#   Bug 1919165 - Remove support for WindowType::Child, which is now unused. r=stransky
#   
#   We don't take this codepath anymore in any platform. Windows and GTK
#   were already asserting against it.
#   
# ==============================================================================

diff -r 734373410b28 -r 18c714c3af0f widget/nsBaseWidget.cpp
--- a/widget/nsBaseWidget.cpp	Tue Apr 29 14:04:48 2025 +0000
+++ b/widget/nsBaseWidget.cpp	Tue Apr 29 14:04:53 2025 +0000
@@ -516,10 +516,9 @@
 
 // Attach a view to our widget which we'll send events to.
 void nsBaseWidget::AttachViewToTopLevel(bool aUseAttachedEvents) {
-  NS_ASSERTION((mWindowType == WindowType::TopLevel ||
+  NS_ASSERTION(mWindowType == WindowType::TopLevel ||
                 mWindowType == WindowType::Dialog ||
-                mWindowType == WindowType::Invisible ||
-                mWindowType == WindowType::Child),
+                mWindowType == WindowType::Invisible,
                "Can't attach to window of that type");
 
   mUseAttachedEvents = aUseAttachedEvents;
@@ -969,8 +968,8 @@
     return false;
   }
 
-  // Always use APZ for top-level windows
-  if (mWindowType == WindowType::TopLevel || mWindowType == WindowType::Child) {
+  // Always use APZ for top-level windows. XXX what about Dialog?
+  if (mWindowType == WindowType::TopLevel) {
     return true;
   }
 
@@ -986,7 +985,9 @@
   if (HasRemoteContent()) {
     return mWindowType == WindowType::Dialog ||
            mWindowType == WindowType::Popup;
-  } else if (StaticPrefs::apz_popups_without_remote_enabled()) {
+  }
+
+  if (StaticPrefs::apz_popups_without_remote_enabled()) {
     return mWindowType == WindowType::Popup;
   }
 