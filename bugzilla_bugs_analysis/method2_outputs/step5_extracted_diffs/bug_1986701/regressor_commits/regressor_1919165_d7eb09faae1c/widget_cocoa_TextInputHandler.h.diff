# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: widget/cocoa/TextInputHandler.h
# Commit: d7eb09faae1c
# Full Hash: d7eb09faae1c39fe5ba7039c0c14b9ee13fe6f48
# Author: Emilio Cobos √Ålvarez <emilio@crisal.io>
# Date: 2025-04-29 20:49:47
# Regressor Bug: 1919165
# File Overlap Count: 1
# Description:
#   Bug 1919165 - Get rid of nsChildView. r=mac-reviewers,mstange
#   
#   In a follow-up I want to merge nsChildView.mm into nsCocoaWindow.mm, but
#   I thought I'd send this for feedback.
#   
# ==============================================================================

diff -r 1eeb386120ff -r d7eb09faae1c widget/cocoa/TextInputHandler.h
--- a/widget/cocoa/TextInputHandler.h	Tue Apr 29 13:50:20 2025 +0000
+++ b/widget/cocoa/TextInputHandler.h	Tue Apr 29 13:51:02 2025 +0000
@@ -21,7 +21,7 @@
 #include "mozilla/TextEventDispatcherListener.h"
 #include "WritingModes.h"
 
-class nsChildView;
+class nsCocoaWindow;
 
 namespace mozilla {
 namespace widget {
@@ -516,20 +516,20 @@
    *                              sub classes should return from this method
    *                              without cleaning up.
    */
-  virtual bool OnDestroyWidget(nsChildView* aDestroyingWidget);
+  virtual bool OnDestroyWidget(nsCocoaWindow* aDestroyingWidget);
 
  protected:
   // The creator of this instance, client and its text event dispatcher.
   // These members must not be nullptr after initialized until
   // OnDestroyWidget() is called.
-  nsChildView* mWidget;  // [WEAK]
+  nsCocoaWindow* mWidget;  // [WEAK]
   RefPtr<TextEventDispatcher> mDispatcher;
 
   // The native view for mWidget.
   // This view handles the actual text inputting.
   NSView<mozView>* mView;  // [STRONG]
 
-  TextInputHandlerBase(nsChildView* aWidget, NSView<mozView>* aNativeView);
+  TextInputHandlerBase(nsCocoaWindow* aWidget, NSView<mozView>* aNativeView);
   virtual ~TextInputHandlerBase();
 
   bool Destroyed() { return !mWidget; }
@@ -898,12 +898,12 @@
 
 /**
  * IMEInputHandler manages:
- *   1. The IME/keyboard layout statement of nsChildView.
- *   2. The IME composition statement of nsChildView.
+ *   1. The IME/keyboard layout statement of nsCocoaWindow.
+ *   2. The IME composition statement of nsCocoaWindow.
  * And also provides the methods which controls the current IME transaction of
  * the instance.
  *
- * Note that an nsChildView handles one or more NSView's events.  E.g., even if
+ * Note that an nsCocoaWindow handles one or more NSView's events.  E.g., even if
  * a text editor on XUL panel element, the input events handled on the parent
  * (or its ancestor) widget handles it (the native focus is set to it).  The
  * actual focused view is notified by OnFocusChangeInGecko.
@@ -923,7 +923,7 @@
                             uint32_t aIndexOfKeypress, void* aData) override;
 
  public:
-  virtual bool OnDestroyWidget(nsChildView* aDestroyingWidget) override;
+  virtual bool OnDestroyWidget(nsCocoaWindow* aDestroyingWidget) override;
 
   virtual void OnFocusChangeInGecko(bool aFocus);
 
@@ -1071,7 +1071,7 @@
   NSTextCheckingResult* mCandidatedTextSubstitutionResult;
   bool mProcessTextSubstitution;
 
-  IMEInputHandler(nsChildView* aWidget, NSView<mozView>* aNativeView);
+  IMEInputHandler(nsCocoaWindow* aWidget, NSView<mozView>* aNativeView);
   virtual ~IMEInputHandler();
 
   void ResetTimer();
@@ -1261,7 +1261,7 @@
   static CFArrayRef CreateAllKeyboardLayoutList();
   static void DebugPrintAllKeyboardLayouts();
 
-  TextInputHandler(nsChildView* aWidget, NSView<mozView>* aNativeView);
+  TextInputHandler(nsCocoaWindow* aWidget, NSView<mozView>* aNativeView);
   virtual ~TextInputHandler();
 
   /**