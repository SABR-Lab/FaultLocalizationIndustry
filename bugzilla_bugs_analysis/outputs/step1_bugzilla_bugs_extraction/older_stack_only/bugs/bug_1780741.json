{
  "bug_id": "1780741",
  "summary": "Crash [@ mozilla::dom::ExternalHelperAppParent::RecvOnStartRequest] or [@ mozilla::dom::ExternalHelperAppParent::RecvOnDataRequest]",
  "status": "RESOLVED",
  "resolution": "FIXED",
  "product": "Firefox",
  "component": "File Handling",
  "version": "Trunk",
  "severity": "S2",
  "priority": "--",
  "creation_time": "2022-07-22T08:42:24Z",
  "last_change_time": "2023-01-17T04:51:16Z",
  "is_recent": false,
  "crash_signature_raw": "[@ mozilla::dom::ExternalHelperAppParent::RecvOnStartRequest]\r\n[@ mozilla::dom::ExternalHelperAppParent::RecvOnDataRequest]",
  "crash_signatures": [
    "mozilla::dom::ExternalHelperAppParent::RecvOnStartRequest",
    "mozilla::dom::ExternalHelperAppParent::RecvOnDataRequest"
  ],
  "keywords": [
    "crash",
    "sec-other",
    "testcase"
  ],
  "regressed_by": [],
  "regressions": [],
  "bugzilla_url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1780741",
  "socorro_links": [],
  "socorro_crash_ids": [],
  "has_socorro_link": false,
  "has_direct_crash_id": false,
  "stack_traces": [
    {
      "comment_id": 15995486,
      "comment_count": 0,
      "creator": "choller@mozilla.com",
      "creation_time": "2022-07-22T08:42:24Z",
      "raw_text": "In experimental IPC fuzzing, we found the following crash on mozilla-central revision 375d42ba2f83+:\n\n    =================================================================\n    ==2126==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7fffd24f7256 bp 0x7fffffdc3390 sp 0x7fffffdc3370 T0)\n        #0 0x7fffd24f7256 in mozilla::dom::ExternalHelperAppParent::RecvOnStartRequest(nsTString<char> const&) uriloader/exthandler/ExternalHelperAppParent.cpp:115:24\n        #1 0x7fffd2565544 in mozilla::dom::PExternalHelperAppParent::OnMessageReceived(IPC::Message const&) objdir-ff-asan-oldc/ipc/ipdl/PExternalHelperAppParent.cpp:195:52\n        #2 0x7fffdfabb716 in mozilla::dom::PContentParent::OnMessageReceived(IPC::Message const&) objdir-ff-asan-oldc/ipc/ipdl/PContentParent.cpp:6615:32\n        #3 0x7fffd19d7ce3 in mozilla::ipc::MessageChannel::DispatchAsyncMessage(mozilla::ipc::ActorLifecycleProxy*, IPC::Message const&) ipc/glue/MessageChannel.cpp:1749:25\n        [...]\n        #22 0x7fffeafd14de in XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&) toolkit/xre/nsAppRunner.cpp:5942:8\n\n\n\nThe issue here is that methods in `ExternalHelperAppParent` lack checks for `Init` being called prior to other methods, so `mListener` ends up being `nullptr`. Adding those checks should be straightforward. Keeping bug s-s because parent bug is still s-s.",
      "matched_patterns": [
        "#\\d+\\s+0x[0-9a-fA-F]+\\s+in\\s+\\S+",
        "mozilla::\\S+::\\S+\\s*\\("
      ],
      "parsed_frames": [
        {
          "frame_index": 0,
          "function": "mozilla::dom::ExternalHelperAppParent::RecvOnStartRequest",
          "file": "",
          "line": null,
          "module": "",
          "raw": "#0 0x7fffd24f7256 in mozilla::dom::ExternalHelperAppParent::RecvOnStartRequest(nsTString<char> const&) uriloader/exthandler/ExternalHelperAppParent.cpp:115:24"
        },
        {
          "frame_index": 1,
          "function": "mozilla::dom::PExternalHelperAppParent::OnMessageReceived",
          "file": "",
          "line": null,
          "module": "",
          "raw": "#1 0x7fffd2565544 in mozilla::dom::PExternalHelperAppParent::OnMessageReceived(IPC::Message const&) objdir-ff-asan-oldc/ipc/ipdl/PExternalHelperAppParent.cpp:195:52"
        },
        {
          "frame_index": 2,
          "function": "mozilla::dom::PContentParent::OnMessageReceived",
          "file": "",
          "line": null,
          "module": "",
          "raw": "#2 0x7fffdfabb716 in mozilla::dom::PContentParent::OnMessageReceived(IPC::Message const&) objdir-ff-asan-oldc/ipc/ipdl/PContentParent.cpp:6615:32"
        },
        {
          "frame_index": 3,
          "function": "mozilla::ipc::MessageChannel::DispatchAsyncMessage",
          "file": "",
          "line": null,
          "module": "",
          "raw": "#3 0x7fffd19d7ce3 in mozilla::ipc::MessageChannel::DispatchAsyncMessage(mozilla::ipc::ActorLifecycleProxy*, IPC::Message const&) ipc/glue/MessageChannel.cpp:1749:25"
        },
        {
          "frame_index": 22,
          "function": "XREMain::XRE_main",
          "file": "",
          "line": null,
          "module": "",
          "raw": "#22 0x7fffeafd14de in XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&) toolkit/xre/nsAppRunner.cpp:5942:8"
        }
      ],
      "frame_count": 5
    }
  ],
  "has_stack_traces": true,
  "stack_trace_count": 1,
  "total_parsed_frames": 5
}