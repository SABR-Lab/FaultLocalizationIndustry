{
  "bug_id": "1994855",
  "summary": "Crash in [@ mozilla::widget::StatusBarEntry::OnMessage] (diagnostic assert)",
  "status": "RESOLVED",
  "resolution": "FIXED",
  "product": "Core",
  "component": "Widget: Win32",
  "version": "unspecified",
  "severity": "S3",
  "priority": "--",
  "creation_time": "2025-10-16T21:12:19Z",
  "last_change_time": "2025-11-12T11:11:00Z",
  "is_recent": true,
  "crash_signature_raw": "[@ mozilla::widget::StatusBarEntry::OnMessage]",
  "crash_signatures": [
    "mozilla::widget::StatusBarEntry::OnMessage"
  ],
  "keywords": [
    "crash",
    "regression"
  ],
  "regressed_by": [
    1933181
  ],
  "regressions": [],
  "bugzilla_url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1994855",
  "socorro_links": [
    {
      "url": "https://crash-stats.mozilla.org/report/index/03a04efd-945e-479a-addc-263fd0251015",
      "crash_id": "03a04efd-945e-479a-addc-263fd0251015",
      "comment_index": 0,
      "comment_text": "Crash report: https://crash-stats.mozilla.org/report/index/03a04efd-945e-479a-addc-263fd0251015\n\nMOZ_CRASH Reason:\n```\nMOZ_DIAGNOSTIC_ASSERT(widget)\n```\n\nTop 10 frames:\n```\n0  xul.dll  mozilla::widget::StatusBarEntry::OnMessage(HWND__*, unsigned int, unsigned lo...  widget/windows/SystemStatusBar.cpp:189\n1  xul.dll  mozilla::widget::WindowProc(HWND__*, unsigned int, unsigned long long, long l...  widget/windows/SystemStatusBar.cpp:246\n2  user32.dll  UserCallWinProcCheckWow(_ACTIVATION_CONTEXT*, int64_t (*)(tagWND*, unsigned i...\n3  user32.dll  DispatchClientMessage\n4  user32.dll  _fnDWORD\n5  ntdll.dll  KiUserCallbackDispatch\n6  win32u.dll  ZwUserPeekMessage\n7  user32.dll  _PeekMessage(tagMSG*, HWND__*, unsigned int, unsigned int, unsigned int, unsi...\n8  user32.dll  PeekMessageW\n9  msctf.dll  CThreadInputMgr::PeekMessageW(tagMSG*, HWND__*, unsigned int, unsigned int, u...\n```\n\nThis assertion is old, but it seems to have started showing up on Nightly 146, build id 20251014213342. [Here](https://hg-edge.mozilla.org/mozilla-central/pushloghtml?fromchange=860e9251e02806437cda3650e62d5747aaa45895&tochange=69063d81c4e1f54731d4a8698c63c3a703e83966) is the set of changes in that build.\n\nEmilio, could this be related to bug 1994157? That's the bug I found when I searched for \"widget\" in that change log. Thanks."
    }
  ],
  "socorro_crash_ids": [
    "03a04efd-945e-479a-addc-263fd0251015"
  ],
  "has_socorro_link": true,
  "has_direct_crash_id": true,
  "stack_traces": [
    {
      "comment_id": 17719792,
      "comment_count": 0,
      "creator": "continuation@gmail.com",
      "creation_time": "2025-10-16T21:12:19Z",
      "raw_text": "Crash report: https://crash-stats.mozilla.org/report/index/03a04efd-945e-479a-addc-263fd0251015\n\nMOZ_CRASH Reason:\n```\nMOZ_DIAGNOSTIC_ASSERT(widget)\n```\n\nTop 10 frames:\n```\n0  xul.dll  mozilla::widget::StatusBarEntry::OnMessage(HWND__*, unsigned int, unsigned lo...  widget/windows/SystemStatusBar.cpp:189\n1  xul.dll  mozilla::widget::WindowProc(HWND__*, unsigned int, unsigned long long, long l...  widget/windows/SystemStatusBar.cpp:246\n2  user32.dll  UserCallWinProcCheckWow(_ACTIVATION_CONTEXT*, int64_t (*)(tagWND*, unsigned i...\n3  user32.dll  DispatchClientMessage\n4  user32.dll  _fnDWORD\n5  ntdll.dll  KiUserCallbackDispatch\n6  win32u.dll  ZwUserPeekMessage\n7  user32.dll  _PeekMessage(tagMSG*, HWND__*, unsigned int, unsigned int, unsigned int, unsi...\n8  user32.dll  PeekMessageW\n9  msctf.dll  CThreadInputMgr::PeekMessageW(tagMSG*, HWND__*, unsigned int, unsigned int, u...\n```\n\nThis assertion is old, but it seems to have started showing up on Nightly 146, build id 20251014213342. [Here](https://hg-edge.mozilla.org/mozilla-central/pushloghtml?fromchange=860e9251e02806437cda3650e62d5747aaa45895&tochange=69063d81c4e1f54731d4a8698c63c3a703e83966) is the set of changes in that build.\n\nEmilio, could this be related to bug 1994157? That's the bug I found when I searched for \"widget\" in that change log. Thanks.",
      "matched_patterns": [
        "mozilla::\\S+::\\S+\\s*\\(",
        "(?i)(crash|stack)\\s*(trace|dump|report)"
      ],
      "parsed_frames": [
        {
          "frame_index": 0,
          "module": "xul.dll",
          "function": "mozilla::widget::StatusBarEntry::OnMessage(HWND__*, unsigned int, unsigned lo...",
          "file": "widget/windows/SystemStatusBar.cpp",
          "line": 189,
          "raw": "0  xul.dll  mozilla::widget::StatusBarEntry::OnMessage(HWND__*, unsigned int, unsigned lo...  widget/windows/SystemStatusBar.cpp:189"
        },
        {
          "frame_index": 1,
          "module": "xul.dll",
          "function": "mozilla::widget::WindowProc(HWND__*, unsigned int, unsigned long long, long l...",
          "file": "widget/windows/SystemStatusBar.cpp",
          "line": 246,
          "raw": "1  xul.dll  mozilla::widget::WindowProc(HWND__*, unsigned int, unsigned long long, long l...  widget/windows/SystemStatusBar.cpp:246"
        },
        {
          "frame_index": 2,
          "module": "user32.dll",
          "function": "UserCallWinProcCheckWow(_ACTIVATION_CONTEXT*, int64_t (*)(tagWND*, unsigned i...",
          "file": "",
          "line": null,
          "raw": "2  user32.dll  UserCallWinProcCheckWow(_ACTIVATION_CONTEXT*, int64_t (*)(tagWND*, unsigned i..."
        },
        {
          "frame_index": 3,
          "module": "user32.dll",
          "function": "DispatchClientMessage",
          "file": "",
          "line": null,
          "raw": "3  user32.dll  DispatchClientMessage"
        },
        {
          "frame_index": 4,
          "module": "user32.dll",
          "function": "_fnDWORD",
          "file": "",
          "line": null,
          "raw": "4  user32.dll  _fnDWORD"
        },
        {
          "frame_index": 5,
          "module": "ntdll.dll",
          "function": "KiUserCallbackDispatch",
          "file": "",
          "line": null,
          "raw": "5  ntdll.dll  KiUserCallbackDispatch"
        },
        {
          "frame_index": 6,
          "module": "win32u.dll",
          "function": "ZwUserPeekMessage",
          "file": "",
          "line": null,
          "raw": "6  win32u.dll  ZwUserPeekMessage"
        },
        {
          "frame_index": 7,
          "module": "user32.dll",
          "function": "_PeekMessage(tagMSG*, HWND__*, unsigned int, unsigned int, unsigned int, unsi...",
          "file": "",
          "line": null,
          "raw": "7  user32.dll  _PeekMessage(tagMSG*, HWND__*, unsigned int, unsigned int, unsigned int, unsi..."
        },
        {
          "frame_index": 8,
          "module": "user32.dll",
          "function": "PeekMessageW",
          "file": "",
          "line": null,
          "raw": "8  user32.dll  PeekMessageW"
        },
        {
          "frame_index": 9,
          "module": "msctf.dll",
          "function": "CThreadInputMgr::PeekMessageW(tagMSG*, HWND__*, unsigned int, unsigned int, u...",
          "file": "",
          "line": null,
          "raw": "9  msctf.dll  CThreadInputMgr::PeekMessageW(tagMSG*, HWND__*, unsigned int, unsigned int, u..."
        }
      ],
      "frame_count": 10
    }
  ],
  "has_stack_traces": true,
  "stack_trace_count": 1,
  "total_parsed_frames": 10
}