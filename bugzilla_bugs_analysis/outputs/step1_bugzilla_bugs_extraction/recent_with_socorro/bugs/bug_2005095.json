{
  "bug_id": "2005095",
  "summary": "Crash in [@ nsMaybeWeakPtrArray<T>::AppendWeakElement] with \"Element already in array.\"",
  "status": "RESOLVED",
  "resolution": "FIXED",
  "product": "Core",
  "component": "XPCOM",
  "version": "unspecified",
  "severity": "--",
  "priority": "--",
  "creation_time": "2025-12-10T00:07:25Z",
  "last_change_time": "2025-12-12T02:31:50Z",
  "is_recent": true,
  "crash_signature_raw": "[@ nsMaybeWeakPtrArray<T>::AppendWeakElement]",
  "crash_signatures": [
    "nsMaybeWeakPtrArray<T>::AppendWeakElement"
  ],
  "keywords": [
    "crash",
    "regression"
  ],
  "regressed_by": [
    1991834
  ],
  "regressions": [],
  "bugzilla_url": "https://bugzilla.mozilla.org/show_bug.cgi?id=2005095",
  "socorro_links": [
    {
      "url": "https://crash-stats.mozilla.org/report/index/e5752c45-3c10-4b74-96e2-385f80251209",
      "crash_id": "e5752c45-3c10-4b74-96e2-385f80251209",
      "comment_index": 0,
      "comment_text": "Crash report: https://crash-stats.mozilla.org/report/index/e5752c45-3c10-4b74-96e2-385f80251209\n\nMOZ_CRASH Reason:\n```\nMOZ_DIAGNOSTIC_ASSERT(false) (Element already in array.)\n```\n\nTop 10 frames:\n```\n0  libxul.so  MOZ_CrashSequence(void*, long)  mfbt/Assertions.h:237\n0  libxul.so  nsMaybeWeakPtrArray<nsIObserver>::AppendWeakElement(nsIObserver*, bool)  xpcom/base/nsMaybeWeakPtr.h:90\n0  libxul.so  nsObserverList::AddObserver(nsIObserver*, bool)  xpcom/ds/nsObserverList.cpp:16\n0  libxul.so  nsObserverService::AddObserver(nsIObserver*, char const*, bool)  xpcom/ds/nsObserverService.cpp:223\n1  libxul.so  NS_InvokeByIndex\n2  libxul.so  CallMethodHelper::Invoke()  js/xpconnect/src/XPCWrappedNative.cpp:1619\n2  libxul.so  CallMethodHelper::Call()  js/xpconnect/src/XPCWrappedNative.cpp:1173\n2  libxul.so  XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode)  js/xpconnect/src/XPCWrappedNative.cpp:1119\n3  libxul.so  XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*)  js/xpconnect/src/XPCWrappedNativeJSOps.cpp:966\n4  libxul.so  CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::...  js/src/vm/Interpreter.cpp:490\n```\n\nUnfortunately no real way to tell where this is coming from. The volume looks a bit high given how short of a period this Nightly has been out."
    }
  ],
  "socorro_crash_ids": [
    "e5752c45-3c10-4b74-96e2-385f80251209"
  ],
  "has_socorro_link": true,
  "has_direct_crash_id": true,
  "stack_traces": [
    {
      "comment_id": 17800910,
      "comment_count": 0,
      "creator": "continuation@gmail.com",
      "creation_time": "2025-12-10T00:07:25Z",
      "raw_text": "Crash report: https://crash-stats.mozilla.org/report/index/e5752c45-3c10-4b74-96e2-385f80251209\n\nMOZ_CRASH Reason:\n```\nMOZ_DIAGNOSTIC_ASSERT(false) (Element already in array.)\n```\n\nTop 10 frames:\n```\n0  libxul.so  MOZ_CrashSequence(void*, long)  mfbt/Assertions.h:237\n0  libxul.so  nsMaybeWeakPtrArray<nsIObserver>::AppendWeakElement(nsIObserver*, bool)  xpcom/base/nsMaybeWeakPtr.h:90\n0  libxul.so  nsObserverList::AddObserver(nsIObserver*, bool)  xpcom/ds/nsObserverList.cpp:16\n0  libxul.so  nsObserverService::AddObserver(nsIObserver*, char const*, bool)  xpcom/ds/nsObserverService.cpp:223\n1  libxul.so  NS_InvokeByIndex\n2  libxul.so  CallMethodHelper::Invoke()  js/xpconnect/src/XPCWrappedNative.cpp:1619\n2  libxul.so  CallMethodHelper::Call()  js/xpconnect/src/XPCWrappedNative.cpp:1173\n2  libxul.so  XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode)  js/xpconnect/src/XPCWrappedNative.cpp:1119\n3  libxul.so  XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*)  js/xpconnect/src/XPCWrappedNativeJSOps.cpp:966\n4  libxul.so  CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::...  js/src/vm/Interpreter.cpp:490\n```\n\nUnfortunately no real way to tell where this is coming from. The volume looks a bit high given how short of a period this Nightly has been out.",
      "matched_patterns": [
        "ns[A-Z]\\w+::\\w+",
        "(?i)(crash|stack)\\s*(trace|dump|report)"
      ],
      "parsed_frames": [
        {
          "frame_index": 0,
          "module": "libxul.so",
          "function": "MOZ_CrashSequence(void*, long)",
          "file": "mfbt/Assertions.h",
          "line": 237,
          "raw": "0  libxul.so  MOZ_CrashSequence(void*, long)  mfbt/Assertions.h:237"
        },
        {
          "frame_index": 0,
          "module": "libxul.so",
          "function": "nsMaybeWeakPtrArray<nsIObserver>::AppendWeakElement(nsIObserver*, bool)",
          "file": "xpcom/base/nsMaybeWeakPtr.h",
          "line": 90,
          "raw": "0  libxul.so  nsMaybeWeakPtrArray<nsIObserver>::AppendWeakElement(nsIObserver*, bool)  xpcom/base/nsMaybeWeakPtr.h:90"
        },
        {
          "frame_index": 0,
          "module": "libxul.so",
          "function": "nsObserverList::AddObserver(nsIObserver*, bool)",
          "file": "xpcom/ds/nsObserverList.cpp",
          "line": 16,
          "raw": "0  libxul.so  nsObserverList::AddObserver(nsIObserver*, bool)  xpcom/ds/nsObserverList.cpp:16"
        },
        {
          "frame_index": 0,
          "module": "libxul.so",
          "function": "nsObserverService::AddObserver(nsIObserver*, char const*, bool)",
          "file": "xpcom/ds/nsObserverService.cpp",
          "line": 223,
          "raw": "0  libxul.so  nsObserverService::AddObserver(nsIObserver*, char const*, bool)  xpcom/ds/nsObserverService.cpp:223"
        },
        {
          "frame_index": 1,
          "module": "libxul.so",
          "function": "NS_InvokeByIndex",
          "file": "",
          "line": null,
          "raw": "1  libxul.so  NS_InvokeByIndex"
        },
        {
          "frame_index": 2,
          "module": "libxul.so",
          "function": "CallMethodHelper::Invoke()",
          "file": "js/xpconnect/src/XPCWrappedNative.cpp",
          "line": 1619,
          "raw": "2  libxul.so  CallMethodHelper::Invoke()  js/xpconnect/src/XPCWrappedNative.cpp:1619"
        },
        {
          "frame_index": 2,
          "module": "libxul.so",
          "function": "CallMethodHelper::Call()",
          "file": "js/xpconnect/src/XPCWrappedNative.cpp",
          "line": 1173,
          "raw": "2  libxul.so  CallMethodHelper::Call()  js/xpconnect/src/XPCWrappedNative.cpp:1173"
        },
        {
          "frame_index": 2,
          "module": "libxul.so",
          "function": "XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode)",
          "file": "js/xpconnect/src/XPCWrappedNative.cpp",
          "line": 1119,
          "raw": "2  libxul.so  XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode)  js/xpconnect/src/XPCWrappedNative.cpp:1119"
        },
        {
          "frame_index": 3,
          "module": "libxul.so",
          "function": "XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*)",
          "file": "js/xpconnect/src/XPCWrappedNativeJSOps.cpp",
          "line": 966,
          "raw": "3  libxul.so  XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*)  js/xpconnect/src/XPCWrappedNativeJSOps.cpp:966"
        },
        {
          "frame_index": 4,
          "module": "libxul.so",
          "function": "CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::...",
          "file": "js/src/vm/Interpreter.cpp",
          "line": 490,
          "raw": "4  libxul.so  CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::...  js/src/vm/Interpreter.cpp:490"
        }
      ],
      "frame_count": 10
    }
  ],
  "has_stack_traces": true,
  "stack_trace_count": 1,
  "total_parsed_frames": 10
}