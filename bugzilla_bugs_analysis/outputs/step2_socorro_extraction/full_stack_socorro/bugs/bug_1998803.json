{
  "bug_id": "1998803",
  "summary": "Crash in [@ DMABufSurfaceYUV::GetUsedMemoryYUV]",
  "product": "Core",
  "component": "Audio/Video: Playback",
  "creation_time": "2025-11-06T21:01:53Z",
  "crash_signatures": [
    "DMABufSurfaceYUV::GetUsedMemoryYUV"
  ],
  "bugzilla_url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1998803",
  "socorro_crash_ids": [
    "5cf6a5a3-2190-4197-853a-181020251106"
  ],
  "stack_source": "socorro",
  "crash_id": "5cf6a5a3-2190-4197-853a-181020251106",
  "socorro_metadata": {
    "signature": "",
    "crash_reason": "",
    "moz_crash_reason": "",
    "crashing_thread": {
      "index": 15,
      "name": "MediaPD~oder #4"
    }
  },
  "stack_trace": {
    "source": "socorro",
    "crash_id": "5cf6a5a3-2190-4197-853a-181020251106",
    "frames": [
      {
        "frame_index": 0,
        "module": "libxul.so",
        "function": "MOZ_CrashSequence(void*, long)",
        "source": "mfbt/Assertions.h:237",
        "file": "mfbt/Assertions.h",
        "line": 237,
        "trust": "inlined"
      },
      {
        "frame_index": 0,
        "module": "libxul.so",
        "function": "DMABufSurfaceYUV::GetUsedMemoryYUV(int, int, int)",
        "source": "widget/gtk/DMABufSurface.cpp:1534",
        "file": "widget/gtk/DMABufSurface.cpp",
        "line": 1534,
        "trust": "context"
      },
      {
        "frame_index": 1,
        "module": "libxul.so",
        "function": "DMABufSurfaceYUV::ReleaseVADRMPRIMESurfaceDescriptor(_VADRMPRIMESurfaceDescriptor&)",
        "source": "widget/gtk/DMABufSurface.cpp:1635",
        "file": "widget/gtk/DMABufSurface.cpp",
        "line": 1635,
        "trust": "cfi"
      },
      {
        "frame_index": 2,
        "module": "libxul.so",
        "function": "mozilla::FFmpegVideoDecoder<61>::CreateImageVAAPI(long, long, long, nsTArray<RefPtr<mozilla::MediaData> >&)::$_0::operator()() const",
        "source": "dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp:1799",
        "file": "dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp",
        "line": 1799,
        "trust": "inlined"
      },
      {
        "frame_index": 2,
        "module": "libxul.so",
        "function": "mozilla::ScopeExit<mozilla::FFmpegVideoDecoder<61>::CreateImageVAAPI(long, long, long, nsTArray<RefPtr<mozilla::MediaData> >&)::$_0>::~ScopeExit()",
        "source": "mfbt/ScopeExit.h:106",
        "file": "mfbt/ScopeExit.h",
        "line": 106,
        "trust": "inlined"
      },
      {
        "frame_index": 2,
        "module": "libxul.so",
        "function": "mozilla::FFmpegVideoDecoder<61>::CreateImageVAAPI(long, long, long, nsTArray<RefPtr<mozilla::MediaData> >&)",
        "source": "dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp:1848",
        "file": "dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp",
        "line": 1848,
        "trust": "cfi"
      },
      {
        "frame_index": 3,
        "module": "libxul.so",
        "function": "mozilla::FFmpegVideoDecoder<61>::DoDecode(mozilla::MediaRawData*, unsigned char*, int, bool*, nsTArray<RefPtr<mozilla::MediaData> >&)",
        "source": "dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp:1311",
        "file": "dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp",
        "line": 1311,
        "trust": "cfi"
      },
      {
        "frame_index": 4,
        "module": "libxul.so",
        "function": "mozilla::FFmpegDataDecoder<53>::DoDecode(mozilla::MediaRawData*, bool*, nsTArray<RefPtr<mozilla::MediaData> >&)",
        "source": "dom/media/platforms/ffmpeg/FFmpegDataDecoder.cpp:277",
        "file": "dom/media/platforms/ffmpeg/FFmpegDataDecoder.cpp",
        "line": 277,
        "trust": "cfi"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "mozilla::FFmpegDataDecoder<61>::ProcessDrain()",
        "source": "dom/media/platforms/ffmpeg/FFmpegDataDecoder.cpp:308",
        "file": "dom/media/platforms/ffmpeg/FFmpegDataDecoder.cpp",
        "line": 308,
        "trust": "cfi"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}::operator()<>(&&) const",
        "source": "xpcom/threads/nsThreadUtils.h:1083",
        "file": "xpcom/threads/nsThreadUtils.h",
        "line": 1083,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "std::__invoke_impl<RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> >, mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}, >(std::__invoke_other, mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}, &&)",
        "source": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/bits/invoke.h:60",
        "file": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/bits/invoke.h",
        "line": 60,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "std::__invoke<mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}, >(mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}, &&)",
        "source": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/bits/invoke.h:95",
        "file": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/bits/invoke.h",
        "line": 95,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "_ZSt12__apply_implIZN7mozilla6detail23RunnableMethodArgumentsIJEE5applyINS0_17FFmpegDataDecoderILi53EEEMS6_F6RefPtrINS0_10MozPromiseI8nsTArrayIS7_INS0_9MediaDataEEENS0_11MediaResultELb1EEEEvEEEDcPT_T0_EUlDpOT_E_RSt5tupleIJEETpTnmJEEDcOSI_OSK_St16integer_sequenceImJXspT1_EEE",
        "source": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/tuple:1740",
        "file": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/tuple",
        "line": 1740,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "std::apply<mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}, std::tuple<>&>(mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())::{lambda(auto:1&&)#1}, std::tuple<>&)",
        "source": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/tuple:1751",
        "file": "/builds/worker/fetches/sysroot-x86_64-linux-gnu/usr/include/c++/10/tuple",
        "line": 1751,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "mozilla::detail::RunnableMethodArguments<>::apply<mozilla::FFmpegDataDecoder<53>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)()>(mozilla::FFmpegDataDecoder<53>*, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)())",
        "source": "xpcom/threads/nsThreadUtils.h:1081",
        "file": "xpcom/threads/nsThreadUtils.h",
        "line": 1081,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "mozilla::detail::MethodCall<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)(), mozilla::FFmpegDataDecoder<53>, >::Invoke()",
        "source": "xpcom/threads/MozPromise.h:1711",
        "file": "xpcom/threads/MozPromise.h",
        "line": 1711,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "libxul.so",
        "function": "mozilla::detail::ProxyRunnable<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true>, RefPtr<mozilla::MozPromise<nsTArray<RefPtr<mozilla::MediaData> >, mozilla::MediaResult, true> > (mozilla::FFmpegDataDecoder<53>::*)(), mozilla::FFmpegDataDecoder<53>, >::Run()",
        "source": "xpcom/threads/MozPromise.h:1731",
        "file": "xpcom/threads/MozPromise.h",
        "line": 1731,
        "trust": "cfi"
      },
      {
        "frame_index": 7,
        "module": "libxul.so",
        "function": "mozilla::TaskQueue::Runner::Run()",
        "source": "xpcom/threads/TaskQueue.cpp:263",
        "file": "xpcom/threads/TaskQueue.cpp",
        "line": 263,
        "trust": "cfi"
      },
      {
        "frame_index": 8,
        "module": "libxul.so",
        "function": "nsThreadPool::Run()",
        "source": "xpcom/threads/nsThreadPool.cpp:449",
        "file": "xpcom/threads/nsThreadPool.cpp",
        "line": 449,
        "trust": "cfi"
      },
      {
        "frame_index": 9,
        "module": "libxul.so",
        "function": "nsThread::ProcessNextEvent(bool, bool*)",
        "source": "xpcom/threads/nsThread.cpp:1160",
        "file": "xpcom/threads/nsThread.cpp",
        "line": 1160,
        "trust": "inlined"
      },
      {
        "frame_index": 9,
        "module": "libxul.so",
        "function": "NS_ProcessNextEvent(nsIThread*, bool)",
        "source": "xpcom/threads/nsThreadUtils.cpp:461",
        "file": "xpcom/threads/nsThreadUtils.cpp",
        "line": 461,
        "trust": "cfi"
      },
      {
        "frame_index": 10,
        "module": "libxul.so",
        "function": "mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*)",
        "source": "ipc/glue/MessagePump.cpp:299",
        "file": "ipc/glue/MessagePump.cpp",
        "line": 299,
        "trust": "cfi"
      },
      {
        "frame_index": 11,
        "module": "libxul.so",
        "function": "MessageLoop::RunInternal()",
        "source": "ipc/chromium/src/base/message_loop.cc:368",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 368,
        "trust": "inlined"
      },
      {
        "frame_index": 11,
        "module": "libxul.so",
        "function": "MessageLoop::RunHandler()",
        "source": "ipc/chromium/src/base/message_loop.cc:361",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 361,
        "trust": "inlined"
      },
      {
        "frame_index": 11,
        "module": "libxul.so",
        "function": "MessageLoop::Run()",
        "source": "ipc/chromium/src/base/message_loop.cc:343",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 343,
        "trust": "inlined"
      },
      {
        "frame_index": 11,
        "module": "libxul.so",
        "function": "nsThread::ThreadFunc(void*)",
        "source": "xpcom/threads/nsThread.cpp:375",
        "file": "xpcom/threads/nsThread.cpp",
        "line": 375,
        "trust": "cfi"
      },
      {
        "frame_index": 12,
        "module": "libnspr4.so",
        "function": "_pt_root",
        "source": "nsprpub/pr/src/pthreads/ptthread.c:191",
        "file": "nsprpub/pr/src/pthreads/ptthread.c",
        "line": 191,
        "trust": "cfi"
      },
      {
        "frame_index": 13,
        "module": "firefox-bin",
        "function": "set_alt_signal_stack_and_start(PthreadCreateParams*)",
        "source": "mozglue/interposers/pthread_create_interposer.cpp:81",
        "file": "mozglue/interposers/pthread_create_interposer.cpp",
        "line": 81,
        "trust": "cfi"
      },
      {
        "frame_index": 14,
        "module": "libc.so.6",
        "function": "start_thread",
        "source": "nptl/nptl/pthread_create.c:448",
        "file": "nptl/nptl/pthread_create.c",
        "line": 448,
        "trust": "cfi"
      },
      {
        "frame_index": 15,
        "module": "libc.so.6",
        "function": "__GI___clone",
        "source": "sysdeps/unix/sysv/linux/x86_64/clone.S:100",
        "file": "sysdeps/unix/sysv/linux/x86_64/clone.S",
        "line": 100,
        "trust": "cfi"
      }
    ],
    "frame_count": 30
  }
}