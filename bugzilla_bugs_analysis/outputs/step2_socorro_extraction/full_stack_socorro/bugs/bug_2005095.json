{
  "bug_id": "2005095",
  "summary": "Crash in [@ nsMaybeWeakPtrArray<T>::AppendWeakElement] with \"Element already in array.\"",
  "product": "Core",
  "component": "XPCOM",
  "creation_time": "2025-12-10T00:07:25Z",
  "crash_signatures": [
    "nsMaybeWeakPtrArray<T>::AppendWeakElement"
  ],
  "bugzilla_url": "https://bugzilla.mozilla.org/show_bug.cgi?id=2005095",
  "socorro_crash_ids": [
    "e5752c45-3c10-4b74-96e2-385f80251209"
  ],
  "stack_source": "socorro",
  "crash_id": "e5752c45-3c10-4b74-96e2-385f80251209",
  "socorro_metadata": {
    "signature": "",
    "crash_reason": "",
    "moz_crash_reason": "",
    "crashing_thread": {
      "index": 0,
      "name": "firefox-bin"
    }
  },
  "stack_trace": {
    "source": "socorro",
    "crash_id": "e5752c45-3c10-4b74-96e2-385f80251209",
    "frames": [
      {
        "frame_index": 0,
        "module": "libxul.so",
        "function": "MOZ_CrashSequence(void*, long)",
        "source": "mfbt/Assertions.h:237",
        "file": "mfbt/Assertions.h",
        "line": 237,
        "trust": "inlined"
      },
      {
        "frame_index": 0,
        "module": "libxul.so",
        "function": "nsMaybeWeakPtrArray<nsIObserver>::AppendWeakElement(nsIObserver*, bool)",
        "source": "xpcom/base/nsMaybeWeakPtr.h:90",
        "file": "xpcom/base/nsMaybeWeakPtr.h",
        "line": 90,
        "trust": "inlined"
      },
      {
        "frame_index": 0,
        "module": "libxul.so",
        "function": "nsObserverList::AddObserver(nsIObserver*, bool)",
        "source": "xpcom/ds/nsObserverList.cpp:16",
        "file": "xpcom/ds/nsObserverList.cpp",
        "line": 16,
        "trust": "inlined"
      },
      {
        "frame_index": 0,
        "module": "libxul.so",
        "function": "nsObserverService::AddObserver(nsIObserver*, char const*, bool)",
        "source": "xpcom/ds/nsObserverService.cpp:223",
        "file": "xpcom/ds/nsObserverService.cpp",
        "line": 223,
        "trust": "context"
      },
      {
        "frame_index": 1,
        "module": "libxul.so",
        "function": "NS_InvokeByIndex",
        "source": "",
        "file": "",
        "line": null,
        "trust": "cfi"
      },
      {
        "frame_index": 2,
        "module": "libxul.so",
        "function": "CallMethodHelper::Invoke()",
        "source": "js/xpconnect/src/XPCWrappedNative.cpp:1619",
        "file": "js/xpconnect/src/XPCWrappedNative.cpp",
        "line": 1619,
        "trust": "inlined"
      },
      {
        "frame_index": 2,
        "module": "libxul.so",
        "function": "CallMethodHelper::Call()",
        "source": "js/xpconnect/src/XPCWrappedNative.cpp:1173",
        "file": "js/xpconnect/src/XPCWrappedNative.cpp",
        "line": 1173,
        "trust": "inlined"
      },
      {
        "frame_index": 2,
        "module": "libxul.so",
        "function": "XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode)",
        "source": "js/xpconnect/src/XPCWrappedNative.cpp:1119",
        "file": "js/xpconnect/src/XPCWrappedNative.cpp",
        "line": 1119,
        "trust": "cfi"
      },
      {
        "frame_index": 3,
        "module": "libxul.so",
        "function": "XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*)",
        "source": "js/xpconnect/src/XPCWrappedNativeJSOps.cpp:966",
        "file": "js/xpconnect/src/XPCWrappedNativeJSOps.cpp",
        "line": 966,
        "trust": "cfi"
      },
      {
        "frame_index": 4,
        "module": "libxul.so",
        "function": "CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::CallReason, JS::CallArgs const&)",
        "source": "js/src/vm/Interpreter.cpp:490",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 490,
        "trust": "inlined"
      },
      {
        "frame_index": 4,
        "module": "libxul.so",
        "function": "js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:586",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 586,
        "trust": "inlined"
      },
      {
        "frame_index": 4,
        "module": "libxul.so",
        "function": "InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:653",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 653,
        "trust": "inlined"
      },
      {
        "frame_index": 4,
        "module": "libxul.so",
        "function": "js::CallFromStack(JSContext*, JS::CallArgs const&, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:658",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 658,
        "trust": "inlined"
      },
      {
        "frame_index": 4,
        "module": "libxul.so",
        "function": "js::Interpret(JSContext*, js::RunState&)",
        "source": "js/src/vm/Interpreter.cpp:3272",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 3272,
        "trust": "cfi"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "MaybeEnterInterpreterTrampoline(JSContext*, js::RunState&)",
        "source": "js/src/vm/Interpreter.cpp:384",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 384,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "js::RunScript(JSContext*, js::RunState&)",
        "source": "js/src/vm/Interpreter.cpp:460",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 460,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:618",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 618,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:653",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 653,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "js::CallFromStack(JSContext*, JS::CallArgs const&, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:658",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 658,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "libxul.so",
        "function": "js::jit::DoCallFallback(JSContext*, js::jit::BaselineFrame*, js::jit::ICFallbackStub*, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>)",
        "source": "js/src/jit/BaselineIC.cpp:1698",
        "file": "js/src/jit/BaselineIC.cpp",
        "line": 1698,
        "trust": "cfi"
      },
      {
        "frame_index": 10,
        "module": "libxul.so",
        "function": "EnterBaseline(JSContext*, EnterJitData&)",
        "source": "js/src/jit/BaselineJIT.cpp:147",
        "file": "js/src/jit/BaselineJIT.cpp",
        "line": 147,
        "trust": "inlined"
      },
      {
        "frame_index": 10,
        "module": "libxul.so",
        "function": "js::jit::EnterBaselineInterpreterAtBranch(JSContext*, js::InterpreterFrame*, unsigned char*)",
        "source": "js/src/jit/BaselineJIT.cpp:202",
        "file": "js/src/jit/BaselineJIT.cpp",
        "line": 202,
        "trust": "frame_pointer"
      },
      {
        "frame_index": 11,
        "module": "libxul.so",
        "function": "js::Interpret(JSContext*, js::RunState&)",
        "source": "js/src/vm/Interpreter.cpp:2032",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 2032,
        "trust": "cfi"
      },
      {
        "frame_index": 12,
        "module": "libxul.so",
        "function": "MaybeEnterInterpreterTrampoline(JSContext*, js::RunState&)",
        "source": "js/src/vm/Interpreter.cpp:384",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 384,
        "trust": "inlined"
      },
      {
        "frame_index": 12,
        "module": "libxul.so",
        "function": "js::RunScript(JSContext*, js::RunState&)",
        "source": "js/src/vm/Interpreter.cpp:460",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 460,
        "trust": "inlined"
      },
      {
        "frame_index": 12,
        "module": "libxul.so",
        "function": "js::InternalCallOrConstruct(JSContext*, JS::CallArgs const&, js::MaybeConstruct, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:618",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 618,
        "trust": "inlined"
      },
      {
        "frame_index": 12,
        "module": "libxul.so",
        "function": "InternalCall(JSContext*, js::AnyInvokeArgs const&, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:653",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 653,
        "trust": "inlined"
      },
      {
        "frame_index": 12,
        "module": "libxul.so",
        "function": "js::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>, js::CallReason)",
        "source": "js/src/vm/Interpreter.cpp:685",
        "file": "js/src/vm/Interpreter.cpp",
        "line": 685,
        "trust": "cfi"
      },
      {
        "frame_index": 13,
        "module": "libxul.so",
        "function": "js::CallSelfHostedFunction(JSContext*, JS::Handle<js::PropertyName*>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>)",
        "source": "js/src/vm/SelfHosting.cpp:1223",
        "file": "js/src/vm/SelfHosting.cpp",
        "line": 1223,
        "trust": "inlined"
      },
      {
        "frame_index": 13,
        "module": "libxul.so",
        "function": "AsyncFunctionResume(JSContext*, JS::Handle<js::AsyncFunctionGeneratorObject*>, ResumeKind, JS::Handle<JS::Value>)",
        "source": "js/src/vm/AsyncFunction.cpp:157",
        "file": "js/src/vm/AsyncFunction.cpp",
        "line": 157,
        "trust": "cfi"
      },
      {
        "frame_index": 14,
        "module": "libxul.so",
        "function": "AsyncFunctionPromiseReactionJob(JSContext*, JS::Handle<PromiseReactionRecord*>)",
        "source": "js/src/builtin/Promise.cpp",
        "file": "",
        "line": null,
        "trust": "inlined"
      },
      {
        "frame_index": 14,
        "module": "libxul.so",
        "function": "PromiseReactionJob(JSContext*, JS::Handle<JSObject*>)",
        "source": "js/src/builtin/Promise.cpp:2567",
        "file": "js/src/builtin/Promise.cpp",
        "line": 2567,
        "trust": "cfi"
      },
      {
        "frame_index": 15,
        "module": "libxul.so",
        "function": "JS::RunJSMicroTask(JSContext*, JS::Handle<JSObject*>)",
        "source": "js/src/builtin/Promise.cpp:7661",
        "file": "js/src/builtin/Promise.cpp",
        "line": 7661,
        "trust": "inlined"
      },
      {
        "frame_index": 15,
        "module": "libxul.so",
        "function": "mozilla::MustConsumeMicroTask::RunAndConsumeJSMicroTask(JSContext*)",
        "source": "xpcom/base/CycleCollectedJSContext.h:252",
        "file": "xpcom/base/CycleCollectedJSContext.h",
        "line": 252,
        "trust": "inlined"
      },
      {
        "frame_index": 15,
        "module": "libxul.so",
        "function": "mozilla::RunMicroTask(JSContext*, JS::MutableHandle<mozilla::MustConsumeMicroTask>)",
        "source": "xpcom/base/CycleCollectedJSContext.cpp:1102",
        "file": "xpcom/base/CycleCollectedJSContext.cpp",
        "line": 1102,
        "trust": "cfi"
      },
      {
        "frame_index": 16,
        "module": "libxul.so",
        "function": "mozilla::CycleCollectedJSContext::PerformMicroTaskCheckPoint(bool)",
        "source": "xpcom/base/CycleCollectedJSContext.cpp:1252",
        "file": "xpcom/base/CycleCollectedJSContext.cpp",
        "line": 1252,
        "trust": "inlined"
      },
      {
        "frame_index": 16,
        "module": "libxul.so",
        "function": "mozilla::CycleCollectedJSContext::AfterProcessTask(unsigned int)",
        "source": "xpcom/base/CycleCollectedJSContext.cpp:741",
        "file": "xpcom/base/CycleCollectedJSContext.cpp",
        "line": 741,
        "trust": "cfi"
      },
      {
        "frame_index": 17,
        "module": "libxul.so",
        "function": "XPCJSContext::AfterProcessTask(unsigned int)",
        "source": "js/xpconnect/src/XPCJSContext.cpp:1535",
        "file": "js/xpconnect/src/XPCJSContext.cpp",
        "line": 1535,
        "trust": "inlined"
      },
      {
        "frame_index": 17,
        "module": "libxul.so",
        "function": "nsThread::ProcessNextEvent(bool, bool*)",
        "source": "xpcom/threads/nsThread.cpp:1220",
        "file": "xpcom/threads/nsThread.cpp",
        "line": 1220,
        "trust": "inlined"
      },
      {
        "frame_index": 17,
        "module": "libxul.so",
        "function": "NS_ProcessNextEvent(nsIThread*, bool)",
        "source": "xpcom/threads/nsThreadUtils.cpp:461",
        "file": "xpcom/threads/nsThreadUtils.cpp",
        "line": 461,
        "trust": "cfi"
      },
      {
        "frame_index": 18,
        "module": "libxul.so",
        "function": "mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)",
        "source": "ipc/glue/MessagePump.cpp:85",
        "file": "ipc/glue/MessagePump.cpp",
        "line": 85,
        "trust": "cfi"
      },
      {
        "frame_index": 19,
        "module": "libxul.so",
        "function": "MessageLoop::RunInternal()",
        "source": "ipc/chromium/src/base/message_loop.cc:368",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 368,
        "trust": "inlined"
      },
      {
        "frame_index": 19,
        "module": "libxul.so",
        "function": "MessageLoop::RunHandler()",
        "source": "ipc/chromium/src/base/message_loop.cc:361",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 361,
        "trust": "inlined"
      },
      {
        "frame_index": 19,
        "module": "libxul.so",
        "function": "MessageLoop::Run()",
        "source": "ipc/chromium/src/base/message_loop.cc:343",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 343,
        "trust": "inlined"
      },
      {
        "frame_index": 19,
        "module": "libxul.so",
        "function": "nsBaseAppShell::Run()",
        "source": "widget/nsBaseAppShell.cpp:152",
        "file": "widget/nsBaseAppShell.cpp",
        "line": 152,
        "trust": "cfi"
      },
      {
        "frame_index": 20,
        "module": "libxul.so",
        "function": "nsAppShell::Run()",
        "source": "widget/gtk/nsAppShell.cpp:555",
        "file": "widget/gtk/nsAppShell.cpp",
        "line": 555,
        "trust": "cfi"
      },
      {
        "frame_index": 21,
        "module": "libxul.so",
        "function": "nsAppStartup::Run()",
        "source": "toolkit/components/startup/nsAppStartup.cpp:290",
        "file": "toolkit/components/startup/nsAppStartup.cpp",
        "line": 290,
        "trust": "cfi"
      },
      {
        "frame_index": 22,
        "module": "libxul.so",
        "function": "XREMain::XRE_mainRun()",
        "source": "toolkit/xre/nsAppRunner.cpp:5918",
        "file": "toolkit/xre/nsAppRunner.cpp",
        "line": 5918,
        "trust": "cfi"
      },
      {
        "frame_index": 23,
        "module": "libxul.so",
        "function": "XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&)",
        "source": "toolkit/xre/nsAppRunner.cpp:6173",
        "file": "toolkit/xre/nsAppRunner.cpp",
        "line": 6173,
        "trust": "cfi"
      },
      {
        "frame_index": 24,
        "module": "libxul.so",
        "function": "XRE_main(int, char**, mozilla::BootstrapConfig const&)",
        "source": "toolkit/xre/nsAppRunner.cpp:6246",
        "file": "toolkit/xre/nsAppRunner.cpp",
        "line": 6246,
        "trust": "cfi"
      },
      {
        "frame_index": 25,
        "module": "firefox-bin",
        "function": "do_main(int, char**, char**)",
        "source": "browser/app/nsBrowserApp.cpp:268",
        "file": "browser/app/nsBrowserApp.cpp",
        "line": 268,
        "trust": "inlined"
      },
      {
        "frame_index": 25,
        "module": "firefox-bin",
        "function": "main",
        "source": "browser/app/nsBrowserApp.cpp:532",
        "file": "browser/app/nsBrowserApp.cpp",
        "line": 532,
        "trust": "cfi"
      },
      {
        "frame_index": 29,
        "module": "firefox-bin",
        "function": "mozilla::PrintfTarget::cvt_ll(long, int, int, int, int, int, char const*)",
        "source": "mozglue/misc/Printf.cpp",
        "file": "",
        "line": null,
        "trust": "inlined"
      },
      {
        "frame_index": 29,
        "module": "firefox-bin",
        "function": "mozilla::PrintfTarget::appendIntDec(long)",
        "source": "mozglue/misc/Printf.cpp:217",
        "file": "mozglue/misc/Printf.cpp",
        "line": 217,
        "trust": "scan"
      },
      {
        "frame_index": 30,
        "module": "firefox-bin",
        "function": "_start",
        "source": "",
        "file": "",
        "line": null,
        "trust": "cfi"
      }
    ],
    "frame_count": 55
  }
}