{
  "bug_id": "1992536",
  "summary": "Crash in [@ mozilla::net::CookieServiceParent::SetCookies]",
  "product": "Core",
  "component": "DOM: Networking",
  "creation_time": "2025-10-04T00:41:01Z",
  "crash_signatures": [
    "mozilla::net::CookieServiceParent::SetCookies"
  ],
  "bugzilla_url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1992536",
  "socorro_crash_ids": [
    "aafa2193-4d06-4cfb-8d44-ef6bb0250919"
  ],
  "stack_source": "socorro",
  "crash_id": "aafa2193-4d06-4cfb-8d44-ef6bb0250919",
  "socorro_metadata": {
    "signature": "",
    "crash_reason": "",
    "moz_crash_reason": "",
    "crashing_thread": {
      "index": 0,
      "name": "MainThread"
    }
  },
  "stack_trace": {
    "source": "socorro",
    "crash_id": "aafa2193-4d06-4cfb-8d44-ef6bb0250919",
    "frames": [
      {
        "frame_index": 0,
        "module": "xul.dll",
        "function": "mozilla::net::CookieServiceParent::SetCookies(nsTString<char> const&, mozilla::OriginAttributes const&, nsIURI*, bool, bool, nsTArray<mozilla::net::CookieStruct> const&, mozilla::dom::BrowsingContext*)",
        "source": "netwerk/cookie/CookieServiceParent.cpp:345",
        "file": "netwerk/cookie/CookieServiceParent.cpp",
        "line": 345,
        "trust": "context"
      },
      {
        "frame_index": 1,
        "module": "xul.dll",
        "function": "mozilla::dom::WindowGlobalParent::RecvSetCookies(nsTString<char> const&, mozilla::OriginAttributes const&, nsIURI*, bool, bool, nsTArray<mozilla::net::CookieStruct> const&)",
        "source": "dom/ipc/WindowGlobalParent.cpp:1807",
        "file": "dom/ipc/WindowGlobalParent.cpp",
        "line": 1807,
        "trust": "cfi"
      },
      {
        "frame_index": 2,
        "module": "xul.dll",
        "function": "mozilla::dom::PWindowGlobalParent::OnMessageReceived(IPC::Message const&)",
        "source": "ipc/ipdl/PWindowGlobalParent.cpp:2131",
        "file": "ipc/ipdl/PWindowGlobalParent.cpp",
        "line": 2131,
        "trust": "cfi"
      },
      {
        "frame_index": 3,
        "module": "xul.dll",
        "function": "mozilla::dom::PContentParent::OnMessageReceived(IPC::Message const&)",
        "source": "ipc/ipdl/PContentParent.cpp:6523",
        "file": "ipc/ipdl/PContentParent.cpp",
        "line": 6523,
        "trust": "cfi"
      },
      {
        "frame_index": 4,
        "module": "xul.dll",
        "function": "mozilla::ipc::MessageChannel::DispatchAsyncMessage(mozilla::ipc::ActorLifecycleProxy*, IPC::Message const&)",
        "source": "ipc/glue/MessageChannel.cpp:1797",
        "file": "ipc/glue/MessageChannel.cpp",
        "line": 1797,
        "trust": "inlined"
      },
      {
        "frame_index": 4,
        "module": "xul.dll",
        "function": "mozilla::ipc::MessageChannel::DispatchMessage(mozilla::ipc::ActorLifecycleProxy*, std::unique_ptr<IPC::Message, std::default_delete<IPC::Message> >)",
        "source": "ipc/glue/MessageChannel.cpp:1723",
        "file": "ipc/glue/MessageChannel.cpp",
        "line": 1723,
        "trust": "inlined"
      },
      {
        "frame_index": 4,
        "module": "xul.dll",
        "function": "mozilla::ipc::MessageChannel::RunMessage(mozilla::ipc::ActorLifecycleProxy*, mozilla::ipc::MessageChannel::MessageTask&)",
        "source": "ipc/glue/MessageChannel.cpp:1512",
        "file": "ipc/glue/MessageChannel.cpp",
        "line": 1512,
        "trust": "cfi"
      },
      {
        "frame_index": 5,
        "module": "xul.dll",
        "function": "mozilla::ipc::MessageChannel::MessageTask::Run()",
        "source": "ipc/glue/MessageChannel.cpp:1614",
        "file": "ipc/glue/MessageChannel.cpp",
        "line": 1614,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "xul.dll",
        "function": "mozilla::RunnableTask::Run()",
        "source": "xpcom/threads/TaskController.cpp:705",
        "file": "xpcom/threads/TaskController.cpp",
        "line": 705,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "xul.dll",
        "function": "mozilla::TaskController::RunTask(mozilla::Task*)",
        "source": "xpcom/threads/TaskController.cpp:196",
        "file": "xpcom/threads/TaskController.cpp",
        "line": 196,
        "trust": "inlined"
      },
      {
        "frame_index": 5,
        "module": "xul.dll",
        "function": "mozilla::TaskController::DoExecuteNextTaskOnlyMainThreadInternal(mozilla::detail::BaseAutoLock<mozilla::Mutex&> const&)",
        "source": "xpcom/threads/TaskController.cpp:1325",
        "file": "xpcom/threads/TaskController.cpp",
        "line": 1325,
        "trust": "cfi"
      },
      {
        "frame_index": 6,
        "module": "xul.dll",
        "function": "mozilla::TaskController::ExecuteNextTaskOnlyMainThreadInternal(mozilla::detail::BaseAutoLock<mozilla::Mutex&> const&)",
        "source": "xpcom/threads/TaskController.cpp:1148",
        "file": "xpcom/threads/TaskController.cpp",
        "line": 1148,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "xul.dll",
        "function": "mozilla::TaskController::ProcessPendingMTTask(bool)",
        "source": "xpcom/threads/TaskController.cpp:641",
        "file": "xpcom/threads/TaskController.cpp",
        "line": 641,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "xul.dll",
        "function": "mozilla::TaskController::TaskController::<lambda_6>::operator()() const",
        "source": "xpcom/threads/TaskController.cpp:333",
        "file": "xpcom/threads/TaskController.cpp",
        "line": 333,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "xul.dll",
        "function": "mozilla::detail::RunnableFunction<`lambda at /builds/worker/checkouts/gecko/xpcom/threads/TaskController.cpp:333:7'>::Run()",
        "source": "xpcom/threads/nsThreadUtils.h:549",
        "file": "xpcom/threads/nsThreadUtils.h",
        "line": 549,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "xul.dll",
        "function": "nsThread::ProcessNextEvent(bool, bool*)",
        "source": "xpcom/threads/nsThread.cpp:1157",
        "file": "xpcom/threads/nsThread.cpp",
        "line": 1157,
        "trust": "inlined"
      },
      {
        "frame_index": 6,
        "module": "xul.dll",
        "function": "NS_ProcessNextEvent(nsIThread*, bool)",
        "source": "xpcom/threads/nsThreadUtils.cpp:462",
        "file": "xpcom/threads/nsThreadUtils.cpp",
        "line": 462,
        "trust": "cfi"
      },
      {
        "frame_index": 7,
        "module": "xul.dll",
        "function": "mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)",
        "source": "ipc/glue/MessagePump.cpp:85",
        "file": "ipc/glue/MessagePump.cpp",
        "line": 85,
        "trust": "cfi"
      },
      {
        "frame_index": 8,
        "module": "xul.dll",
        "function": "MessageLoop::RunInternal()",
        "source": "ipc/chromium/src/base/message_loop.cc:373",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 373,
        "trust": "inlined"
      },
      {
        "frame_index": 8,
        "module": "xul.dll",
        "function": "MessageLoop::RunHandler()",
        "source": "ipc/chromium/src/base/message_loop.cc:366",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 366,
        "trust": "cfi"
      },
      {
        "frame_index": 9,
        "module": "xul.dll",
        "function": "MessageLoop::Run()",
        "source": "ipc/chromium/src/base/message_loop.cc:348",
        "file": "ipc/chromium/src/base/message_loop.cc",
        "line": 348,
        "trust": "inlined"
      },
      {
        "frame_index": 9,
        "module": "xul.dll",
        "function": "nsBaseAppShell::Run()",
        "source": "widget/nsBaseAppShell.cpp:148",
        "file": "widget/nsBaseAppShell.cpp",
        "line": 148,
        "trust": "cfi"
      },
      {
        "frame_index": 10,
        "module": "xul.dll",
        "function": "nsAppShell::Run()",
        "source": "widget/windows/nsAppShell.cpp:673",
        "file": "widget/windows/nsAppShell.cpp",
        "line": 673,
        "trust": "cfi"
      },
      {
        "frame_index": 11,
        "module": "xul.dll",
        "function": "nsAppStartup::Run()",
        "source": "toolkit/components/startup/nsAppStartup.cpp:291",
        "file": "toolkit/components/startup/nsAppStartup.cpp",
        "line": 291,
        "trust": "cfi"
      },
      {
        "frame_index": 12,
        "module": "xul.dll",
        "function": "XREMain::XRE_mainRun()",
        "source": "toolkit/xre/nsAppRunner.cpp:5889",
        "file": "toolkit/xre/nsAppRunner.cpp",
        "line": 5889,
        "trust": "cfi"
      },
      {
        "frame_index": 13,
        "module": "xul.dll",
        "function": "XREMain::XRE_main(int, char**, mozilla::BootstrapConfig const&)",
        "source": "toolkit/xre/nsAppRunner.cpp:6145",
        "file": "toolkit/xre/nsAppRunner.cpp",
        "line": 6145,
        "trust": "cfi"
      },
      {
        "frame_index": 14,
        "module": "xul.dll",
        "function": "XRE_main(int, char**, mozilla::BootstrapConfig const&)",
        "source": "toolkit/xre/nsAppRunner.cpp:6218",
        "file": "toolkit/xre/nsAppRunner.cpp",
        "line": 6218,
        "trust": "cfi"
      },
      {
        "frame_index": 15,
        "module": "firefox.exe",
        "function": "do_main(int, char**, char**)",
        "source": "browser/app/nsBrowserApp.cpp:229",
        "file": "browser/app/nsBrowserApp.cpp",
        "line": 229,
        "trust": "inlined"
      },
      {
        "frame_index": 15,
        "module": "firefox.exe",
        "function": "NS_internal_main(int, char**, char**)",
        "source": "browser/app/nsBrowserApp.cpp:487",
        "file": "browser/app/nsBrowserApp.cpp",
        "line": 487,
        "trust": "inlined"
      },
      {
        "frame_index": 15,
        "module": "firefox.exe",
        "function": "wmain(int, wchar_t**)",
        "source": "toolkit/xre/nsWindowsWMain.cpp:150",
        "file": "toolkit/xre/nsWindowsWMain.cpp",
        "line": 150,
        "trust": "cfi"
      },
      {
        "frame_index": 16,
        "module": "firefox.exe",
        "function": "invoke_main()",
        "source": "/builds/worker/workspace/obj-build/browser/app/D:/a/_work/1/s/src/vctools/crt/vcstartup/src/startup/exe_common.inl:90",
        "file": "/builds/worker/workspace/obj-build/browser/app/D:/a/_work/1/s/src/vctools/crt/vcstartup/src/startup/exe_common.inl",
        "line": 90,
        "trust": "inlined"
      },
      {
        "frame_index": 16,
        "module": "firefox.exe",
        "function": "__scrt_common_main_seh()",
        "source": "/builds/worker/workspace/obj-build/browser/app/D:/a/_work/1/s/src/vctools/crt/vcstartup/src/startup/exe_common.inl:288",
        "file": "/builds/worker/workspace/obj-build/browser/app/D:/a/_work/1/s/src/vctools/crt/vcstartup/src/startup/exe_common.inl",
        "line": 288,
        "trust": "cfi"
      },
      {
        "frame_index": 17,
        "module": "kernel32.dll",
        "function": "BaseThreadInitThunk",
        "source": "",
        "file": "",
        "line": null,
        "trust": "cfi"
      },
      {
        "frame_index": 18,
        "module": "ntdll.dll",
        "function": "RtlUserThreadStart",
        "source": "",
        "file": "",
        "line": null,
        "trust": "cfi"
      }
    ],
    "frame_count": 34
  },
  "regressed_by": [
    "1982261"
  ],
  "regressor_count": 1,
  "source": "step2",
  "bugzilla_status": "RESOLVED",
  "bugzilla_resolution": "FIXED",
  "bugzilla_lookup_timestamp": "2025-12-15T15:53:28.605714",
  "fixing_commit_count": 1,
  "category": "single_commit",
  "commit_source": "local",
  "fixing_commit": {
    "commit_hash": "fe6e63a2f9141d9eeec41bfde52cc34b33c170fe",
    "short_hash": "fe6e63a2f914",
    "description": "Bug 1992536 - Use cookie creation time instead or PR_Now() to validate the expiration time, r=valentin,cookie-reviewers",
    "author": "Andrea Marchesini <amarchesini@mozilla.com>",
    "pushdate": "2025-10-09 14:54 +0000",
    "files": [
      "netwerk/cookie/CookieCommons.cpp",
      "netwerk/cookie/CookieCommons.h",
      "netwerk/cookie/CookieParser.cpp",
      "netwerk/cookie/CookieParser.h",
      "netwerk/cookie/CookieService.cpp",
      "netwerk/cookie/CookieValidation.cpp"
    ],
    "file_count": 6,
    "components": []
  },
  "regressor_analysis": [
    {
      "regressor_bug_id": "1982261",
      "total_commits": 2,
      "matching_commits_count": 2,
      "matching_commits": [
        {
          "commit_hash": "05d9c3f0147288e19525104a250b23f2de1339aa",
          "short_hash": "05d9c3f01472",
          "description": "Bug 1982261 - CookieServiceParent logs about invalid cookies instead of crashing, r=valentin,cookie-reviewers",
          "author": "Andrea Marchesini <amarchesini@mozilla.com>",
          "pushdate": "2025-09-16 10:40 +0000",
          "files_modified": [
            "netwerk/cookie/CookieService.cpp",
            "netwerk/cookie/CookieService.h",
            "netwerk/cookie/CookieServiceParent.cpp"
          ],
          "file_overlap_count": 1,
          "overlapping_files": [
            "netwerk/cookie/CookieService.cpp"
          ],
          "components": []
        },
        {
          "commit_hash": "b2c86eba88a348fb99ed75b0c1aed59848c0d451",
          "short_hash": "b2c86eba88a3",
          "description": "Bug 1982261 - CookieServiceParent logs about invalid cookies instead of crashing,  a=dmeehan DONTBUILD",
          "author": "Andrea Marchesini <amarchesini@mozilla.com>",
          "pushdate": "2025-09-17 17:41 +0000",
          "files_modified": [
            "netwerk/cookie/CookieService.cpp",
            "netwerk/cookie/CookieService.h",
            "netwerk/cookie/CookieServiceParent.cpp"
          ],
          "file_overlap_count": 1,
          "overlapping_files": [
            "netwerk/cookie/CookieService.cpp"
          ],
          "components": []
        }
      ],
      "commit_source": "local"
    }
  ],
  "total_matching_regressor_commits": 2
}