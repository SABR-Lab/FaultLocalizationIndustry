# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: third_party/rust/error-support-macros/src/argument.rs
# Commit: 2147c5c81edf
# Full Hash: 2147c5c81edf9cd56c19e7e92dfebfcd77329978
# Author: Ryan VanderMeulen <ryanvm@gmail.com>
# Date: 2023-03-01 17:52 -0500
# Description:
#   Backed out changesets b05343a5b533 and 57b2cda7e0db (bug 1818349) for causing bug 1819723.
# ==============================================================================

diff -r d59b76766f0d -r 2147c5c81edf third_party/rust/error-support-macros/src/argument.rs
--- a/third_party/rust/error-support-macros/src/argument.rs	Wed Mar 01 05:53:30 2023 +0000
+++ b/third_party/rust/error-support-macros/src/argument.rs	Wed Mar 01 17:52:01 2023 -0500
@@ -2,20 +2,16 @@
  * License, v. 2.0. If a copy of the MPL was not distributed with this
  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
 
-use syn::spanned::Spanned;
-
-const ERR_MSG: &str = "Expected #[handle_error(path::to::Error)]";
-
-/// Returns the path to the type of the "internal" error.
-pub(crate) fn validate(arguments: &syn::AttributeArgs) -> syn::Result<&syn::Path> {
-    if arguments.len() != 1 {
-        return Err(syn::Error::new(proc_macro2::Span::call_site(), ERR_MSG));
+pub(crate) fn validate(arguments: &syn::AttributeArgs) -> syn::Result<()> {
+    // For now we validate that there are no arguments.
+    // if we want to improve the macro to support attributes, for example,
+    // if we'd like to pass in the return type of the body we can modify this
+    // logic to parse and return the type.
+    if !arguments.is_empty() {
+        return Err(syn::Error::new(
+            proc_macro2::Span::call_site(),
+            "Expected #[handle_error] with no arguments",
+        ));
     }
-
-    let nested_meta = arguments.iter().next().unwrap();
-    if let syn::NestedMeta::Meta(syn::Meta::Path(path)) = nested_meta {
-        Ok(path)
-    } else {
-        Err(syn::Error::new(nested_meta.span(), ERR_MSG))
-    }
+    Ok(())
 }