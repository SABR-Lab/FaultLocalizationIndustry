# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: third_party/rust/error-support-macros/src/argument.rs
# Commit: 3326192e8db6
# Full Hash: 3326192e8db60772cb3d6a0f7987dc093c8ef35a
# Author: Sammy Khamis <skhamis@mozilla.com>
# Date: 2023-03-07 16:07:33
# Regressor Bug: 1818349
# File Overlap Count: 23
# Overlapping Files: third_party/rust/sync15/src/client/coll_update.rs, third_party/rust/sync15/src/client/mod.rs, third_party/rust/sync15/.cargo-checksum.json, third_party/rust/sync15/src/client/sync.rs, Cargo.toml
# Description:
#   Bug 1818349 Part 1: Vendor new version of application-services r=markh
#   
#   Differential Revision: https://phabricator.services.mozilla.com/D171181
# ==============================================================================

diff -r d7be17cdae33 -r 3326192e8db6 third_party/rust/error-support-macros/src/argument.rs
--- a/third_party/rust/error-support-macros/src/argument.rs	Tue Mar 07 06:59:50 2023 +0000
+++ b/third_party/rust/error-support-macros/src/argument.rs	Tue Mar 07 07:42:14 2023 +0000
@@ -2,16 +2,20 @@
  * License, v. 2.0. If a copy of the MPL was not distributed with this
  * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
 
-pub(crate) fn validate(arguments: &syn::AttributeArgs) -> syn::Result<()> {
-    // For now we validate that there are no arguments.
-    // if we want to improve the macro to support attributes, for example,
-    // if we'd like to pass in the return type of the body we can modify this
-    // logic to parse and return the type.
-    if !arguments.is_empty() {
-        return Err(syn::Error::new(
-            proc_macro2::Span::call_site(),
-            "Expected #[handle_error] with no arguments",
-        ));
+use syn::spanned::Spanned;
+
+const ERR_MSG: &str = "Expected #[handle_error(path::to::Error)]";
+
+/// Returns the path to the type of the "internal" error.
+pub(crate) fn validate(arguments: &syn::AttributeArgs) -> syn::Result<&syn::Path> {
+    if arguments.len() != 1 {
+        return Err(syn::Error::new(proc_macro2::Span::call_site(), ERR_MSG));
     }
-    Ok(())
+
+    let nested_meta = arguments.iter().next().unwrap();
+    if let syn::NestedMeta::Meta(syn::Meta::Path(path)) = nested_meta {
+        Ok(path)
+    } else {
+        Err(syn::Error::new(nested_meta.span(), ERR_MSG))
+    }
 }