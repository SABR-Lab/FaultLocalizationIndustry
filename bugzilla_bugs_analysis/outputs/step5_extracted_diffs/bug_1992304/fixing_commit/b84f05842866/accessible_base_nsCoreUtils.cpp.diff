# ==============================================================================
# FIXING COMMIT DIFF
# ==============================================================================
# File: accessible/base/nsCoreUtils.cpp
# Commit: b84f05842866
# Full Hash: b84f0584286648310ed281a7e46de3e30d611692
# Author: Eitan Isaacson <eitan@monotonous.org>
# Date: 2025-10-06 21:18 +0000
# Description:
#   Bug 1992304 - Check for AnchorPosReferences property before using it. r=morgan
# ==============================================================================

diff -r 2f326bbc1394 -r b84f05842866 accessible/base/nsCoreUtils.cpp
--- a/accessible/base/nsCoreUtils.cpp	Mon Oct 06 21:14:15 2025 +0000
+++ b/accessible/base/nsCoreUtils.cpp	Mon Oct 06 21:18:12 2025 +0000
@@ -725,6 +725,12 @@
         // from anchor to positioned frame.
         const auto* referencedAnchors =
             frame->GetProperty(nsIFrame::AnchorPosReferences());
+        if (!referencedAnchors) {
+          // Depending on where we are in the reflow, this property may or may
+          // not be set. If it isn't set, a future reflow will set it, so we can
+          // just skip this frame for now.
+          continue;
+        }
         const auto* data = referencedAnchors->Lookup(name.AsAtom());
         if (data && *data && data->ref().mOrigin) {
           if (aAnchorFrame ==