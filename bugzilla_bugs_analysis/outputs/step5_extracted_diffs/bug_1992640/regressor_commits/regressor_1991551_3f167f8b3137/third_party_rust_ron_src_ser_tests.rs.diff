# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: third_party/rust/ron/src/ser/tests.rs
# Commit: 3f167f8b3137
# Full Hash: 3f167f8b313749f50f135e189e5854bef7ac0c73
# Author: Erich Gubler <erichdongubler@gmail.com>
# Date: 2025-10-03 18:08 +0000
# Regressor Bug: 1991551
# File Overlap Count: 23
# Overlapping Files: third_party/rust/wgpu-hal/Cargo.toml, supply-chain/audits.toml, third_party/rust/naga/src/back/spv/writer.rs, third_party/rust/naga/src/back/msl/writer.rs, third_party/rust/wgpu-types/src/lib.rs
# Description:
#   Bug 1991551 - build(webgpu): update WGPU to 8c4aebc0c1b75e3f7412dfc180745a0717fc30ec r=webgpu-reviewers,supply-chain-reviewers,nical
# ==============================================================================

diff -r 823439f307a0 -r 3f167f8b3137 third_party/rust/ron/src/ser/tests.rs
--- a/third_party/rust/ron/src/ser/tests.rs	Fri Oct 03 18:01:30 2025 +0000
+++ b/third_party/rust/ron/src/ser/tests.rs	Fri Oct 03 18:08:29 2025 +0000
@@ -1,3 +1,5 @@
+use alloc::{format, vec};
+
 use serde_derive::Serialize;
 
 use crate::Number;
@@ -99,7 +101,7 @@
 
 #[test]
 fn test_map() {
-    use std::collections::BTreeMap;
+    use alloc::collections::BTreeMap;
 
     let mut map = BTreeMap::new();
     map.insert((true, false), 4);
@@ -221,9 +223,9 @@
     test_min_max! { i128, u128 }
 }
 
-fn check_ser_any_number<T: Copy + Into<Number> + std::fmt::Display + serde::Serialize>(n: T) {
+fn check_ser_any_number<T: Copy + Into<Number> + core::fmt::Display + serde::Serialize>(n: T) {
     let mut fmt = format!("{}", n);
-    if !fmt.contains('.') && std::any::type_name::<T>().contains('f') {
+    if !fmt.contains('.') && core::any::type_name::<T>().contains('f') {
         fmt.push_str(".0");
     }
 
@@ -289,18 +291,21 @@
     .unwrap();
     assert_eq!(ron_str_pretty, check_pretty);
 
-    let mut ron_writer = std::ffi::OsString::new();
-    super::to_writer(&mut ron_writer, val).unwrap();
-    assert_eq!(ron_writer, check);
+    #[cfg(feature = "std")]
+    {
+        let mut ron_writer = std::ffi::OsString::new();
+        super::to_writer(&mut ron_writer, val).unwrap();
+        assert_eq!(ron_writer, check);
 
-    let mut ron_writer_pretty = std::ffi::OsString::new();
-    super::to_writer_pretty(
-        &mut ron_writer_pretty,
-        val,
-        super::PrettyConfig::default()
-            .struct_names(true)
-            .compact_structs(true),
-    )
-    .unwrap();
-    assert_eq!(ron_writer_pretty, check_pretty);
+        let mut ron_writer_pretty = std::ffi::OsString::new();
+        super::to_writer_pretty(
+            &mut ron_writer_pretty,
+            val,
+            super::PrettyConfig::default()
+                .struct_names(true)
+                .compact_structs(true),
+        )
+        .unwrap();
+        assert_eq!(ron_writer_pretty, check_pretty);
+    }
 }