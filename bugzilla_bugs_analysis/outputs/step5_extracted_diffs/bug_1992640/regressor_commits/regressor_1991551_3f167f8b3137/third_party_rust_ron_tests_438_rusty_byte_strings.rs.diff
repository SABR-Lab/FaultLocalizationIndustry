# ==============================================================================
# REGRESSOR COMMIT DIFF
# ==============================================================================
# File: third_party/rust/ron/tests/438_rusty_byte_strings.rs
# Commit: 3f167f8b3137
# Full Hash: 3f167f8b313749f50f135e189e5854bef7ac0c73
# Author: Erich Gubler <erichdongubler@gmail.com>
# Date: 2025-10-03 18:08 +0000
# Regressor Bug: 1991551
# File Overlap Count: 23
# Overlapping Files: third_party/rust/wgpu-hal/Cargo.toml, supply-chain/audits.toml, third_party/rust/naga/src/back/spv/writer.rs, third_party/rust/naga/src/back/msl/writer.rs, third_party/rust/wgpu-types/src/lib.rs
# Description:
#   Bug 1991551 - build(webgpu): update WGPU to 8c4aebc0c1b75e3f7412dfc180745a0717fc30ec r=webgpu-reviewers,supply-chain-reviewers,nical
# ==============================================================================

diff -r 823439f307a0 -r 3f167f8b3137 third_party/rust/ron/tests/438_rusty_byte_strings.rs
--- a/third_party/rust/ron/tests/438_rusty_byte_strings.rs	Fri Oct 03 18:01:30 2025 +0000
+++ b/third_party/rust/ron/tests/438_rusty_byte_strings.rs	Fri Oct 03 18:08:29 2025 +0000
@@ -1,5 +1,5 @@
 use ron::{
-    error::{Position, SpannedError},
+    error::{Position, Span, SpannedError},
     Error,
 };
 use serde::Deserialize;
@@ -46,7 +46,10 @@
     assert_eq!(
         Err(SpannedError {
             code: Error::Base64Error(base64::DecodeError::InvalidByte(0, b'_')),
-            position: Position { line: 1, col: 40 }
+            span: Span {
+                start: Position { line: 1, col: 35 },
+                end: Position { line: 1, col: 40 }
+            }
         }),
         ron::from_str::<BytesStruct>("BytesStruct( small:[1, 2], large:\"_+!!\" )"),
     );
@@ -55,7 +58,10 @@
     assert_eq!(
         Err(SpannedError {
             code: Error::Base64Error(base64::DecodeError::InvalidLastSymbol(1, b'x')),
-            position: Position { line: 1, col: 40 }
+            span: Span {
+                start: Position { line: 1, col: 35 },
+                end: Position { line: 1, col: 40 }
+            }
         }),
         ron::from_str::<BytesStruct>("BytesStruct( small:[1, 2], large:\"/x==\" )"),
     );
@@ -64,7 +70,10 @@
     assert_eq!(
         Err(SpannedError {
             code: Error::Base64Error(base64::DecodeError::InvalidPadding),
-            position: Position { line: 1, col: 42 }
+            span: Span {
+                start: Position { line: 1, col: 35 },
+                end: Position { line: 1, col: 42 }
+            }
         }),
         ron::from_str::<BytesStruct>("BytesStruct( small:[1, 2], large:\"AQIDBA\" )"),
     );
@@ -73,7 +82,10 @@
     assert_eq!(
         Err(SpannedError {
             code: Error::Base64Error(base64::DecodeError::InvalidByte(6, b'=')),
-            position: Position { line: 1, col: 45 }
+            span: Span {
+                start: Position { line: 1, col: 35 },
+                end: Position { line: 1, col: 45 }
+            }
         }),
         ron::from_str::<BytesStruct>("BytesStruct( small:[1, 2], large:\"AQIDBA===\" )"),
     );
@@ -107,14 +119,20 @@
         ron::from_str::<bytes::Bytes>("b\"\\xf\"").unwrap_err(),
         SpannedError {
             code: Error::InvalidEscape("Non-hex digit found"),
-            position: Position { line: 1, col: 7 },
+            span: Span {
+                start: Position { line: 1, col: 3 },
+                end: Position { line: 1, col: 7 },
+            }
         },
     );
     assert_eq!(
         ron::from_str::<bytes::Bytes>("b\"\\xfðŸ¦€\"").unwrap_err(),
         SpannedError {
             code: Error::InvalidEscape("Non-hex digit found"),
-            position: Position { line: 1, col: 7 },
+            span: Span {
+                start: Position { line: 1, col: 3 },
+                end: Position { line: 1, col: 7 },
+            }
         },
     );
     let err = ron::from_str::<bytes::Bytes>("br#q\"").unwrap_err();
@@ -122,7 +140,10 @@
         err,
         SpannedError {
             code: Error::ExpectedByteString,
-            position: Position { line: 1, col: 4 },
+            span: Span {
+                start: Position { line: 1, col: 3 },
+                end: Position { line: 1, col: 4 },
+            }
         },
     );
     assert_eq!(format!("{}", err.code), "Expected byte string",);
@@ -130,21 +151,30 @@
         ron::from_str::<bytes::Bytes>("br#\"q").unwrap_err(),
         SpannedError {
             code: Error::ExpectedStringEnd,
-            position: Position { line: 1, col: 5 },
+            span: Span {
+                start: Position { line: 1, col: 4 },
+                end: Position { line: 1, col: 5 },
+            }
         },
     );
     assert_eq!(
         ron::from_str::<String>("r#q\"").unwrap_err(),
         SpannedError {
             code: Error::ExpectedString,
-            position: Position { line: 1, col: 3 },
+            span: Span {
+                start: Position { line: 1, col: 2 },
+                end: Position { line: 1, col: 3 },
+            }
         },
     );
     assert_eq!(
         ron::from_str::<String>("r#\"q").unwrap_err(),
         SpannedError {
             code: Error::ExpectedStringEnd,
-            position: Position { line: 1, col: 4 },
+            span: Span {
+                start: Position { line: 1, col: 3 },
+                end: Position { line: 1, col: 4 },
+            }
         },
     );
 }
@@ -306,7 +336,7 @@
 }
 
 fn check_roundtrip<
-    T: PartialEq + std::fmt::Debug + serde::Serialize + serde::de::DeserializeOwned,
+    T: PartialEq + core::fmt::Debug + serde::Serialize + serde::de::DeserializeOwned,
 >(
     val: T,
     cmp: &str,
@@ -352,35 +382,50 @@
         ron::from_str::<String>(r#""\xf0""#),
         Err(SpannedError {
             code: Error::InvalidEscape("Not a valid byte-escaped Unicode character"),
-            position: Position { line: 1, col: 6 }
+            span: Span {
+                start: Position { line: 1, col: 2 },
+                end: Position { line: 1, col: 6 }
+            }
         })
     );
     assert_eq!(
         ron::from_str::<String>(r#""\xf0\x9f""#),
         Err(SpannedError {
             code: Error::InvalidEscape("Not a valid byte-escaped Unicode character"),
-            position: Position { line: 1, col: 10 }
+            span: Span {
+                start: Position { line: 1, col: 6 },
+                end: Position { line: 1, col: 10 }
+            }
         })
     );
     assert_eq!(
         ron::from_str::<String>(r#""\xf0\x9f\x40""#),
         Err(SpannedError {
             code: Error::InvalidEscape("Not a valid byte-escaped Unicode character"),
-            position: Position { line: 1, col: 14 }
+            span: Span {
+                start: Position { line: 1, col: 10 },
+                end: Position { line: 1, col: 14 }
+            }
         })
     );
     assert_eq!(
         ron::from_str::<String>(r#""\xf0\x9f\xa6""#),
         Err(SpannedError {
             code: Error::InvalidEscape("Not a valid byte-escaped Unicode character"),
-            position: Position { line: 1, col: 14 }
+            span: Span {
+                start: Position { line: 1, col: 10 },
+                end: Position { line: 1, col: 14 }
+            }
         })
     );
     assert_eq!(
         ron::from_str::<String>(r#""\xff\xff\xff\xff""#),
         Err(SpannedError {
             code: Error::InvalidEscape("Not a valid byte-escaped Unicode character"),
-            position: Position { line: 1, col: 18 }
+            span: Span {
+                start: Position { line: 1, col: 14 },
+                end: Position { line: 1, col: 18 }
+            }
         })
     );
 
@@ -389,7 +434,10 @@
         ron::from_str::<char>(r"'\xf0\x9f\xa6\x80'"),
         Err(SpannedError {
             code: Error::InvalidEscape("Not a valid byte-escaped Unicode character"),
-            position: Position { line: 1, col: 6 }
+            span: Span {
+                start: Position { line: 1, col: 1 },
+                end: Position { line: 1, col: 6 }
+            }
         })
     );
 }
@@ -430,7 +478,10 @@
         ron::from_str::<u8>(r#"b'\u{0}'"#),
         Err(SpannedError {
             code: Error::InvalidEscape("Unexpected Unicode escape in byte literal"),
-            position: Position { line: 1, col: 8 },
+            span: Span {
+                start: Position { line: 1, col: 7 },
+                end: Position { line: 1, col: 8 },
+            }
         })
     );
 
@@ -439,7 +490,10 @@
         err,
         SpannedError {
             code: Error::ExpectedByteLiteral,
-            position: Position { line: 1, col: 4 },
+            span: Span {
+                start: Position { line: 1, col: 1 },
+                end: Position { line: 1, col: 4 },
+            }
         }
     );
     assert_eq!(format!("{}", err.code), "Expected byte literal");
@@ -448,7 +502,10 @@
         ron::from_str::<u8>(r#"b'qq'"#).unwrap_err(),
         SpannedError {
             code: Error::ExpectedByteLiteral,
-            position: Position { line: 1, col: 4 },
+            span: Span {
+                start: Position { line: 1, col: 1 },
+                end: Position { line: 1, col: 4 },
+            }
         }
     );
 
@@ -459,7 +516,10 @@
                 expected: String::from("an 8-bit signed integer"),
                 found: String::from(r#"b'9'"#)
             },
-            position: Position { line: 1, col: 5 },
+            span: Span {
+                start: Position { line: 1, col: 4 },
+                end: Position { line: 1, col: 5 },
+            }
         })
     );
 }
@@ -477,7 +537,10 @@
             ron::from_str::<Test>(&format!("({}: 42)", id)).unwrap_err(),
             SpannedError {
                 code: Error::ExpectedIdentifier,
-                position: Position { line: 1, col: 2 },
+                span: Span {
+                    start: Position { line: 1, col: 2 },
+                    end: Position { line: 1, col: 2 },
+                }
             }
         );
     }